import{a as ln,f as hn,d as ae}from"../chunks/evFuCTkd.js";import{e as bt,n as Er,aR as Ye,h as Sn,w as Tt,T as xr,o as Cr,A as f,t as Mr,H as Pr,v as de,x as Rt,i as at,ae as Ir,aI as br,aq as pe,c as Yn,aS as Tn,f as Ot,s as Tr,M as Rr,aT as Ar,aG as le,aU as kr,aV as Nr,aN as zr,ad as he,aW as Fr,r as He,p as qe,aX as At,q as Lr,aY as Ur,aZ as Dr,aF as Yr,d as Hr,aC as qr,a_ as Or,aO as Xr,k as $r,ab as Vr,a$ as Zr,a5 as fn,a7 as Y,a8 as U,a9 as en,a3 as wt,aP as q,B as In,u as Dn,C as T,a6 as Et,aQ as zn,ar as Oe,_ as Br,a4 as Gr}from"../chunks/Bp8pB4gU.js";import{s as cn,e as yn}from"../chunks/DEBbc6RU.js";import{p as K,i as Fn}from"../chunks/D8zbcI5x.js";import{s as tn,r as Wr}from"../chunks/DzEVTUEa.js";function jr(n,t){return t}function Qr(n,t,r){for(var e=[],i=t.length,a,u=t.length,s=0;s<i;s++){let l=t[s];qe(l,()=>{if(a){if(a.pending.delete(l),a.done.add(l),a.pending.size===0){var c=n.outrogroups;Xt(le(a.done)),c.delete(a),c.size===0&&(n.outrogroups=null)}}else u-=1},!1)}if(u===0){var d=e.length===0&&r!==null;if(d){var p=r,o=p.parentNode;Yr(o),o.append(p),n.items.clear()}Xt(t,!d)}else a={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(a)}function Xt(n,t=!0){for(var r=0;r<n.length;r++)Hr(n[r],t)}var ge;function Xe(n,t,r,e,i,a=null){var u=n,s=new Map,d=(t&Ye)!==0;if(d){var p=n;u=Sn?Tt(xr(p)):p.appendChild(bt())}Sn&&Cr();var o=null,l=Rr(()=>{var S=r();return Ar(S)?S:S==null?[]:le(S)}),c,h=!0;function g(){v.fallback=o,Kr(v,c,u,t,e),o!==null&&(c.length===0?(o.f&Tn)===0?He(o):(o.f^=Tn,Wn(o,null,u)):qe(o,()=>{o=null}))}var _=Er(()=>{c=f(l);var S=c.length;let x=!1;if(Sn){var b=Mr(u)===Pr;b!==(S===0)&&(u=de(),Tt(u),Rt(!1),x=!0)}for(var C=new Set,M=Yn,P=Tr(),R=0;R<S;R+=1){Sn&&at.nodeType===Ir&&at.data===br&&(u=at,x=!0,Rt(!1));var A=c[R],k=e(A,R),m=h?null:s.get(k);m?(m.v&&pe(m.v,A),m.i&&pe(m.i,R),P&&M.skipped_effects.delete(m.e)):(m=Jr(s,h?u:ge??=bt(),A,k,R,i,t,r),h||(m.e.f|=Tn),s.set(k,m)),C.add(k)}if(S===0&&a&&!o&&(h?o=Ot(()=>a(u)):(o=Ot(()=>a(ge??=bt())),o.f|=Tn)),Sn&&S>0&&Tt(de()),!h)if(P){for(const[I,B]of s)C.has(I)||M.skipped_effects.add(B.e);M.oncommit(g),M.ondiscard(()=>{})}else g();x&&Rt(!0),f(l)}),v={effect:_,items:s,outrogroups:null,fallback:o};h=!1,Sn&&(u=at)}function Bn(n){for(;n!==null&&(n.f&Ur)===0;)n=n.next;return n}function Kr(n,t,r,e,i){var a=(e&Dr)!==0,u=t.length,s=n.items,d=Bn(n.effect.first),p,o=null,l,c=[],h=[],g,_,v,S;if(a)for(S=0;S<u;S+=1)g=t[S],_=i(g,S),v=s.get(_).e,(v.f&Tn)===0&&(v.nodes?.a?.measure(),(l??=new Set).add(v));for(S=0;S<u;S+=1){if(g=t[S],_=i(g,S),v=s.get(_).e,n.outrogroups!==null)for(const m of n.outrogroups)m.pending.delete(v),m.done.delete(v);if((v.f&Tn)!==0)if(v.f^=Tn,v===d)Wn(v,null,r);else{var x=o?o.next:d;v===n.effect.last&&(n.effect.last=v.prev),v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),An(n,o,v),An(n,v,x),Wn(v,x,r),o=v,c=[],h=[],d=Bn(o.next);continue}if((v.f&At)!==0&&(He(v),a&&(v.nodes?.a?.unfix(),(l??=new Set).delete(v))),v!==d){if(p!==void 0&&p.has(v)){if(c.length<h.length){var b=h[0],C;o=b.prev;var M=c[0],P=c[c.length-1];for(C=0;C<c.length;C+=1)Wn(c[C],b,r);for(C=0;C<h.length;C+=1)p.delete(h[C]);An(n,M.prev,P.next),An(n,o,M),An(n,P,b),d=b,o=P,S-=1,c=[],h=[]}else p.delete(v),Wn(v,d,r),An(n,v.prev,v.next),An(n,v,o===null?n.effect.first:o.next),An(n,o,v),o=v;continue}for(c=[],h=[];d!==null&&d!==v;)(p??=new Set).add(d),h.push(d),d=Bn(d.next);if(d===null)continue}(v.f&Tn)===0&&c.push(v),o=v,d=Bn(v.next)}if(n.outrogroups!==null){for(const m of n.outrogroups)m.pending.size===0&&(Xt(le(m.done)),n.outrogroups?.delete(m));n.outrogroups.size===0&&(n.outrogroups=null)}if(d!==null||p!==void 0){var R=[];if(p!==void 0)for(v of p)(v.f&At)===0&&R.push(v);for(;d!==null;)(d.f&At)===0&&d!==n.fallback&&R.push(d),d=Bn(d.next);var A=R.length;if(A>0){var k=(e&Ye)!==0&&u===0?r:null;if(a){for(S=0;S<A;S+=1)R[S].nodes?.a?.measure();for(S=0;S<A;S+=1)R[S].nodes?.a?.fix()}Qr(n,R,k)}}a&&Lr(()=>{if(l!==void 0)for(v of l)v.nodes?.a?.apply()})}function Jr(n,t,r,e,i,a,u,s){var d=(u&kr)!==0?(u&Nr)===0?zr(r,!1,!1):he(r):null,p=(u&Fr)!==0?he(i):null;return{v:d,i:p,e:Ot(()=>(a(t,d??r,p??i,s),()=>{n.delete(e)}))}}function Wn(n,t,r){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end,a=t&&(t.f&Tn)===0?t.nodes.start:r;e!==null;){var u=qr(e);if(a.before(e),e===i)return;e=u}}function An(n,t,r){t===null?n.effect.first=r:t.next=r,r===null?n.effect.last=t:r.prev=t}function $e(n){var t,r,e="";if(typeof n=="string"||typeof n=="number")e+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=$e(n[t]))&&(e&&(e+=" "),e+=r)}else for(r in n)n[r]&&(e&&(e+=" "),e+=r);return e}function ni(){for(var n,t,r=0,e="",i=arguments.length;r<i;r++)(n=arguments[r])&&(t=$e(n))&&(e&&(e+=" "),e+=t);return e}function ti(n){return typeof n=="object"?ni(n):n??""}function ei(n,t,r){var e=n==null?"":""+n;return e===""?null:e}function ri(n,t){return n==null?null:String(n)}function ii(n,t,r,e,i,a){var u=n.__className;if(Sn||u!==r||u===void 0){var s=ei(r);(!Sn||s!==n.getAttribute("class"))&&(s==null?n.removeAttribute("class"):n.className=s),n.__className=r}return a}function oi(n,t,r,e){var i=n.__style;if(Sn||i!==t){var a=ri(t);(!Sn||a!==n.getAttribute("style"))&&(a==null?n.removeAttribute("style"):n.style.cssText=a),n.__style=t}return e}function ai(n,t,r=t){var e=new WeakSet;Or(n,"input",async i=>{var a=i?n.defaultValue:n.value;if(a=kt(n)?Nt(a):a,r(a),Yn!==null&&e.add(Yn),await Xr(),a!==(a=t())){var u=n.selectionStart,s=n.selectionEnd,d=n.value.length;if(n.value=a??"",s!==null){var p=n.value.length;u===s&&s===d&&p>d?(n.selectionStart=p,n.selectionEnd=p):(n.selectionStart=u,n.selectionEnd=Math.min(s,p))}}}),(Sn&&n.defaultValue!==n.value||$r(t)==null&&n.value)&&(r(kt(n)?Nt(n.value):n.value),Yn!==null&&e.add(Yn)),Vr(()=>{var i=t();if(n===document.activeElement){var a=Zr??Yn;if(e.has(a))return}kt(n)&&i===Nt(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function kt(n){var t=n.type;return t==="number"||t==="range"}function Nt(n){return n===""?null:+n}function li(n){return function(...t){var r=t[0];return r.stopPropagation(),n?.apply(this,t)}}var ye={},zt={},Ft=34,Gn=10,Lt=13;function Ve(n){return new Function("d","return {"+n.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function ui(n,t){var r=Ve(n);return function(e,i){return t(r(e),i,n)}}function _e(n){var t=Object.create(null),r=[];return n.forEach(function(e){for(var i in e)i in t||r.push(t[i]=i)}),r}function sn(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function si(n){return n<0?"-"+sn(-n,6):n>9999?"+"+sn(n,6):sn(n,4)}function fi(n){var t=n.getUTCHours(),r=n.getUTCMinutes(),e=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":si(n.getUTCFullYear())+"-"+sn(n.getUTCMonth()+1,2)+"-"+sn(n.getUTCDate(),2)+(i?"T"+sn(t,2)+":"+sn(r,2)+":"+sn(e,2)+"."+sn(i,3)+"Z":e?"T"+sn(t,2)+":"+sn(r,2)+":"+sn(e,2)+"Z":r||t?"T"+sn(t,2)+":"+sn(r,2)+"Z":"")}function ci(n){var t=new RegExp('["'+n+`
\r]`),r=n.charCodeAt(0);function e(l,c){var h,g,_=i(l,function(v,S){if(h)return h(v,S-1);g=v,h=c?ui(v,c):Ve(v)});return _.columns=g||[],_}function i(l,c){var h=[],g=l.length,_=0,v=0,S,x=g<=0,b=!1;l.charCodeAt(g-1)===Gn&&--g,l.charCodeAt(g-1)===Lt&&--g;function C(){if(x)return zt;if(b)return b=!1,ye;var P,R=_,A;if(l.charCodeAt(R)===Ft){for(;_++<g&&l.charCodeAt(_)!==Ft||l.charCodeAt(++_)===Ft;);return(P=_)>=g?x=!0:(A=l.charCodeAt(_++))===Gn?b=!0:A===Lt&&(b=!0,l.charCodeAt(_)===Gn&&++_),l.slice(R+1,P-1).replace(/""/g,'"')}for(;_<g;){if((A=l.charCodeAt(P=_++))===Gn)b=!0;else if(A===Lt)b=!0,l.charCodeAt(_)===Gn&&++_;else if(A!==r)continue;return l.slice(R,P)}return x=!0,l.slice(R,g)}for(;(S=C())!==zt;){for(var M=[];S!==ye&&S!==zt;)M.push(S),S=C();c&&(M=c(M,v++))==null||h.push(M)}return h}function a(l,c){return l.map(function(h){return c.map(function(g){return o(h[g])}).join(n)})}function u(l,c){return c==null&&(c=_e(l)),[c.map(o).join(n)].concat(a(l,c)).join(`
`)}function s(l,c){return c==null&&(c=_e(l)),a(l,c).join(`
`)}function d(l){return l.map(p).join(`
`)}function p(l){return l.map(o).join(n)}function o(l){return l==null?"":l instanceof Date?fi(l):t.test(l+="")?'"'+l.replace(/"/g,'""')+'"':l}return{parse:e,parseRows:i,format:u,formatBody:s,formatRows:d,formatRow:p,formatValue:o}}var vi=ci(","),di=vi.parse,pi=hn('<header class="bg-black border-b text-xs"><div class="mx-auto p-1"><div class="text-white"> </div></div></header>');function hi(n,t){const r=K(t,"title",3,"fanzinet"),e=K(t,"subtitle",3,"analogikal knot map"),i=K(t,"version",3,"0.?");var a=pi(),u=Y(a),s=Y(u),d=Y(s);U(s),U(u),U(a),fn(()=>cn(d,`${r()??""}
      ${e()??""} v.${i()??""}`)),ln(n,a)}var gi=hn('<footer class="bg-black border-t text-xs text-white/70 px-2 py-1"><div class="flex flex-wrap items-center justify-between gap-1"><a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a> · <a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a></div></footer>');function yi(n,t){const r=K(t,"author",3,"Paolo Palmacci"),e=K(t,"authorUrl",3,"https://www.paolopalmacci.it/"),i=K(t,"developer",3,"Giacomo Nanni"),a=K(t,"developerUrl",3,"https://giacomo.website/");var u=gi(),s=Y(u),d=Y(s),p=Y(d,!0);U(d);var o=en(d,2),l=Y(o,!0);U(o),U(s),U(u),fn(()=>{tn(d,"href",e()),cn(p,r()),tn(o,"href",a()),cn(l,i())}),ln(n,u)}class Ln{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const r=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const a=r[i],u=t+a,s=Math.abs(t)<Math.abs(a)?t-(u-a):a-(u-t);s&&(r[e++]=s),t=u}return r[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let r=this._n,e,i,a,u=0;if(r>0){for(u=t[--r];r>0&&(e=u,i=t[--r],u=e+i,a=i-(u-e),!a););r>0&&(a<0&&t[r-1]<0||a>0&&t[r-1]>0)&&(i=a*2,e=u+i,i==e-u&&(u=e))}return u}}function*_i(n){for(const t of n)yield*t}function Ze(n){return Array.from(_i(n))}var $=1e-6,H=Math.PI,rn=H/2,Se=H/4,pn=H*2,_n=180/H,an=H/180,j=Math.abs,ue=Math.atan,On=Math.atan2,W=Math.cos,Si=Math.exp,$t=Math.log,Ut=Math.pow,J=Math.sin,jn=Math.sign||function(n){return n>0?1:n<0?-1:0},kn=Math.sqrt,Be=Math.tan;function mi(n){return n>1?0:n<-1?H:Math.acos(n)}function et(n){return n>1?rn:n<-1?-rn:Math.asin(n)}function dn(){}function dt(n,t){n&&we.hasOwnProperty(n.type)&&we[n.type](n,t)}var me={Feature:function(n,t){dt(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)dt(r[e].geometry,t)}},we={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Vt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Vt(r[e],t,0)},Polygon:function(n,t){Ee(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Ee(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)dt(r[e],t)}};function Vt(n,t,r){var e=-1,i=n.length-r,a;for(t.lineStart();++e<i;)a=n[e],t.point(a[0],a[1],a[2]);t.lineEnd()}function Ee(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)Vt(n[r],t,1);t.polygonEnd()}function Hn(n,t){n&&me.hasOwnProperty(n.type)?me[n.type](n,t):dt(n,t)}function Zt(n){return[On(n[1],n[0]),et(n[2])]}function Xn(n){var t=n[0],r=n[1],e=W(r);return[e*W(t),e*J(t),J(r)]}function lt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function pt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Dt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ut(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Bt(n){var t=kn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Gt(n,t){function r(e,i){return e=n(e,i),t(e[0],e[1])}return n.invert&&t.invert&&(r.invert=function(e,i){return e=t.invert(e,i),e&&n.invert(e[0],e[1])}),r}function Wt(n,t){return j(n)>H&&(n-=Math.round(n/pn)*pn),[n,t]}Wt.invert=Wt;function wi(n,t,r){return(n%=pn)?t||r?Gt(Ce(n),Me(t,r)):Ce(n):t||r?Me(t,r):Wt}function xe(n){return function(t,r){return t+=n,j(t)>H&&(t-=Math.round(t/pn)*pn),[t,r]}}function Ce(n){var t=xe(n);return t.invert=xe(-n),t}function Me(n,t){var r=W(n),e=J(n),i=W(t),a=J(t);function u(s,d){var p=W(d),o=W(s)*p,l=J(s)*p,c=J(d),h=c*r+o*e;return[On(l*i-h*a,o*r-c*e),et(h*i+l*a)]}return u.invert=function(s,d){var p=W(d),o=W(s)*p,l=J(s)*p,c=J(d),h=c*i-l*a;return[On(l*i+c*a,o*r+h*e),et(h*r-o*e)]},u}function Ei(n,t,r,e,i,a){if(r){var u=W(t),s=J(t),d=e*r;i==null?(i=t+e*pn,a=t-d/2):(i=Pe(u,i),a=Pe(u,a),(e>0?i<a:i>a)&&(i+=e*pn));for(var p,o=i;e>0?o>a:o<a;o-=d)p=Zt([u,-s*W(o),-s*J(o)]),n.point(p[0],p[1])}}function Pe(n,t){t=Xn(t),t[0]-=n,Bt(t);var r=mi(-t[1]);return((-t[2]<0?-r:r)+pn-$)%pn}function Ge(){var n=[],t;return{point:function(r,e,i){t.push([r,e,i])},lineStart:function(){n.push(t=[])},lineEnd:dn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var r=n;return n=[],t=null,r}}}function vt(n,t){return j(n[0]-t[0])<$&&j(n[1]-t[1])<$}function st(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function We(n,t,r,e,i){var a=[],u=[],s,d;if(n.forEach(function(g){if(!((_=g.length-1)<=0)){var _,v=g[0],S=g[_],x;if(vt(v,S)){if(!v[2]&&!S[2]){for(i.lineStart(),s=0;s<_;++s)i.point((v=g[s])[0],v[1]);i.lineEnd();return}S[0]+=2*$}a.push(x=new st(v,g,null,!0)),u.push(x.o=new st(v,null,x,!1)),a.push(x=new st(S,g,null,!1)),u.push(x.o=new st(S,null,x,!0))}}),!!a.length){for(u.sort(t),Ie(a),Ie(u),s=0,d=u.length;s<d;++s)u[s].e=r=!r;for(var p=a[0],o,l;;){for(var c=p,h=!0;c.v;)if((c=c.n)===p)return;o=c.z,i.lineStart();do{if(c.v=c.o.v=!0,c.e){if(h)for(s=0,d=o.length;s<d;++s)i.point((l=o[s])[0],l[1]);else e(c.x,c.n.x,1,i);c=c.n}else{if(h)for(o=c.p.z,s=o.length-1;s>=0;--s)i.point((l=o[s])[0],l[1]);else e(c.x,c.p.x,-1,i);c=c.p}c=c.o,o=c.z,h=!h}while(!c.v);i.lineEnd()}}}function Ie(n){if(t=n.length){for(var t,r=0,e=n[0],i;++r<t;)e.n=i=n[r],i.p=e,e=i;e.n=i=n[0],i.p=e}}function Yt(n){return j(n[0])<=H?n[0]:jn(n[0])*((j(n[0])+H)%pn-H)}function xi(n,t){var r=Yt(t),e=t[1],i=J(e),a=[J(r),-W(r),0],u=0,s=0,d=new Ln;i===1?e=rn+$:i===-1&&(e=-rn-$);for(var p=0,o=n.length;p<o;++p)if(c=(l=n[p]).length)for(var l,c,h=l[c-1],g=Yt(h),_=h[1]/2+Se,v=J(_),S=W(_),x=0;x<c;++x,g=C,v=P,S=R,h=b){var b=l[x],C=Yt(b),M=b[1]/2+Se,P=J(M),R=W(M),A=C-g,k=A>=0?1:-1,m=k*A,I=m>H,B=v*P;if(d.add(On(B*k*J(m),S*R+B*W(m))),u+=I?A+k*pn:A,I^g>=r^C>=r){var D=pt(Xn(h),Xn(b));Bt(D);var N=pt(a,D);Bt(N);var y=(I^A>=0?-1:1)*et(N[2]);(e>y||e===y&&(D[0]||D[1]))&&(s+=I^A>=0?1:-1)}}return(u<-$||u<$&&d<-1e-12)^s&1}function je(n,t,r,e){return function(i){var a=t(i),u=Ge(),s=t(u),d=!1,p,o,l,c={point:h,lineStart:_,lineEnd:v,polygonStart:function(){c.point=S,c.lineStart=x,c.lineEnd=b,o=[],p=[]},polygonEnd:function(){c.point=h,c.lineStart=_,c.lineEnd=v,o=Ze(o);var C=xi(p,e);o.length?(d||(i.polygonStart(),d=!0),We(o,Mi,C,r,i)):C&&(d||(i.polygonStart(),d=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),d&&(i.polygonEnd(),d=!1),o=p=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(C,M){n(C,M)&&i.point(C,M)}function g(C,M){a.point(C,M)}function _(){c.point=g,a.lineStart()}function v(){c.point=h,a.lineEnd()}function S(C,M){l.push([C,M]),s.point(C,M)}function x(){s.lineStart(),l=[]}function b(){S(l[0][0],l[0][1]),s.lineEnd();var C=s.clean(),M=u.result(),P,R=M.length,A,k,m;if(l.pop(),p.push(l),l=null,!!R){if(C&1){if(k=M[0],(A=k.length-1)>0){for(d||(i.polygonStart(),d=!0),i.lineStart(),P=0;P<A;++P)i.point((m=k[P])[0],m[1]);i.lineEnd()}return}R>1&&C&2&&M.push(M.pop().concat(M.shift())),o.push(M.filter(Ci))}}return c}}function Ci(n){return n.length>1}function Mi(n,t){return((n=n.x)[0]<0?n[1]-rn-$:rn-n[1])-((t=t.x)[0]<0?t[1]-rn-$:rn-t[1])}const be=je(function(){return!0},Pi,bi,[-H,-rn]);function Pi(n){var t=NaN,r=NaN,e=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(a,u){var s=a>0?H:-H,d=j(a-t);j(d-H)<$?(n.point(t,r=(r+u)/2>0?rn:-rn),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),n.point(a,r),i=0):e!==s&&d>=H&&(j(t-e)<$&&(t-=e*$),j(a-s)<$&&(a-=s*$),r=Ii(t,r,a,u),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),i=0),n.point(t=a,r=u),e=s},lineEnd:function(){n.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function Ii(n,t,r,e){var i,a,u=J(n-r);return j(u)>$?ue((J(t)*(a=W(e))*J(r)-J(e)*(i=W(t))*J(n))/(i*a*u)):(t+e)/2}function bi(n,t,r,e){var i;if(n==null)i=r*rn,e.point(-H,i),e.point(0,i),e.point(H,i),e.point(H,0),e.point(H,-i),e.point(0,-i),e.point(-H,-i),e.point(-H,0),e.point(-H,i);else if(j(n[0]-t[0])>$){var a=n[0]<t[0]?H:-H;i=r*a/2,e.point(-a,i),e.point(0,i),e.point(a,i)}else e.point(t[0],t[1])}function Ti(n){var t=W(n),r=2*an,e=t>0,i=j(t)>$;function a(o,l,c,h){Ei(h,n,r,c,o,l)}function u(o,l){return W(o)*W(l)>t}function s(o){var l,c,h,g,_;return{lineStart:function(){g=h=!1,_=1},point:function(v,S){var x=[v,S],b,C=u(v,S),M=e?C?0:p(v,S):C?p(v+(v<0?H:-H),S):0;if(!l&&(g=h=C)&&o.lineStart(),C!==h&&(b=d(l,x),(!b||vt(l,b)||vt(x,b))&&(x[2]=1)),C!==h)_=0,C?(o.lineStart(),b=d(x,l),o.point(b[0],b[1])):(b=d(l,x),o.point(b[0],b[1],2),o.lineEnd()),l=b;else if(i&&l&&e^C){var P;!(M&c)&&(P=d(x,l,!0))&&(_=0,e?(o.lineStart(),o.point(P[0][0],P[0][1]),o.point(P[1][0],P[1][1]),o.lineEnd()):(o.point(P[1][0],P[1][1]),o.lineEnd(),o.lineStart(),o.point(P[0][0],P[0][1],3)))}C&&(!l||!vt(l,x))&&o.point(x[0],x[1]),l=x,h=C,c=M},lineEnd:function(){h&&o.lineEnd(),l=null},clean:function(){return _|(g&&h)<<1}}}function d(o,l,c){var h=Xn(o),g=Xn(l),_=[1,0,0],v=pt(h,g),S=lt(v,v),x=v[0],b=S-x*x;if(!b)return!c&&o;var C=t*S/b,M=-t*x/b,P=pt(_,v),R=ut(_,C),A=ut(v,M);Dt(R,A);var k=P,m=lt(R,k),I=lt(k,k),B=m*m-I*(lt(R,R)-1);if(!(B<0)){var D=kn(B),N=ut(k,(-m-D)/I);if(Dt(N,R),N=Zt(N),!c)return N;var y=o[0],z=l[0],O=o[1],G=l[1],F;z<y&&(F=y,y=z,z=F);var Q=z-y,V=j(Q-H)<$,un=V||Q<$;if(!V&&G<O&&(F=O,O=G,G=F),un?V?O+G>0^N[1]<(j(N[0]-y)<$?O:G):O<=N[1]&&N[1]<=G:Q>H^(y<=N[0]&&N[0]<=z)){var on=ut(k,(-m+D)/I);return Dt(on,R),[N,Zt(on)]}}}function p(o,l){var c=e?n:H-n,h=0;return o<-c?h|=1:o>c&&(h|=2),l<-c?h|=4:l>c&&(h|=8),h}return je(u,s,a,e?[0,-n]:[-H,n-H])}function Ri(n,t,r,e,i,a){var u=n[0],s=n[1],d=t[0],p=t[1],o=0,l=1,c=d-u,h=p-s,g;if(g=r-u,!(!c&&g>0)){if(g/=c,c<0){if(g<o)return;g<l&&(l=g)}else if(c>0){if(g>l)return;g>o&&(o=g)}if(g=i-u,!(!c&&g<0)){if(g/=c,c<0){if(g>l)return;g>o&&(o=g)}else if(c>0){if(g<o)return;g<l&&(l=g)}if(g=e-s,!(!h&&g>0)){if(g/=h,h<0){if(g<o)return;g<l&&(l=g)}else if(h>0){if(g>l)return;g>o&&(o=g)}if(g=a-s,!(!h&&g<0)){if(g/=h,h<0){if(g>l)return;g>o&&(o=g)}else if(h>0){if(g<o)return;g<l&&(l=g)}return o>0&&(n[0]=u+o*c,n[1]=s+o*h),l<1&&(t[0]=u+l*c,t[1]=s+l*h),!0}}}}}var Qn=1e9,ft=-Qn;function Ai(n,t,r,e){function i(p,o){return n<=p&&p<=r&&t<=o&&o<=e}function a(p,o,l,c){var h=0,g=0;if(p==null||(h=u(p,l))!==(g=u(o,l))||d(p,o)<0^l>0)do c.point(h===0||h===3?n:r,h>1?e:t);while((h=(h+l+4)%4)!==g);else c.point(o[0],o[1])}function u(p,o){return j(p[0]-n)<$?o>0?0:3:j(p[0]-r)<$?o>0?2:1:j(p[1]-t)<$?o>0?1:0:o>0?3:2}function s(p,o){return d(p.x,o.x)}function d(p,o){var l=u(p,1),c=u(o,1);return l!==c?l-c:l===0?o[1]-p[1]:l===1?p[0]-o[0]:l===2?p[1]-o[1]:o[0]-p[0]}return function(p){var o=p,l=Ge(),c,h,g,_,v,S,x,b,C,M,P,R={point:A,lineStart:B,lineEnd:D,polygonStart:m,polygonEnd:I};function A(y,z){i(y,z)&&o.point(y,z)}function k(){for(var y=0,z=0,O=h.length;z<O;++z)for(var G=h[z],F=1,Q=G.length,V=G[0],un,on,mn=V[0],Mn=V[1];F<Q;++F)un=mn,on=Mn,V=G[F],mn=V[0],Mn=V[1],on<=e?Mn>e&&(mn-un)*(e-on)>(Mn-on)*(n-un)&&++y:Mn<=e&&(mn-un)*(e-on)<(Mn-on)*(n-un)&&--y;return y}function m(){o=l,c=[],h=[],P=!0}function I(){var y=k(),z=P&&y,O=(c=Ze(c)).length;(z||O)&&(p.polygonStart(),z&&(p.lineStart(),a(null,null,1,p),p.lineEnd()),O&&We(c,s,y,a,p),p.polygonEnd()),o=p,c=h=g=null}function B(){R.point=N,h&&h.push(g=[]),M=!0,C=!1,x=b=NaN}function D(){c&&(N(_,v),S&&C&&l.rejoin(),c.push(l.result())),R.point=A,C&&o.lineEnd()}function N(y,z){var O=i(y,z);if(h&&g.push([y,z]),M)_=y,v=z,S=O,M=!1,O&&(o.lineStart(),o.point(y,z));else if(O&&C)o.point(y,z);else{var G=[x=Math.max(ft,Math.min(Qn,x)),b=Math.max(ft,Math.min(Qn,b))],F=[y=Math.max(ft,Math.min(Qn,y)),z=Math.max(ft,Math.min(Qn,z))];Ri(G,F,n,t,r,e)?(C||(o.lineStart(),o.point(G[0],G[1])),o.point(F[0],F[1]),O||o.lineEnd(),P=!1):O&&(o.lineStart(),o.point(y,z),P=!1)}x=y,b=z,C=O}return R}}const jt=n=>n;var Ht=new Ln,Qt=new Ln,Qe,Ke,Kt,Jt,bn={point:dn,lineStart:dn,lineEnd:dn,polygonStart:function(){bn.lineStart=ki,bn.lineEnd=zi},polygonEnd:function(){bn.lineStart=bn.lineEnd=bn.point=dn,Ht.add(j(Qt)),Qt=new Ln},result:function(){var n=Ht/2;return Ht=new Ln,n}};function ki(){bn.point=Ni}function Ni(n,t){bn.point=Je,Qe=Kt=n,Ke=Jt=t}function Je(n,t){Qt.add(Jt*n-Kt*t),Kt=n,Jt=t}function zi(){Je(Qe,Ke)}var $n=1/0,ht=$n,rt=-$n,gt=rt,yt={point:Fi,lineStart:dn,lineEnd:dn,polygonStart:dn,polygonEnd:dn,result:function(){var n=[[$n,ht],[rt,gt]];return rt=gt=-(ht=$n=1/0),n}};function Fi(n,t){n<$n&&($n=n),n>rt&&(rt=n),t<ht&&(ht=t),t>gt&&(gt=t)}var ne=0,te=0,Kn=0,_t=0,St=0,qn=0,ee=0,re=0,Jn=0,nr,tr,xn,Cn,vn={point:Un,lineStart:Te,lineEnd:Re,polygonStart:function(){vn.lineStart=Di,vn.lineEnd=Yi},polygonEnd:function(){vn.point=Un,vn.lineStart=Te,vn.lineEnd=Re},result:function(){var n=Jn?[ee/Jn,re/Jn]:qn?[_t/qn,St/qn]:Kn?[ne/Kn,te/Kn]:[NaN,NaN];return ne=te=Kn=_t=St=qn=ee=re=Jn=0,n}};function Un(n,t){ne+=n,te+=t,++Kn}function Te(){vn.point=Li}function Li(n,t){vn.point=Ui,Un(xn=n,Cn=t)}function Ui(n,t){var r=n-xn,e=t-Cn,i=kn(r*r+e*e);_t+=i*(xn+n)/2,St+=i*(Cn+t)/2,qn+=i,Un(xn=n,Cn=t)}function Re(){vn.point=Un}function Di(){vn.point=Hi}function Yi(){er(nr,tr)}function Hi(n,t){vn.point=er,Un(nr=xn=n,tr=Cn=t)}function er(n,t){var r=n-xn,e=t-Cn,i=kn(r*r+e*e);_t+=i*(xn+n)/2,St+=i*(Cn+t)/2,qn+=i,i=Cn*n-xn*t,ee+=i*(xn+n),re+=i*(Cn+t),Jn+=i*3,Un(xn=n,Cn=t)}function rr(n){this._context=n}rr.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,pn);break}}},result:dn};var ie=new Ln,qt,ir,or,nt,tt,it={point:dn,lineStart:function(){it.point=qi},lineEnd:function(){qt&&ar(ir,or),it.point=dn},polygonStart:function(){qt=!0},polygonEnd:function(){qt=null},result:function(){var n=+ie;return ie=new Ln,n}};function qi(n,t){it.point=ar,ir=nt=n,or=tt=t}function ar(n,t){nt-=n,tt-=t,ie.add(kn(nt*nt+tt*tt)),nt=n,tt=t}let Ae,mt,ke,Ne;class ze{constructor(t){this._append=t==null?lr:Oi(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==ke||this._append!==mt){const e=this._radius,i=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,ke=e,mt=this._append,Ne=this._,this._=i}this._+=Ne;break}}}result(){const t=this._;return this._="",t.length?t:null}}function lr(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Oi(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return lr;if(t!==Ae){const r=10**t;Ae=t,mt=function(i){let a=1;this._+=i[0];for(const u=i.length;a<u;++a)this._+=Math.round(arguments[a]*r)/r+i[a]}}return mt}function Fe(n,t){let r=3,e=4.5,i,a;function u(s){return s&&(typeof e=="function"&&a.pointRadius(+e.apply(this,arguments)),Hn(s,i(a))),a.result()}return u.area=function(s){return Hn(s,i(bn)),bn.result()},u.measure=function(s){return Hn(s,i(it)),it.result()},u.bounds=function(s){return Hn(s,i(yt)),yt.result()},u.centroid=function(s){return Hn(s,i(vn)),vn.result()},u.projection=function(s){return arguments.length?(i=s==null?(n=null,jt):(n=s).stream,u):n},u.context=function(s){return arguments.length?(a=s==null?(t=null,new ze(r)):new rr(t=s),typeof e!="function"&&a.pointRadius(e),u):t},u.pointRadius=function(s){return arguments.length?(e=typeof s=="function"?s:(a.pointRadius(+s),+s),u):e},u.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{const d=Math.floor(s);if(!(d>=0))throw new RangeError(`invalid digits: ${s}`);r=d}return t===null&&(a=new ze(r)),u},u.projection(n).digits(r).context(t)}function se(n){return function(t){var r=new oe;for(var e in n)r[e]=n[e];return r.stream=t,r}}function oe(){}oe.prototype={constructor:oe,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fe(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Hn(r,n.stream(yt)),t(yt.result()),e!=null&&n.clipExtent(e),n}function ur(n,t,r){return fe(n,function(e){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],u=Math.min(i/(e[1][0]-e[0][0]),a/(e[1][1]-e[0][1])),s=+t[0][0]+(i-u*(e[1][0]+e[0][0]))/2,d=+t[0][1]+(a-u*(e[1][1]+e[0][1]))/2;n.scale(150*u).translate([s,d])},r)}function Xi(n,t,r){return ur(n,[[0,0],t],r)}function $i(n,t,r){return fe(n,function(e){var i=+t,a=i/(e[1][0]-e[0][0]),u=(i-a*(e[1][0]+e[0][0]))/2,s=-a*e[0][1];n.scale(150*a).translate([u,s])},r)}function Vi(n,t,r){return fe(n,function(e){var i=+t,a=i/(e[1][1]-e[0][1]),u=-a*e[0][0],s=(i-a*(e[1][1]+e[0][1]))/2;n.scale(150*a).translate([u,s])},r)}var Le=16,Zi=W(30*an);function Ue(n,t){return+t?Gi(n,t):Bi(n)}function Bi(n){return se({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function Gi(n,t){function r(e,i,a,u,s,d,p,o,l,c,h,g,_,v){var S=p-e,x=o-i,b=S*S+x*x;if(b>4*t&&_--){var C=u+c,M=s+h,P=d+g,R=kn(C*C+M*M+P*P),A=et(P/=R),k=j(j(P)-1)<$||j(a-l)<$?(a+l)/2:On(M,C),m=n(k,A),I=m[0],B=m[1],D=I-e,N=B-i,y=x*D-S*N;(y*y/b>t||j((S*D+x*N)/b-.5)>.3||u*c+s*h+d*g<Zi)&&(r(e,i,a,u,s,d,I,B,k,C/=R,M/=R,P,_,v),v.point(I,B),r(I,B,k,C,M,P,p,o,l,c,h,g,_,v))}}return function(e){var i,a,u,s,d,p,o,l,c,h,g,_,v={point:S,lineStart:x,lineEnd:C,polygonStart:function(){e.polygonStart(),v.lineStart=M},polygonEnd:function(){e.polygonEnd(),v.lineStart=x}};function S(A,k){A=n(A,k),e.point(A[0],A[1])}function x(){l=NaN,v.point=b,e.lineStart()}function b(A,k){var m=Xn([A,k]),I=n(A,k);r(l,c,o,h,g,_,l=I[0],c=I[1],o=A,h=m[0],g=m[1],_=m[2],Le,e),e.point(l,c)}function C(){v.point=S,e.lineEnd()}function M(){x(),v.point=P,v.lineEnd=R}function P(A,k){b(i=A,k),a=l,u=c,s=h,d=g,p=_,v.point=b}function R(){r(l,c,o,h,g,_,a,u,i,s,d,p,Le,e),v.lineEnd=C,C()}return v}}var Wi=se({point:function(n,t){this.stream.point(n*an,t*an)}});function ji(n){return se({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}function Qi(n,t,r,e,i){function a(u,s){return u*=e,s*=i,[t+n*u,r-n*s]}return a.invert=function(u,s){return[(u-t)/n*e,(r-s)/n*i]},a}function De(n,t,r,e,i,a){if(!a)return Qi(n,t,r,e,i);var u=W(a),s=J(a),d=u*n,p=s*n,o=u/n,l=s/n,c=(s*r-u*t)/n,h=(s*t+u*r)/n;function g(_,v){return _*=e,v*=i,[d*_-p*v+t,r-p*_-d*v]}return g.invert=function(_,v){return[e*(o*_-l*v+c),i*(h-l*_-o*v)]},g}function Ki(n){var t,r=150,e=480,i=250,a=0,u=0,s=0,d=0,p=0,o,l=0,c=1,h=1,g=null,_=be,v=null,S,x,b,C=jt,M=.5,P,R,A,k,m;function I(y){return A(y[0]*an,y[1]*an)}function B(y){return y=A.invert(y[0],y[1]),y&&[y[0]*_n,y[1]*_n]}I.stream=function(y){return k&&m===y?k:k=Wi(ji(o)(_(P(C(m=y)))))},I.preclip=function(y){return arguments.length?(_=y,g=void 0,N()):_},I.postclip=function(y){return arguments.length?(C=y,v=S=x=b=null,N()):C},I.clipAngle=function(y){return arguments.length?(_=+y?Ti(g=y*an):(g=null,be),N()):g*_n},I.clipExtent=function(y){return arguments.length?(C=y==null?(v=S=x=b=null,jt):Ai(v=+y[0][0],S=+y[0][1],x=+y[1][0],b=+y[1][1]),N()):v==null?null:[[v,S],[x,b]]},I.scale=function(y){return arguments.length?(r=+y,D()):r},I.translate=function(y){return arguments.length?(e=+y[0],i=+y[1],D()):[e,i]},I.center=function(y){return arguments.length?(a=y[0]%360*an,u=y[1]%360*an,D()):[a*_n,u*_n]},I.rotate=function(y){return arguments.length?(s=y[0]%360*an,d=y[1]%360*an,p=y.length>2?y[2]%360*an:0,D()):[s*_n,d*_n,p*_n]},I.angle=function(y){return arguments.length?(l=y%360*an,D()):l*_n},I.reflectX=function(y){return arguments.length?(c=y?-1:1,D()):c<0},I.reflectY=function(y){return arguments.length?(h=y?-1:1,D()):h<0},I.precision=function(y){return arguments.length?(P=Ue(R,M=y*y),N()):kn(M)},I.fitExtent=function(y,z){return ur(I,y,z)},I.fitSize=function(y,z){return Xi(I,y,z)},I.fitWidth=function(y,z){return $i(I,y,z)},I.fitHeight=function(y,z){return Vi(I,y,z)};function D(){var y=De(r,0,0,c,h,l).apply(null,t(a,u)),z=De(r,e-y[0],i-y[1],c,h,l);return o=wi(s,d,p),R=Gt(t,z),A=Gt(o,R),P=Ue(R,M),N()}function N(){return k=m=null,I}return function(){return t=n.apply(this,arguments),I.invert=t.invert&&B,D()}}function Ji(n){var t=0,r=H/3,e=Ki(n),i=e(t,r);return i.parallels=function(a){return arguments.length?e(t=a[0]*an,r=a[1]*an):[t*_n,r*_n]},i}function sr(n,t){return[n,$t(Be((rn+t)/2))]}sr.invert=function(n,t){return[n,2*ue(Si(t))-rn]};function ct(n){return Be((rn+n)/2)}function no(n,t){var r=W(n),e=n===t?J(n):$t(r/W(t))/$t(ct(t)/ct(n)),i=r*Ut(ct(n),e)/e;if(!e)return sr;function a(u,s){i>0?s<-rn+$&&(s=-rn+$):s>rn-$&&(s=rn-$);var d=i/Ut(ct(s),e);return[d*J(e*u),i-d*W(e*u)]}return a.invert=function(u,s){var d=i-s,p=jn(e)*kn(u*u+d*d),o=On(u,j(d))*jn(d);return d*e<0&&(o-=H*jn(u)*jn(d)),[o/e,2*ue(Ut(i/p,1/e))-rn]},a}function to(){return Ji(no).scale(109.5).parallels([30,30])}var eo=ae('<path fill="#f5f5f5" stroke="#d4d4d8" stroke-width="1.5" vector-effect="non-scaling-stroke"></path>'),ro=ae('<line stroke="#000" stroke-opacity="0.2" stroke-width="1" vector-effect="non-scaling-stroke"></line>'),io=ae('<g><g data-label-hit="" class="cursor-pointer" role="button" tabindex="0"><!><rect stroke="black" stroke-width="0" vector-effect="non-scaling-stroke"></rect><text text-anchor="middle" dominant-baseline="middle" fill="white" class="pointer-events-none select-none" vector-effect="non-scaling-stroke"> </text><title> </title></g></g>'),oo=hn('<section class="bg-[#ccc]"><div class="absolute top-1 right-1 z-50 space-y-1 text-xs"><button class="bg-white px-2 py-1  cursor-pointer font-bold text-black border disabled:opacity-40">+</button> <br/> <button class="bg-white px-2 py-1  cursor-pointer font-bold text-black border disabled:opacity-40">−</button></div> <svg class="block h-full w-full cursor-grab touch-none select-none overflow-visible active:cursor-grabbing" preserveAspectRatio="xMidYMid meet" role="application" aria-label="Fanzine map (pan and zoom)"><g><!><!></g></svg></section>');function ao(n,t){wt(t,!0);const r=K(t,"italy",3,null),e=K(t,"points",19,()=>[]);K(t,"filteredItems",19,()=>[]);const i=K(t,"query",3,""),a=K(t,"projectionZoom",3,1.25),u=K(t,"labelPlacements",3,null),s=K(t,"disablePanZoomOnMobile",3,!1),d=K(t,"disableVisibleItems",3,!0),p=K(t,"selectedLabel",3,null),o=K(t,"onSelect",3,null),l=1500,c=1800;let h=q(null),g=q(""),_=q(null),v=q(In([])),S=q(In([])),x=q(In([]));const b=0,C=0;let M=q(1),P=q(b),R=q(C),A=q(!1),k=q(In({x:0,y:0,translateX:0,translateY:0})),m=q(!1),I=q(!1),B=q(!1),D=q(!1),N=q(!1),y=q(null),z=q(null),O=q(null),G=q(!1),F=In(new Map),Q=q(!1),V=q(null);function un(w){const E=w.currentTarget?.ownerSVGElement||w.currentTarget;if(!E?.createSVGPoint)return{x:0,y:0};const L=E.createSVGPoint();L.x=w.clientX,L.y=w.clientY;const Z=E.getScreenCTM?.();if(!Z)return{x:0,y:0};const X=Z.inverse(),nn=L.matrixTransform(X);return{x:nn.x,y:nn.y}}function on(w){const E=w.composedPath?.();return E?E.some(L=>L?.dataset&&"labelHit"in L.dataset):!!w.target?.closest?.("[data-label-hit]")}function mn(w,E=l/2,L=c/2){if(f(G))return;const Z=1.2,X=w>0?Z:1/Z,nn=Math.max(.5,Math.min(8,f(M)*X));if(nn===f(M))return;const wn=E-(E-f(P))/f(M)*nn,gn=L-(L-f(R))/f(M)*nn;Mn(wn,gn,nn)}function Mn(w,E,L){if(T(O,{x:w,y:E,scale:L},!0),typeof requestAnimationFrame>"u"){T(P,f(O).x,!0),T(R,f(O).y,!0),T(M,f(O).scale,!0),T(O,null);return}f(z)||T(z,requestAnimationFrame(()=>{f(O)&&(T(P,f(O).x,!0),T(R,f(O).y,!0),T(M,f(O).scale,!0)),T(O,null),T(z,null)}),!0)}function fr(){if(!f(h)||!e()||e().length===0){T(x,[],!0);return}const w=100;T(x,e().filter(E=>{const L=parseFloat(E.latitude),Z=parseFloat(E.longitude);if(!isFinite(L)||!isFinite(Z))return!1;const[X,nn]=f(h)([Z,L]),wn=f(P)+X*f(M),gn=f(R)+nn*f(M);return wn>-w&&wn<l+w&&gn>-w&&gn<c+w}),!0),t.onvisibleItemsChange?.(f(x))}function cr(w){if(f(G))return;w.preventDefault();const E=w.deltaY>0?-1:1,L=un(w);mn(E,L.x,L.y)}function vr(w){if(f(G)||w.button!=null&&w.button!==0)return;T(D,on(w),!0),T(A,!1),T(N,!0),T(y,w.pointerId,!0),T(m,!1),T(B,!1);const E=un(w);if(F.set(w.pointerId,E),F.size===2){const L=Array.from(F.values()),Z=L[1].x-L[0].x,X=L[1].y-L[0].y,nn=Math.hypot(Z,X)||1,wn={x:(L[0].x+L[1].x)/2,y:(L[0].y+L[1].y)/2};T(Q,!0),T(V,{distance:nn,center:wn,scale:f(M),translateX:f(P),translateY:f(R)},!0),T(N,!1),T(A,!1);return}T(k,{x:E.x,y:E.y,translateX:f(P),translateY:f(R)},!0)}function dr(w){if(f(G))return;if(F.has(w.pointerId)&&F.set(w.pointerId,un(w)),f(Q)&&F.size>=2&&f(V)){const X=Array.from(F.values()),nn=X[1].x-X[0].x,wn=X[1].y-X[0].y,Pn=(Math.hypot(nn,wn)||1)/f(V).distance,Vn=Math.max(.5,Math.min(8,f(V).scale*Pn)),Zn={x:(X[0].x+X[1].x)/2,y:(X[0].y+X[1].y)/2},ot=Zn.x,En=Zn.y,Nn=ot-(ot-f(V).translateX)/f(V).scale*Vn,wr=En-(En-f(V).translateY)/f(V).scale*Vn;Mn(Nn,wr,Vn);return}if(!f(N)&&!f(A)||f(y)!=null&&w.pointerId!==f(y))return;const E=un(w),L=E.x-f(k).x,Z=E.y-f(k).y;!f(m)&&Math.hypot(L,Z)>2&&(T(m,!0),T(B,!0),T(I,f(D),!0),T(A,!0),on(w)&&T(I,!0),w.currentTarget.setPointerCapture?.(w.pointerId)),f(m)&&(T(P,f(k).translateX+L),T(R,f(k).translateY+Z))}function pr(w){f(G)||xt(w)}function hr(w){f(G)||xt(w,!0)}function xt(w,E=!1){F.has(w?.pointerId)&&F.delete(w.pointerId),F.size<2&&(T(Q,!1),T(V,null)),T(A,!1),T(N,!1),T(y,null),w?.currentTarget&&w.currentTarget.releasePointerCapture?.(w.pointerId),f(m)&&!E?(T(I,!0),setTimeout(()=>{T(I,!1),T(B,!1)},160)):(T(B,!1),T(I,!1)),T(D,!1),T(m,!1)}function gr(w,E){if(!w||!isFinite(E)||E===1)return;const L=l/2,Z=c/2,[X,nn]=w.translate();w.scale(w.scale()*E),w.translate([L+(X-L)*E,Z+(nn-Z)*E])}function yr(w,E){(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),o()?.(E))}function _r(w,E){return!w||!E?!1:w.canonicalUrl&&E.canonicalUrl?w.canonicalUrl===E.canonicalUrl:w.sourceFile&&E.sourceFile?w.sourceFile===E.sourceFile:w.fanzine===E.fanzine&&w.city===E.city&&w.yearStart===E.yearStart&&w.yearEnd===E.yearEnd}Dn(()=>{if(r()){const w=to().parallels([37,45]);w.fitExtent([[0,0],[l,c]],r()),gr(w,a()),T(h,w,!0),T(g,Fe(w)(r())||"",!0);const E=Fe(w).bounds(r());T(_,E?{left:E[0][0],top:E[0][1],right:E[1][0],bottom:E[1][1]}:null,!0)}}),Dn(()=>{u()&&u().length&&T(v,u())}),Dn(()=>{const w=f(v)||[],E=i()?w.filter(Z=>{const X=i().toLowerCase();return Z.fanzine?.toLowerCase().includes(X)||Z.city?.toLowerCase().includes(X)||Z.genre?.toLowerCase().includes(X)}):w,L=120;T(S,E.filter(Z=>{const X=f(P)+Z.x*f(M),nn=f(R)+Z.y*f(M);return X>-L&&X<l+L&&nn>-L&&nn<c+L}),!0)}),Dn(()=>{d()?T(x,[],!0):fr()}),Dn(()=>{t.onvisibleItemsChange?.(f(x))}),Dn(()=>{if(typeof window<"u"){const w=window.matchMedia?.("(pointer: coarse)")?.matches||window.matchMedia?.("(hover: none)")?.matches;T(G,!!(s()&&w),!0)}});var Ct=oo(),Mt=Y(Ct),Pt=Y(Mt),ce=en(Pt,4);U(Mt);var Rn=en(Mt,2);tn(Rn,"viewBox",`0 0 ${l} ${c}`);var It=Y(Rn),ve=Y(It);{var Sr=w=>{var E=eo();fn(()=>tn(E,"d",f(g))),ln(w,E)};Fn(ve,w=>{f(g)&&w(Sr)})}var mr=en(ve);Xe(mr,17,()=>f(S),jr,(w,E)=>{const L=zn(()=>_r(f(E),p()));var Z=io(),X=Y(Z),nn=Y(X);{var wn=En=>{var Nn=ro();fn(()=>{tn(Nn,"x1",f(E).x0),tn(Nn,"y1",f(E).y0),tn(Nn,"x2",f(E).x),tn(Nn,"y2",f(E).y)}),ln(En,Nn)};Fn(nn,En=>{Math.hypot(f(E).x-f(E).x0,f(E).y-f(E).y0)>6&&En(wn)})}var gn=en(nn),Pn=en(gn),Vn=Y(Pn,!0);U(Pn);var Zn=en(Pn),ot=Y(Zn);U(Zn),U(X),U(Z),fn(()=>{oi(Z,`opacity: ${p()?f(L)?"1":"0.35":"1"}`),tn(gn,"x",f(E).x-f(E).width/2),tn(gn,"y",f(E).y-f(E).height/2),tn(gn,"width",f(E).width),tn(gn,"height",f(E).height),tn(Pn,"x",f(E).x),tn(Pn,"y",f(E).y),tn(Pn,"font-size",f(E).fontSize),tn(Pn,"font-weight",f(L)?"600":"400"),cn(Vn,f(E).text),cn(ot,`${f(E).fanzine??""} (${f(E).city??""})`)}),yn("pointerup",X,li(En=>{xt(En),!f(I)&&!f(B)&&!f(G)&&o()?.(f(L)?null:f(E))})),yn("keydown",X,En=>yr(En,f(E))),ln(w,Z)}),U(It),U(Rn),U(Ct),fn(()=>{Pt.disabled=f(G),ce.disabled=f(G),tn(It,"transform",`translate(${f(P)} ${f(R)}) scale(${f(M)})`)}),yn("click",Pt,()=>mn(2)),yn("click",ce,()=>mn(-2)),yn("wheel",Rn,cr),yn("pointerdown",Rn,vr),yn("pointermove",Rn,dr),yn("pointerup",Rn,pr),yn("pointercancel",Rn,hr),ln(n,Ct),Et()}var lo=hn('<button type="button" class=" border border-black px-1 py-0.5 text-xs text-black cursor-pointer user-select-none">X</button>'),uo=hn('<div class="flex w-full justify-between items-end gap-3 pb-3"><div class="grid w-full max-w-[280px]"><div class="flex items-center gap-0.5"><input type="text" placeholder="Cerca..." class="flex-1 border border-black bg-white px-1 py-0.5 text-xs text-black outline-none" aria-label="Search fanzines"/> <!></div></div> <div class="text-xs leading-tight text-black/70"><strong class="text-black"> </strong> fanzine</div></div>');function so(n,t){wt(t,!0);let r=K(t,"query",15,""),e=K(t,"totalCount",3,0);K(t,"visibleCount",3,0);let i=K(t,"resultsCount",3,0),a=K(t,"hasSelection",3,!1);function u(){r(""),t.onclear?.()}var s=uo(),d=Y(s),p=Y(d),o=Y(p);Wr(o);var l=en(o,2);{var c=v=>{var S=lo();yn("click",S,u),ln(v,S)};Fn(l,v=>{(r()||a())&&v(c)})}U(p),U(d);var h=en(d,2),g=Y(h),_=Y(g,!0);U(g),Oe(),U(h),U(s),fn(()=>cn(_,r()?i():e())),ai(o,r),ln(n,s),Et()}var fo=hn('<img class="h-full w-full object-fill" loading="lazy"/>'),co=hn('<div class="mt-0.5 text-[.6rem] leading-snug text-black/60"><div> </div> <button type="button" class="mt-0.5 text-[.6rem] font-medium text-blue-600 hover:text-blue-800"> </button></div>'),vo=hn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] hover:bg-black/10" target="_blank" rel="noreferrer">PDF</a>'),po=hn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] text-black hover:bg-black/10" target="_blank" rel="noreferrer">Link</a>'),ho=hn('<div role="listitem" class=" bg-white p-0.5 text-left shadow-sm"><div class="aspect-[3/4] w-full overflow-hidden bg-black/5"><!></div> <div class="mt-0 mb-0.5 truncate font-bold leading-tight text-[.6rem]"> </div> <div class="truncate leading-tight text-[.6rem]"> </div> <div class="mt-0 line-clamp-2 leading-tight text-[.6rem]"> </div> <!> <div class="mt-0.5 gap-0.5"><!> <!></div></div>'),go=hn('<div class="min-h-screen"><div class="flex items-center justify-between px-0.5 py-2 text-xs"><div class="text-black/70"><strong class="text-black"> </strong> fanzine</div></div> <div class="grid grid-cols-2 md:grid-cols-8 gap-0.5 p-0.5" role="list" aria-label="Fanzines"></div></div>');function yo(n,t){wt(t,!0);const r=K(t,"items",19,()=>[]),e="https://www.paolopalmacci.it/capitmundi/";let i=q(null),a=zn(()=>{const _=r().filter(S=>S.ogImage).sort((S,x)=>(S.fanzine||"").localeCompare(x.fanzine||"")),v=r().filter(S=>!S.ogImage);return[..._,...v]});function u(_){return _?/^https?:\/\//i.test(_)?_:`${e}${String(_).replace(/^\/+/,"")}`:""}function s(_){return _?.yearStart?_?.yearEnd&&_.yearEnd!==_.yearStart?`${_.yearStart}-${_.yearEnd}`:String(_.yearStart):""}function d(_,v){const S=[_?.sourceFile,_?.canonicalUrl,_?.pdfHref,_?.title,_?.fanzine,_?.city,_?.yearStart,_?.yearEnd].filter(x=>x!=null&&String(x).trim()!=="").map(x=>String(x));return S.length?`${S.join("|")}|${v}`:String(v)}var p=go(),o=Y(p),l=Y(o),c=Y(l),h=Y(c,!0);U(c),Oe(),U(l),U(o);var g=en(o,2);Xe(g,23,()=>f(a),(_,v)=>d(_,v),(_,v,S)=>{var x=ho(),b=Y(x),C=Y(b);{var M=F=>{var Q=fo();fn(V=>{tn(Q,"src",V),tn(Q,"alt",f(v).fanzine||"Fanzine cover")},[()=>u(f(v).ogImage)]),ln(F,Q)};Fn(C,F=>{f(v).ogImage&&F(M)})}U(b);var P=en(b,2),R=Y(P,!0);U(P);var A=en(P,2),k=Y(A);U(A);var m=en(A,2),I=Y(m);U(m);var B=en(m,2);{var D=F=>{var Q=co(),V=Y(Q),un=Y(V,!0);U(V);var on=en(V,2),mn=Y(on,!0);U(on),U(Q),fn(()=>{ii(V,1,ti(f(i)===f(S)?"":"line-clamp-3")),cn(un,f(v).description),cn(mn,f(i)===f(S)?"Read less":"Read more")}),yn("click",on,()=>{T(i,f(i)===f(S)?null:f(S),!0)}),ln(F,Q)};Fn(B,F=>{f(v).description&&F(D)})}var N=en(B,2),y=Y(N);{var z=F=>{var Q=vo();fn(V=>tn(Q,"href",V),[()=>u(f(v).pdfHref)]),ln(F,Q)};Fn(y,F=>{f(v)?.pdfHref&&F(z)})}var O=en(y,2);{var G=F=>{var Q=po();fn(()=>tn(Q,"href",f(v).canonicalUrl)),ln(F,Q)};Fn(O,F=>{f(v)?.canonicalUrl&&F(G)})}U(N),U(x),fn(F=>{cn(R,f(v).fanzine),cn(k,`${f(v).city??""}${f(v).country?`, ${f(v).country}`:""}`),cn(I,`${(f(v).genre||"—")??""}${F??""}`)},[()=>s(f(v))?` · ${s(f(v))}`:""]),ln(_,x)}),U(g),U(p),fn(()=>cn(h,f(a).length)),ln(n,p),Et()}var _o=hn('<!> <div class="sticky top-0 z-0 max-h-[65vh] w-full"><div class="h-full w-full overflow-hidden bg-white"><!></div></div> <div class="relative mx-auto bg-white w-full px-2 py-1"><!> <!></div> <!>',1);function Co(n,t){wt(t,!0);function r(m){return{sourceFile:m.source_file,canonicalUrl:m.canonical_url,title:m.title,fanzine:m.fanzine||"N/A",city:m.city||"Unknown",country:m.country,activity:m.activity,yearStart:m.year_start,yearEnd:m.year_end,genre:m.genre,description:m.description,pdfHref:m.pdf_href,ogImage:m.og_image,latitude:m.latitude,longitude:m.longitude}}let e=q(null),i=q(In([])),a=q(In([])),u=q(In([])),s=q(!0),d=q(""),p=q(""),o=q(null),l=q(In([])),c=zn(()=>f(p)?f(i).filter(m=>{const I=f(p).toLowerCase();return m.fanzine?.toLowerCase().includes(I)||m.city?.toLowerCase().includes(I)||m.genre?.toLowerCase().includes(I)}):[]),h=zn(()=>f(p)?f(a).filter(m=>{const I=f(p).toLowerCase();return m.fanzine?.toLowerCase().includes(I)||m.city?.toLowerCase().includes(I)||m.genre?.toLowerCase().includes(I)}).length:f(a).length);function g(){T(p,""),T(o,null)}function _(m){T(o,m,!0)}function v(m){T(l,m,!0)}Br(async()=>{try{T(s,!0);const m=await fetch("/data/italy2.geojson");if(!m.ok)throw new Error("Failed to load geojson");T(e,await m.json(),!0);const I=await fetch("/fanzines.csv");if(!I.ok)throw new Error("Failed to load fanzines.csv");const B=await I.text();T(i,di(B).map(r),!0);try{const D=await fetch("/data/label_placements.json");if(D.ok){const N=await D.json();T(u,Array.isArray(N)?N:N.labels||[],!0)}}catch(D){console.warn("Failed to load label placements",D)}T(a,f(i).map(D=>{const N=parseFloat(D.latitude),y=parseFloat(D.longitude);return!isFinite(N)||!isFinite(y)?null:{...D,lat:N,lon:y}}).filter(Boolean),!0)}catch(m){T(d,m instanceof Error?m.message:String(m),!0)}finally{T(s,!1)}});var S=_o(),x=Gr(S);hi(x,{});var b=en(x,2),C=Y(b),M=Y(C);{let m=zn(()=>f(o)?[f(o)]:f(p)?f(c):f(i));ao(M,{get italy(){return f(e)},get points(){return f(a)},get labelPlacements(){return f(u)},get query(){return f(p)},projectionZoom:1,get selectedLabel(){return f(o)},get filteredItems(){return f(m)},onSelect:_,onvisibleItemsChange:v})}U(C),U(b);var P=en(b,2),R=Y(P);{let m=zn(()=>!!f(o));so(R,{get totalCount(){return f(i).length},get visibleCount(){return f(h)},get resultsCount(){return f(c).length},get hasSelection(){return f(m)},onclear:g,get query(){return f(p)},set query(I){T(p,I,!0)}})}var A=en(R,2);{let m=zn(()=>f(o)?[f(o)]:f(p)?f(c):f(l).length>0?f(l):f(i));yo(A,{get items(){return f(m)}})}U(P);var k=en(P,2);yi(k,{}),ln(n,S),Et()}export{Co as component};

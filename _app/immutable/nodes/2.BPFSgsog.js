import{a as an,f as gn,d as oe}from"../chunks/CsXbaW0u.js";import{i as yt}from"../chunks/CujRvGow.js";import{c as $e,o as Sr}from"../chunks/BY5szE3h.js";import{e as Pt,H as wr,aS as Ue,h as mn,P as Rt,a4 as Er,I as mr,t as a,K as xr,M as Cr,O as de,Q as Tt,i as et,af as Mr,aJ as Pr,ar as pe,c as Ln,aT as Mn,f as Ot,s as Rr,$ as ut,y as Tr,aH as ae,aU as Ir,aV as Nr,aO as W,ae as he,aW as kr,r as He,p as Oe,aX as It,q as Ar,aY as Fr,aZ as zr,aG as br,d as Lr,aD as Dr,a_ as $r,aP as Ur,l as D,ac as Hr,a$ as Or,C as hn,E as q,F as Y,G as nn,A as St,b0 as kn,b1 as Ye,D as wt,v as Nn,V as b,as as Yr,B as qr}from"../chunks/Bz0-R9yI.js";import{s as xn,e as fn}from"../chunks/BPKptqdW.js";import{s as J,r as Vr}from"../chunks/CF3Zwip9.js";import{p as j,i as An}from"../chunks/CgWTwZ29.js";function Xr(n,t){return t}function Zr(n,t,r){for(var e=[],i=t.length,f,u=t.length,s=0;s<i;s++){let l=t[s];Oe(l,()=>{if(f){if(f.pending.delete(l),f.done.add(l),f.pending.size===0){var c=n.outrogroups;Yt(ae(f.done)),c.delete(f),c.size===0&&(n.outrogroups=null)}}else u-=1},!1)}if(u===0){var h=e.length===0&&r!==null;if(h){var g=r,o=g.parentNode;br(o),o.append(g),n.items.clear()}Yt(t,!h)}else f={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(f)}function Yt(n,t=!0){for(var r=0;r<n.length;r++)Lr(n[r],t)}var ge;function qe(n,t,r,e,i,f=null){var u=n,s=new Map,h=(t&Ue)!==0;if(h){var g=n;u=mn?Rt(Er(g)):g.appendChild(Pt())}mn&&mr();var o=null,l=ut(()=>{var w=r();return Tr(w)?w:w==null?[]:ae(w)}),c,d=!0;function v(){p.fallback=o,Br(p,c,u,t,e),o!==null&&(c.length===0?(o.f&Mn)===0?He(o):(o.f^=Mn,Zn(o,null,u)):Oe(o,()=>{o=null}))}var E=wr(()=>{c=a(l);var w=c.length;let C=!1;if(mn){var T=xr(u)===Cr;T!==(w===0)&&(u=de(),Rt(u),Tt(!1),C=!0)}for(var m=new Set,x=Ln,M=Rr(),I=0;I<w;I+=1){mn&&et.nodeType===Mr&&et.data===Pr&&(u=et,C=!0,Tt(!1));var y=c[I],N=e(y,I),k=d?null:s.get(N);k?(k.v&&pe(k.v,y),k.i&&pe(k.i,I),M&&x.skipped_effects.delete(k.e)):(k=Gr(s,d?u:ge??=Pt(),y,N,I,i,t,r),d||(k.e.f|=Mn),s.set(N,k)),m.add(N)}if(w===0&&f&&!o&&(d?o=Ot(()=>f(u)):(o=Ot(()=>f(ge??=Pt())),o.f|=Mn)),mn&&w>0&&Rt(de()),!d)if(M){for(const[R,$]of s)m.has(R)||x.skipped_effects.add($.e);x.oncommit(v),x.ondiscard(()=>{})}else v();C&&Tt(!0),a(l)}),p={effect:E,items:s,outrogroups:null,fallback:o};d=!1,mn&&(u=et)}function Vn(n){for(;n!==null&&(n.f&Fr)===0;)n=n.next;return n}function Br(n,t,r,e,i){var f=(e&zr)!==0,u=t.length,s=n.items,h=Vn(n.effect.first),g,o=null,l,c=[],d=[],v,E,p,w;if(f)for(w=0;w<u;w+=1)v=t[w],E=i(v,w),p=s.get(E).e,(p.f&Mn)===0&&(p.nodes?.a?.measure(),(l??=new Set).add(p));for(w=0;w<u;w+=1){if(v=t[w],E=i(v,w),p=s.get(E).e,n.outrogroups!==null)for(const k of n.outrogroups)k.pending.delete(p),k.done.delete(p);if((p.f&Mn)!==0)if(p.f^=Mn,p===h)Zn(p,null,r);else{var C=o?o.next:h;p===n.effect.last&&(n.effect.last=p.prev),p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),Tn(n,o,p),Tn(n,p,C),Zn(p,C,r),o=p,c=[],d=[],h=Vn(o.next);continue}if((p.f&It)!==0&&(He(p),f&&(p.nodes?.a?.unfix(),(l??=new Set).delete(p))),p!==h){if(g!==void 0&&g.has(p)){if(c.length<d.length){var T=d[0],m;o=T.prev;var x=c[0],M=c[c.length-1];for(m=0;m<c.length;m+=1)Zn(c[m],T,r);for(m=0;m<d.length;m+=1)g.delete(d[m]);Tn(n,x.prev,M.next),Tn(n,o,x),Tn(n,M,T),h=T,o=M,w-=1,c=[],d=[]}else g.delete(p),Zn(p,h,r),Tn(n,p.prev,p.next),Tn(n,p,o===null?n.effect.first:o.next),Tn(n,o,p),o=p;continue}for(c=[],d=[];h!==null&&h!==p;)(g??=new Set).add(h),d.push(h),h=Vn(h.next);if(h===null)continue}(p.f&Mn)===0&&c.push(p),o=p,h=Vn(p.next)}if(n.outrogroups!==null){for(const k of n.outrogroups)k.pending.size===0&&(Yt(ae(k.done)),n.outrogroups?.delete(k));n.outrogroups.size===0&&(n.outrogroups=null)}if(h!==null||g!==void 0){var I=[];if(g!==void 0)for(p of g)(p.f&It)===0&&I.push(p);for(;h!==null;)(h.f&It)===0&&h!==n.fallback&&I.push(h),h=Vn(h.next);var y=I.length;if(y>0){var N=(e&Ue)!==0&&u===0?r:null;if(f){for(w=0;w<y;w+=1)I[w].nodes?.a?.measure();for(w=0;w<y;w+=1)I[w].nodes?.a?.fix()}Zr(n,I,N)}}f&&Ar(()=>{if(l!==void 0)for(p of l)p.nodes?.a?.apply()})}function Gr(n,t,r,e,i,f,u,s){var h=(u&Ir)!==0?(u&Nr)===0?W(r,!1,!1):he(r):null,g=(u&kr)!==0?he(i):null;return{v:h,i:g,e:Ot(()=>(f(t,h??r,g??i,s),()=>{n.delete(e)}))}}function Zn(n,t,r){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end,f=t&&(t.f&Mn)===0?t.nodes.start:r;e!==null;){var u=Dr(e);if(f.before(e),e===i)return;e=u}}function Tn(n,t,r){t===null?n.effect.first=r:t.next=r,r===null?n.effect.last=t:r.prev=t}function Ve(n){var t,r,e="";if(typeof n=="string"||typeof n=="number")e+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=Ve(n[t]))&&(e&&(e+=" "),e+=r)}else for(r in n)n[r]&&(e&&(e+=" "),e+=r);return e}function Wr(){for(var n,t,r=0,e="",i=arguments.length;r<i;r++)(n=arguments[r])&&(t=Ve(n))&&(e&&(e+=" "),e+=t);return e}function jr(n){return typeof n=="object"?Wr(n):n??""}function Kr(n,t,r){var e=n==null?"":""+n;return e===""?null:e}function Qr(n,t,r,e,i,f){var u=n.__className;if(mn||u!==r||u===void 0){var s=Kr(r);(!mn||s!==n.getAttribute("class"))&&(s==null?n.removeAttribute("class"):n.className=s),n.__className=r}return f}function Jr(n,t,r=t){var e=new WeakSet;$r(n,"input",async i=>{var f=i?n.defaultValue:n.value;if(f=Nt(n)?kt(f):f,r(f),Ln!==null&&e.add(Ln),await Ur(),f!==(f=t())){var u=n.selectionStart,s=n.selectionEnd,h=n.value.length;if(n.value=f??"",s!==null){var g=n.value.length;u===s&&s===h&&g>h?(n.selectionStart=g,n.selectionEnd=g):(n.selectionStart=u,n.selectionEnd=Math.min(s,g))}}}),(mn&&n.defaultValue!==n.value||D(t)==null&&n.value)&&(r(Nt(n)?kt(n.value):n.value),Ln!==null&&e.add(Ln)),Hr(()=>{var i=t();if(n===document.activeElement){var f=Or??Ln;if(e.has(f))return}Nt(n)&&i===kt(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function Nt(n){var t=n.type;return t==="number"||t==="range"}function kt(n){return n===""?null:+n}function ni(n){return function(...t){var r=t[0];return r.stopPropagation(),n?.apply(this,t)}}var _e={},At={},Ft=34,Xn=10,zt=13;function Xe(n){return new Function("d","return {"+n.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function ti(n,t){var r=Xe(n);return function(e,i){return t(r(e),i,n)}}function ye(n){var t=Object.create(null),r=[];return n.forEach(function(e){for(var i in e)i in t||r.push(t[i]=i)}),r}function on(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function ei(n){return n<0?"-"+on(-n,6):n>9999?"+"+on(n,6):on(n,4)}function ri(n){var t=n.getUTCHours(),r=n.getUTCMinutes(),e=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":ei(n.getUTCFullYear())+"-"+on(n.getUTCMonth()+1,2)+"-"+on(n.getUTCDate(),2)+(i?"T"+on(t,2)+":"+on(r,2)+":"+on(e,2)+"."+on(i,3)+"Z":e?"T"+on(t,2)+":"+on(r,2)+":"+on(e,2)+"Z":r||t?"T"+on(t,2)+":"+on(r,2)+"Z":"")}function ii(n){var t=new RegExp('["'+n+`
\r]`),r=n.charCodeAt(0);function e(l,c){var d,v,E=i(l,function(p,w){if(d)return d(p,w-1);v=p,d=c?ti(p,c):Xe(p)});return E.columns=v||[],E}function i(l,c){var d=[],v=l.length,E=0,p=0,w,C=v<=0,T=!1;l.charCodeAt(v-1)===Xn&&--v,l.charCodeAt(v-1)===zt&&--v;function m(){if(C)return At;if(T)return T=!1,_e;var M,I=E,y;if(l.charCodeAt(I)===Ft){for(;E++<v&&l.charCodeAt(E)!==Ft||l.charCodeAt(++E)===Ft;);return(M=E)>=v?C=!0:(y=l.charCodeAt(E++))===Xn?T=!0:y===zt&&(T=!0,l.charCodeAt(E)===Xn&&++E),l.slice(I+1,M-1).replace(/""/g,'"')}for(;E<v;){if((y=l.charCodeAt(M=E++))===Xn)T=!0;else if(y===zt)T=!0,l.charCodeAt(E)===Xn&&++E;else if(y!==r)continue;return l.slice(I,M)}return C=!0,l.slice(I,v)}for(;(w=m())!==At;){for(var x=[];w!==_e&&w!==At;)x.push(w),w=m();c&&(x=c(x,p++))==null||d.push(x)}return d}function f(l,c){return l.map(function(d){return c.map(function(v){return o(d[v])}).join(n)})}function u(l,c){return c==null&&(c=ye(l)),[c.map(o).join(n)].concat(f(l,c)).join(`
`)}function s(l,c){return c==null&&(c=ye(l)),f(l,c).join(`
`)}function h(l){return l.map(g).join(`
`)}function g(l){return l.map(o).join(n)}function o(l){return l==null?"":l instanceof Date?ri(l):t.test(l+="")?'"'+l.replace(/"/g,'""')+'"':l}return{parse:e,parseRows:i,format:u,formatBody:s,formatRows:h,formatRow:g,formatValue:o}}var oi=ii(","),ai=oi.parse,li=gn('<header class="bg-black border-b text-xs"><div class="mx-auto p-1"><div class="flex flex-wrap items-center justify-between gap-1"><div class="  text-white"> </div> <div class=" text-white/70 whitespace-nowrap"><a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800">Paolo</a> · <a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800">Giacomo</a></div></div></div></header>');function ui(n,t){let r=j(t,"title",8,"fanzinet"),e=j(t,"subtitle",8,"analogikal knot map"),i=j(t,"version",8,"0.?"),f=j(t,"years",8,"(1980-1989)");j(t,"author",8,"Paolo Palmacci");let u=j(t,"authorUrl",8,"https://www.paolopalmacci.it/");j(t,"developer",8,"Giacomo Nanni");let s=j(t,"developerUrl",8,"https://giacomo.website/");var h=li(),g=q(h),o=q(g),l=q(o),c=q(l);Y(l);var d=nn(l,2),v=q(d),E=nn(v,2);Y(d),Y(o),Y(g),Y(h),hn(()=>{xn(c,`${r()??""}
        ${e()??""} v.${i()??""}
        ${f()??""}`),J(v,"href",u()),J(E,"href",s())}),an(n,h)}class Fn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const r=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const f=r[i],u=t+f,s=Math.abs(t)<Math.abs(f)?t-(u-f):f-(u-t);s&&(r[e++]=s),t=u}return r[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let r=this._n,e,i,f,u=0;if(r>0){for(u=t[--r];r>0&&(e=u,i=t[--r],u=e+i,f=i-(u-e),!f););r>0&&(f<0&&t[r-1]<0||f>0&&t[r-1]>0)&&(i=f*2,e=u+i,i==e-u&&(u=e))}return u}}function*fi(n){for(const t of n)yield*t}function Ze(n){return Array.from(fi(n))}var V=1e-6,L=Math.PI,tn=L/2,Se=L/4,vn=L*2,pn=180/L,rn=L/180,G=Math.abs,le=Math.atan,Un=Math.atan2,B=Math.cos,si=Math.exp,qt=Math.log,bt=Math.pow,K=Math.sin,Bn=Math.sign||function(n){return n>0?1:n<0?-1:0},In=Math.sqrt,Be=Math.tan;function ci(n){return n>1?0:n<-1?L:Math.acos(n)}function Jn(n){return n>1?tn:n<-1?-tn:Math.asin(n)}function cn(){}function st(n,t){n&&Ee.hasOwnProperty(n.type)&&Ee[n.type](n,t)}var we={Feature:function(n,t){st(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)st(r[e].geometry,t)}},Ee={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Vt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Vt(r[e],t,0)},Polygon:function(n,t){me(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)me(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)st(r[e],t)}};function Vt(n,t,r){var e=-1,i=n.length-r,f;for(t.lineStart();++e<i;)f=n[e],t.point(f[0],f[1],f[2]);t.lineEnd()}function me(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)Vt(n[r],t,1);t.polygonEnd()}function Dn(n,t){n&&we.hasOwnProperty(n.type)?we[n.type](n,t):st(n,t)}function Xt(n){return[Un(n[1],n[0]),Jn(n[2])]}function Hn(n){var t=n[0],r=n[1],e=B(r);return[e*B(t),e*K(t),K(r)]}function rt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function ct(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Lt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function it(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Zt(n){var t=In(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Bt(n,t){function r(e,i){return e=n(e,i),t(e[0],e[1])}return n.invert&&t.invert&&(r.invert=function(e,i){return e=t.invert(e,i),e&&n.invert(e[0],e[1])}),r}function Gt(n,t){return G(n)>L&&(n-=Math.round(n/vn)*vn),[n,t]}Gt.invert=Gt;function vi(n,t,r){return(n%=vn)?t||r?Bt(Ce(n),Me(t,r)):Ce(n):t||r?Me(t,r):Gt}function xe(n){return function(t,r){return t+=n,G(t)>L&&(t-=Math.round(t/vn)*vn),[t,r]}}function Ce(n){var t=xe(n);return t.invert=xe(-n),t}function Me(n,t){var r=B(n),e=K(n),i=B(t),f=K(t);function u(s,h){var g=B(h),o=B(s)*g,l=K(s)*g,c=K(h),d=c*r+o*e;return[Un(l*i-d*f,o*r-c*e),Jn(d*i+l*f)]}return u.invert=function(s,h){var g=B(h),o=B(s)*g,l=K(s)*g,c=K(h),d=c*i-l*f;return[Un(l*i+c*f,o*r+d*e),Jn(d*r-o*e)]},u}function di(n,t,r,e,i,f){if(r){var u=B(t),s=K(t),h=e*r;i==null?(i=t+e*vn,f=t-h/2):(i=Pe(u,i),f=Pe(u,f),(e>0?i<f:i>f)&&(i+=e*vn));for(var g,o=i;e>0?o>f:o<f;o-=h)g=Xt([u,-s*B(o),-s*K(o)]),n.point(g[0],g[1])}}function Pe(n,t){t=Hn(t),t[0]-=n,Zt(t);var r=ci(-t[1]);return((-t[2]<0?-r:r)+vn-V)%vn}function Ge(){var n=[],t;return{point:function(r,e,i){t.push([r,e,i])},lineStart:function(){n.push(t=[])},lineEnd:cn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var r=n;return n=[],t=null,r}}}function ft(n,t){return G(n[0]-t[0])<V&&G(n[1]-t[1])<V}function ot(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function We(n,t,r,e,i){var f=[],u=[],s,h;if(n.forEach(function(v){if(!((E=v.length-1)<=0)){var E,p=v[0],w=v[E],C;if(ft(p,w)){if(!p[2]&&!w[2]){for(i.lineStart(),s=0;s<E;++s)i.point((p=v[s])[0],p[1]);i.lineEnd();return}w[0]+=2*V}f.push(C=new ot(p,v,null,!0)),u.push(C.o=new ot(p,null,C,!1)),f.push(C=new ot(w,v,null,!1)),u.push(C.o=new ot(w,null,C,!0))}}),!!f.length){for(u.sort(t),Re(f),Re(u),s=0,h=u.length;s<h;++s)u[s].e=r=!r;for(var g=f[0],o,l;;){for(var c=g,d=!0;c.v;)if((c=c.n)===g)return;o=c.z,i.lineStart();do{if(c.v=c.o.v=!0,c.e){if(d)for(s=0,h=o.length;s<h;++s)i.point((l=o[s])[0],l[1]);else e(c.x,c.n.x,1,i);c=c.n}else{if(d)for(o=c.p.z,s=o.length-1;s>=0;--s)i.point((l=o[s])[0],l[1]);else e(c.x,c.p.x,-1,i);c=c.p}c=c.o,o=c.z,d=!d}while(!c.v);i.lineEnd()}}}function Re(n){if(t=n.length){for(var t,r=0,e=n[0],i;++r<t;)e.n=i=n[r],i.p=e,e=i;e.n=i=n[0],i.p=e}}function Dt(n){return G(n[0])<=L?n[0]:Bn(n[0])*((G(n[0])+L)%vn-L)}function pi(n,t){var r=Dt(t),e=t[1],i=K(e),f=[K(r),-B(r),0],u=0,s=0,h=new Fn;i===1?e=tn+V:i===-1&&(e=-tn-V);for(var g=0,o=n.length;g<o;++g)if(c=(l=n[g]).length)for(var l,c,d=l[c-1],v=Dt(d),E=d[1]/2+Se,p=K(E),w=B(E),C=0;C<c;++C,v=m,p=M,w=I,d=T){var T=l[C],m=Dt(T),x=T[1]/2+Se,M=K(x),I=B(x),y=m-v,N=y>=0?1:-1,k=N*y,R=k>L,$=p*M;if(h.add(Un($*N*K(k),w*I+$*B(k))),u+=R?y+N*vn:y,R^v>=r^m>=r){var O=ct(Hn(d),Hn(T));Zt(O);var U=ct(f,O);Zt(U);var _=(R^y>=0?-1:1)*Jn(U[2]);(e>_||e===_&&(O[0]||O[1]))&&(s+=R^y>=0?1:-1)}}return(u<-V||u<V&&h<-1e-12)^s&1}function je(n,t,r,e){return function(i){var f=t(i),u=Ge(),s=t(u),h=!1,g,o,l,c={point:d,lineStart:E,lineEnd:p,polygonStart:function(){c.point=w,c.lineStart=C,c.lineEnd=T,o=[],g=[]},polygonEnd:function(){c.point=d,c.lineStart=E,c.lineEnd=p,o=Ze(o);var m=pi(g,e);o.length?(h||(i.polygonStart(),h=!0),We(o,gi,m,r,i)):m&&(h||(i.polygonStart(),h=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=g=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(m,x){n(m,x)&&i.point(m,x)}function v(m,x){f.point(m,x)}function E(){c.point=v,f.lineStart()}function p(){c.point=d,f.lineEnd()}function w(m,x){l.push([m,x]),s.point(m,x)}function C(){s.lineStart(),l=[]}function T(){w(l[0][0],l[0][1]),s.lineEnd();var m=s.clean(),x=u.result(),M,I=x.length,y,N,k;if(l.pop(),g.push(l),l=null,!!I){if(m&1){if(N=x[0],(y=N.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),M=0;M<y;++M)i.point((k=N[M])[0],k[1]);i.lineEnd()}return}I>1&&m&2&&x.push(x.pop().concat(x.shift())),o.push(x.filter(hi))}}return c}}function hi(n){return n.length>1}function gi(n,t){return((n=n.x)[0]<0?n[1]-tn-V:tn-n[1])-((t=t.x)[0]<0?t[1]-tn-V:tn-t[1])}const Te=je(function(){return!0},_i,Si,[-L,-tn]);function _i(n){var t=NaN,r=NaN,e=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(f,u){var s=f>0?L:-L,h=G(f-t);G(h-L)<V?(n.point(t,r=(r+u)/2>0?tn:-tn),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),n.point(f,r),i=0):e!==s&&h>=L&&(G(t-e)<V&&(t-=e*V),G(f-s)<V&&(f-=s*V),r=yi(t,r,f,u),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),i=0),n.point(t=f,r=u),e=s},lineEnd:function(){n.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function yi(n,t,r,e){var i,f,u=K(n-r);return G(u)>V?le((K(t)*(f=B(e))*K(r)-K(e)*(i=B(t))*K(n))/(i*f*u)):(t+e)/2}function Si(n,t,r,e){var i;if(n==null)i=r*tn,e.point(-L,i),e.point(0,i),e.point(L,i),e.point(L,0),e.point(L,-i),e.point(0,-i),e.point(-L,-i),e.point(-L,0),e.point(-L,i);else if(G(n[0]-t[0])>V){var f=n[0]<t[0]?L:-L;i=r*f/2,e.point(-f,i),e.point(0,i),e.point(f,i)}else e.point(t[0],t[1])}function wi(n){var t=B(n),r=2*rn,e=t>0,i=G(t)>V;function f(o,l,c,d){di(d,n,r,c,o,l)}function u(o,l){return B(o)*B(l)>t}function s(o){var l,c,d,v,E;return{lineStart:function(){v=d=!1,E=1},point:function(p,w){var C=[p,w],T,m=u(p,w),x=e?m?0:g(p,w):m?g(p+(p<0?L:-L),w):0;if(!l&&(v=d=m)&&o.lineStart(),m!==d&&(T=h(l,C),(!T||ft(l,T)||ft(C,T))&&(C[2]=1)),m!==d)E=0,m?(o.lineStart(),T=h(C,l),o.point(T[0],T[1])):(T=h(l,C),o.point(T[0],T[1],2),o.lineEnd()),l=T;else if(i&&l&&e^m){var M;!(x&c)&&(M=h(C,l,!0))&&(E=0,e?(o.lineStart(),o.point(M[0][0],M[0][1]),o.point(M[1][0],M[1][1]),o.lineEnd()):(o.point(M[1][0],M[1][1]),o.lineEnd(),o.lineStart(),o.point(M[0][0],M[0][1],3)))}m&&(!l||!ft(l,C))&&o.point(C[0],C[1]),l=C,d=m,c=x},lineEnd:function(){d&&o.lineEnd(),l=null},clean:function(){return E|(v&&d)<<1}}}function h(o,l,c){var d=Hn(o),v=Hn(l),E=[1,0,0],p=ct(d,v),w=rt(p,p),C=p[0],T=w-C*C;if(!T)return!c&&o;var m=t*w/T,x=-t*C/T,M=ct(E,p),I=it(E,m),y=it(p,x);Lt(I,y);var N=M,k=rt(I,N),R=rt(N,N),$=k*k-R*(rt(I,I)-1);if(!($<0)){var O=In($),U=it(N,(-k-O)/R);if(Lt(U,I),U=Xt(U),!c)return U;var _=o[0],F=l[0],A=o[1],z=l[1],Z;F<_&&(Z=_,_=F,F=Z);var _n=F-_,en=G(_n-L)<V,un=en||_n<V;if(!en&&z<A&&(Z=A,A=z,z=Z),un?en?A+z>0^U[1]<(G(U[0]-_)<V?A:z):A<=U[1]&&U[1]<=z:_n>L^(_<=U[0]&&U[0]<=F)){var dn=it(N,(-k+O)/R);return Lt(dn,I),[U,Xt(dn)]}}}function g(o,l){var c=e?n:L-n,d=0;return o<-c?d|=1:o>c&&(d|=2),l<-c?d|=4:l>c&&(d|=8),d}return je(u,s,f,e?[0,-n]:[-L,n-L])}function Ei(n,t,r,e,i,f){var u=n[0],s=n[1],h=t[0],g=t[1],o=0,l=1,c=h-u,d=g-s,v;if(v=r-u,!(!c&&v>0)){if(v/=c,c<0){if(v<o)return;v<l&&(l=v)}else if(c>0){if(v>l)return;v>o&&(o=v)}if(v=i-u,!(!c&&v<0)){if(v/=c,c<0){if(v>l)return;v>o&&(o=v)}else if(c>0){if(v<o)return;v<l&&(l=v)}if(v=e-s,!(!d&&v>0)){if(v/=d,d<0){if(v<o)return;v<l&&(l=v)}else if(d>0){if(v>l)return;v>o&&(o=v)}if(v=f-s,!(!d&&v<0)){if(v/=d,d<0){if(v>l)return;v>o&&(o=v)}else if(d>0){if(v<o)return;v<l&&(l=v)}return o>0&&(n[0]=u+o*c,n[1]=s+o*d),l<1&&(t[0]=u+l*c,t[1]=s+l*d),!0}}}}}var Gn=1e9,at=-Gn;function mi(n,t,r,e){function i(g,o){return n<=g&&g<=r&&t<=o&&o<=e}function f(g,o,l,c){var d=0,v=0;if(g==null||(d=u(g,l))!==(v=u(o,l))||h(g,o)<0^l>0)do c.point(d===0||d===3?n:r,d>1?e:t);while((d=(d+l+4)%4)!==v);else c.point(o[0],o[1])}function u(g,o){return G(g[0]-n)<V?o>0?0:3:G(g[0]-r)<V?o>0?2:1:G(g[1]-t)<V?o>0?1:0:o>0?3:2}function s(g,o){return h(g.x,o.x)}function h(g,o){var l=u(g,1),c=u(o,1);return l!==c?l-c:l===0?o[1]-g[1]:l===1?g[0]-o[0]:l===2?g[1]-o[1]:o[0]-g[0]}return function(g){var o=g,l=Ge(),c,d,v,E,p,w,C,T,m,x,M,I={point:y,lineStart:$,lineEnd:O,polygonStart:k,polygonEnd:R};function y(_,F){i(_,F)&&o.point(_,F)}function N(){for(var _=0,F=0,A=d.length;F<A;++F)for(var z=d[F],Z=1,_n=z.length,en=z[0],un,dn,bn=en[0],Pn=en[1];Z<_n;++Z)un=bn,dn=Pn,en=z[Z],bn=en[0],Pn=en[1],dn<=e?Pn>e&&(bn-un)*(e-dn)>(Pn-dn)*(n-un)&&++_:Pn<=e&&(bn-un)*(e-dn)<(Pn-dn)*(n-un)&&--_;return _}function k(){o=l,c=[],d=[],M=!0}function R(){var _=N(),F=M&&_,A=(c=Ze(c)).length;(F||A)&&(g.polygonStart(),F&&(g.lineStart(),f(null,null,1,g),g.lineEnd()),A&&We(c,s,_,f,g),g.polygonEnd()),o=g,c=d=v=null}function $(){I.point=U,d&&d.push(v=[]),x=!0,m=!1,C=T=NaN}function O(){c&&(U(E,p),w&&m&&l.rejoin(),c.push(l.result())),I.point=y,m&&o.lineEnd()}function U(_,F){var A=i(_,F);if(d&&v.push([_,F]),x)E=_,p=F,w=A,x=!1,A&&(o.lineStart(),o.point(_,F));else if(A&&m)o.point(_,F);else{var z=[C=Math.max(at,Math.min(Gn,C)),T=Math.max(at,Math.min(Gn,T))],Z=[_=Math.max(at,Math.min(Gn,_)),F=Math.max(at,Math.min(Gn,F))];Ei(z,Z,n,t,r,e)?(m||(o.lineStart(),o.point(z[0],z[1])),o.point(Z[0],Z[1]),A||o.lineEnd(),M=!1):A&&(o.lineStart(),o.point(_,F),M=!1)}C=_,T=F,m=A}return I}}const Wt=n=>n;var $t=new Fn,jt=new Fn,Ke,Qe,Kt,Qt,Cn={point:cn,lineStart:cn,lineEnd:cn,polygonStart:function(){Cn.lineStart=xi,Cn.lineEnd=Mi},polygonEnd:function(){Cn.lineStart=Cn.lineEnd=Cn.point=cn,$t.add(G(jt)),jt=new Fn},result:function(){var n=$t/2;return $t=new Fn,n}};function xi(){Cn.point=Ci}function Ci(n,t){Cn.point=Je,Ke=Kt=n,Qe=Qt=t}function Je(n,t){jt.add(Qt*n-Kt*t),Kt=n,Qt=t}function Mi(){Je(Ke,Qe)}var On=1/0,vt=On,nt=-On,dt=nt,pt={point:Pi,lineStart:cn,lineEnd:cn,polygonStart:cn,polygonEnd:cn,result:function(){var n=[[On,vt],[nt,dt]];return nt=dt=-(vt=On=1/0),n}};function Pi(n,t){n<On&&(On=n),n>nt&&(nt=n),t<vt&&(vt=t),t>dt&&(dt=t)}var Jt=0,ne=0,Wn=0,ht=0,gt=0,$n=0,te=0,ee=0,jn=0,nr,tr,Sn,wn,sn={point:zn,lineStart:Ie,lineEnd:Ne,polygonStart:function(){sn.lineStart=Ii,sn.lineEnd=Ni},polygonEnd:function(){sn.point=zn,sn.lineStart=Ie,sn.lineEnd=Ne},result:function(){var n=jn?[te/jn,ee/jn]:$n?[ht/$n,gt/$n]:Wn?[Jt/Wn,ne/Wn]:[NaN,NaN];return Jt=ne=Wn=ht=gt=$n=te=ee=jn=0,n}};function zn(n,t){Jt+=n,ne+=t,++Wn}function Ie(){sn.point=Ri}function Ri(n,t){sn.point=Ti,zn(Sn=n,wn=t)}function Ti(n,t){var r=n-Sn,e=t-wn,i=In(r*r+e*e);ht+=i*(Sn+n)/2,gt+=i*(wn+t)/2,$n+=i,zn(Sn=n,wn=t)}function Ne(){sn.point=zn}function Ii(){sn.point=ki}function Ni(){er(nr,tr)}function ki(n,t){sn.point=er,zn(nr=Sn=n,tr=wn=t)}function er(n,t){var r=n-Sn,e=t-wn,i=In(r*r+e*e);ht+=i*(Sn+n)/2,gt+=i*(wn+t)/2,$n+=i,i=wn*n-Sn*t,te+=i*(Sn+n),ee+=i*(wn+t),jn+=i*3,zn(Sn=n,wn=t)}function rr(n){this._context=n}rr.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,vn);break}}},result:cn};var re=new Fn,Ut,ir,or,Kn,Qn,tt={point:cn,lineStart:function(){tt.point=Ai},lineEnd:function(){Ut&&ar(ir,or),tt.point=cn},polygonStart:function(){Ut=!0},polygonEnd:function(){Ut=null},result:function(){var n=+re;return re=new Fn,n}};function Ai(n,t){tt.point=ar,ir=Kn=n,or=Qn=t}function ar(n,t){Kn-=n,Qn-=t,re.add(In(Kn*Kn+Qn*Qn)),Kn=n,Qn=t}let ke,_t,Ae,Fe;class ze{constructor(t){this._append=t==null?lr:Fi(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Ae||this._append!==_t){const e=this._radius,i=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,Ae=e,_t=this._append,Fe=this._,this._=i}this._+=Fe;break}}}result(){const t=this._;return this._="",t.length?t:null}}function lr(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Fi(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return lr;if(t!==ke){const r=10**t;ke=t,_t=function(i){let f=1;this._+=i[0];for(const u=i.length;f<u;++f)this._+=Math.round(arguments[f]*r)/r+i[f]}}return _t}function Ht(n,t){let r=3,e=4.5,i,f;function u(s){return s&&(typeof e=="function"&&f.pointRadius(+e.apply(this,arguments)),Dn(s,i(f))),f.result()}return u.area=function(s){return Dn(s,i(Cn)),Cn.result()},u.measure=function(s){return Dn(s,i(tt)),tt.result()},u.bounds=function(s){return Dn(s,i(pt)),pt.result()},u.centroid=function(s){return Dn(s,i(sn)),sn.result()},u.projection=function(s){return arguments.length?(i=s==null?(n=null,Wt):(n=s).stream,u):n},u.context=function(s){return arguments.length?(f=s==null?(t=null,new ze(r)):new rr(t=s),typeof e!="function"&&f.pointRadius(e),u):t},u.pointRadius=function(s){return arguments.length?(e=typeof s=="function"?s:(f.pointRadius(+s),+s),u):e},u.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{const h=Math.floor(s);if(!(h>=0))throw new RangeError(`invalid digits: ${s}`);r=h}return t===null&&(f=new ze(r)),u},u.projection(n).digits(r).context(t)}function ue(n){return function(t){var r=new ie;for(var e in n)r[e]=n[e];return r.stream=t,r}}function ie(){}ie.prototype={constructor:ie,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fe(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Dn(r,n.stream(pt)),t(pt.result()),e!=null&&n.clipExtent(e),n}function ur(n,t,r){return fe(n,function(e){var i=t[1][0]-t[0][0],f=t[1][1]-t[0][1],u=Math.min(i/(e[1][0]-e[0][0]),f/(e[1][1]-e[0][1])),s=+t[0][0]+(i-u*(e[1][0]+e[0][0]))/2,h=+t[0][1]+(f-u*(e[1][1]+e[0][1]))/2;n.scale(150*u).translate([s,h])},r)}function zi(n,t,r){return ur(n,[[0,0],t],r)}function bi(n,t,r){return fe(n,function(e){var i=+t,f=i/(e[1][0]-e[0][0]),u=(i-f*(e[1][0]+e[0][0]))/2,s=-f*e[0][1];n.scale(150*f).translate([u,s])},r)}function Li(n,t,r){return fe(n,function(e){var i=+t,f=i/(e[1][1]-e[0][1]),u=-f*e[0][0],s=(i-f*(e[1][1]+e[0][1]))/2;n.scale(150*f).translate([u,s])},r)}var be=16,Di=B(30*rn);function Le(n,t){return+t?Ui(n,t):$i(n)}function $i(n){return ue({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function Ui(n,t){function r(e,i,f,u,s,h,g,o,l,c,d,v,E,p){var w=g-e,C=o-i,T=w*w+C*C;if(T>4*t&&E--){var m=u+c,x=s+d,M=h+v,I=In(m*m+x*x+M*M),y=Jn(M/=I),N=G(G(M)-1)<V||G(f-l)<V?(f+l)/2:Un(x,m),k=n(N,y),R=k[0],$=k[1],O=R-e,U=$-i,_=C*O-w*U;(_*_/T>t||G((w*O+C*U)/T-.5)>.3||u*c+s*d+h*v<Di)&&(r(e,i,f,u,s,h,R,$,N,m/=I,x/=I,M,E,p),p.point(R,$),r(R,$,N,m,x,M,g,o,l,c,d,v,E,p))}}return function(e){var i,f,u,s,h,g,o,l,c,d,v,E,p={point:w,lineStart:C,lineEnd:m,polygonStart:function(){e.polygonStart(),p.lineStart=x},polygonEnd:function(){e.polygonEnd(),p.lineStart=C}};function w(y,N){y=n(y,N),e.point(y[0],y[1])}function C(){l=NaN,p.point=T,e.lineStart()}function T(y,N){var k=Hn([y,N]),R=n(y,N);r(l,c,o,d,v,E,l=R[0],c=R[1],o=y,d=k[0],v=k[1],E=k[2],be,e),e.point(l,c)}function m(){p.point=w,e.lineEnd()}function x(){C(),p.point=M,p.lineEnd=I}function M(y,N){T(i=y,N),f=l,u=c,s=d,h=v,g=E,p.point=T}function I(){r(l,c,o,d,v,E,f,u,i,s,h,g,be,e),p.lineEnd=m,m()}return p}}var Hi=ue({point:function(n,t){this.stream.point(n*rn,t*rn)}});function Oi(n){return ue({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}function Yi(n,t,r,e,i){function f(u,s){return u*=e,s*=i,[t+n*u,r-n*s]}return f.invert=function(u,s){return[(u-t)/n*e,(r-s)/n*i]},f}function De(n,t,r,e,i,f){if(!f)return Yi(n,t,r,e,i);var u=B(f),s=K(f),h=u*n,g=s*n,o=u/n,l=s/n,c=(s*r-u*t)/n,d=(s*t+u*r)/n;function v(E,p){return E*=e,p*=i,[h*E-g*p+t,r-g*E-h*p]}return v.invert=function(E,p){return[e*(o*E-l*p+c),i*(d-l*E-o*p)]},v}function qi(n){var t,r=150,e=480,i=250,f=0,u=0,s=0,h=0,g=0,o,l=0,c=1,d=1,v=null,E=Te,p=null,w,C,T,m=Wt,x=.5,M,I,y,N,k;function R(_){return y(_[0]*rn,_[1]*rn)}function $(_){return _=y.invert(_[0],_[1]),_&&[_[0]*pn,_[1]*pn]}R.stream=function(_){return N&&k===_?N:N=Hi(Oi(o)(E(M(m(k=_)))))},R.preclip=function(_){return arguments.length?(E=_,v=void 0,U()):E},R.postclip=function(_){return arguments.length?(m=_,p=w=C=T=null,U()):m},R.clipAngle=function(_){return arguments.length?(E=+_?wi(v=_*rn):(v=null,Te),U()):v*pn},R.clipExtent=function(_){return arguments.length?(m=_==null?(p=w=C=T=null,Wt):mi(p=+_[0][0],w=+_[0][1],C=+_[1][0],T=+_[1][1]),U()):p==null?null:[[p,w],[C,T]]},R.scale=function(_){return arguments.length?(r=+_,O()):r},R.translate=function(_){return arguments.length?(e=+_[0],i=+_[1],O()):[e,i]},R.center=function(_){return arguments.length?(f=_[0]%360*rn,u=_[1]%360*rn,O()):[f*pn,u*pn]},R.rotate=function(_){return arguments.length?(s=_[0]%360*rn,h=_[1]%360*rn,g=_.length>2?_[2]%360*rn:0,O()):[s*pn,h*pn,g*pn]},R.angle=function(_){return arguments.length?(l=_%360*rn,O()):l*pn},R.reflectX=function(_){return arguments.length?(c=_?-1:1,O()):c<0},R.reflectY=function(_){return arguments.length?(d=_?-1:1,O()):d<0},R.precision=function(_){return arguments.length?(M=Le(I,x=_*_),U()):In(x)},R.fitExtent=function(_,F){return ur(R,_,F)},R.fitSize=function(_,F){return zi(R,_,F)},R.fitWidth=function(_,F){return bi(R,_,F)},R.fitHeight=function(_,F){return Li(R,_,F)};function O(){var _=De(r,0,0,c,d,l).apply(null,t(f,u)),F=De(r,e-_[0],i-_[1],c,d,l);return o=vi(s,h,g),I=Bt(t,F),y=Bt(o,I),M=Le(I,x),U()}function U(){return N=k=null,R}return function(){return t=n.apply(this,arguments),R.invert=t.invert&&$,O()}}function Vi(n){var t=0,r=L/3,e=qi(n),i=e(t,r);return i.parallels=function(f){return arguments.length?e(t=f[0]*rn,r=f[1]*rn):[t*pn,r*pn]},i}function fr(n,t){return[n,qt(Be((tn+t)/2))]}fr.invert=function(n,t){return[n,2*le(si(t))-tn]};function lt(n){return Be((tn+n)/2)}function Xi(n,t){var r=B(n),e=n===t?K(n):qt(r/B(t))/qt(lt(t)/lt(n)),i=r*bt(lt(n),e)/e;if(!e)return fr;function f(u,s){i>0?s<-tn+V&&(s=-tn+V):s>tn-V&&(s=tn-V);var h=i/bt(lt(s),e);return[h*K(e*u),i-h*B(e*u)]}return f.invert=function(u,s){var h=i-s,g=Bn(e)*In(u*u+h*h),o=Un(u,G(h))*Bn(h);return h*e<0&&(o-=L*Bn(u)*Bn(h)),[o/e,2*le(bt(i/g,1/e))-tn]},f}function Zi(){return Vi(Xi).scale(109.5).parallels([30,30])}var Bi=oe('<path fill="#f5f5f5" stroke="#d4d4d8" stroke-width="1.5" vector-effect="non-scaling-stroke"></path>'),Gi=oe('<line stroke="#000" stroke-opacity="0.2" stroke-width="1" vector-effect="non-scaling-stroke"></line>'),Wi=oe('<g class="transition-opacity duration-200"><g data-label-hit="" class="cursor-pointer" role="button" tabindex="0"><!><rect fill="black" stroke="black" stroke-width="0" vector-effect="non-scaling-stroke"></rect><text text-anchor="middle" dominant-baseline="middle" font-weight="400" fill="white" class="pointer-events-none select-none" vector-effect="non-scaling-stroke"> </text><title> </title></g></g>'),ji=gn('<section class="bg-[#ccc]"><div class="absolute top-1 right-1 z-50 space-y-1 text-xs"><button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">+</button> <br/> <button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">−</button></div> <svg class="block h-full w-full cursor-grab touch-none select-none overflow-visible active:cursor-grabbing" preserveAspectRatio="xMidYMid meet" role="application" aria-label="Fanzine map (pan and zoom)"><g><!><!></g></svg></section>');function Ki(n,t){St(t,!1);let r=j(t,"italy",8,null),e=j(t,"points",24,()=>[]);j(t,"filteredItems",24,()=>[]);let i=j(t,"query",8,""),f=j(t,"projectionZoom",8,1.25),u=j(t,"labelPlacements",8,null),s=j(t,"disablePanZoomOnMobile",8,!0),h=j(t,"disableVisibleItems",8,!0),g=j(t,"onSelect",8,null);const o=$e(),l=1500,c=1800;let d=W(null),v=W(""),E=W(null),p=W([]),w=W([]),C=W([]);const T=0,m=0;let x=W(1),M=W(T),I=W(m),y=!1,N={x:0,y:0,translateX:0,translateY:0},k=!1,R=W(!1),$=W(!1),O=!1,U=!1,_=null,F=null,A=null,z=W(!1);function Z(P){const S=P.currentTarget?.ownerSVGElement||P.currentTarget;if(!S?.createSVGPoint)return{x:0,y:0};const H=S.createSVGPoint();H.x=P.clientX,H.y=P.clientY;const X=S.getScreenCTM?.();if(!X)return{x:0,y:0};const Q=X.inverse(),ln=H.matrixTransform(Q);return{x:ln.x,y:ln.y}}function _n(P){const S=P.composedPath?.();return S?S.some(H=>H?.dataset&&"labelHit"in H.dataset):!!P.target?.closest?.("[data-label-hit]")}function en(P,S=l/2,H=c/2){if(a(z))return;const X=P>0?1.05:1/1.05,Q=Math.max(.5,Math.min(8,a(x)*X));if(Q===a(x))return;const ln=S-(S-a(M))/a(x)*Q,yn=H-(H-a(I))/a(x)*Q;un(ln,yn,Q)}function un(P,S,H){if(A={x:P,y:S,scale:H},typeof requestAnimationFrame>"u"){b(M,A.x),b(I,A.y),b(x,A.scale),A=null;return}F||(F=requestAnimationFrame(()=>{A&&(b(M,A.x),b(I,A.y),b(x,A.scale)),A=null,F=null}))}function dn(){if(!a(d)||!e()||e().length===0){b(C,[]);return}const P=100;b(C,e().filter(S=>{const H=parseFloat(S.latitude),X=parseFloat(S.longitude);if(!isFinite(H)||!isFinite(X))return!1;const[Q,ln]=a(d)([X,H]),yn=a(M)+Q*a(x),En=a(I)+ln*a(x);return yn>-P&&yn<l+P&&En>-P&&En<c+P})),o("visibleItemsChange",a(C))}function bn(P){if(a(z))return;P.preventDefault();const S=P.deltaY>0?-1:1,H=Z(P);en(S,H.x,H.y)}function Pn(P){if(a(z)||P.button!=null&&P.button!==0)return;O=_n(P),y=!1,U=!0,_=P.pointerId,k=!1,b($,!1);const S=Z(P);N={x:S.x,y:S.y,translateX:a(M),translateY:a(I)}}function sr(P){if(a(z)||!U&&!y||_!=null&&P.pointerId!==_)return;const S=Z(P),H=S.x-N.x,X=S.y-N.y;!k&&Math.hypot(H,X)>3&&(k=!0,b($,!0),b(R,O),y=!0,_n(P)&&b(R,!0),P.currentTarget.setPointerCapture?.(P.pointerId)),k&&un(N.translateX+H,N.translateY+X,a(x))}function cr(P){a(z)||Et(P)}function vr(P){a(z)||Et(P,!0)}function Et(P,S=!1){y=!1,U=!1,_=null,P?.currentTarget&&P.currentTarget.releasePointerCapture?.(P.pointerId),k&&!S?(b(R,!0),setTimeout(()=>{b(R,!1),b($,!1)},160)):(b($,!1),b(R,!1)),O=!1,k=!1}function dr(P,S){if(!P||!isFinite(S)||S===1)return;const H=l/2,X=c/2,[Q,ln]=P.translate();P.scale(P.scale()*S),P.translate([H+(Q-H)*S,X+(ln-X)*S])}function pr(P,S){(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),o("select",S))}kn(()=>(Nn(r()),Nn(f()),Ht),()=>{if(r()){const P=Zi().parallels([37,45]);P.fitExtent([[0,0],[l,c]],r()),dr(P,f()),b(d,P),b(v,Ht(P)(r())||"");const S=Ht(P).bounds(r());b(E,S?{left:S[0][0],top:S[0][1],right:S[1][0],bottom:S[1][1]}:null)}}),kn(()=>Nn(u()),()=>{u()&&u().length&&b(p,u())}),kn(()=>(a(p),Nn(i()),a(M),a(x),a(I)),()=>{const P=a(p)||[],S=i()?P.filter(X=>{const Q=i().toLowerCase();return X.fanzine?.toLowerCase().includes(Q)||X.city?.toLowerCase().includes(Q)||X.genre?.toLowerCase().includes(Q)}):P,H=120;b(w,S.filter(X=>{const Q=a(M)+X.x*a(x),ln=a(I)+X.y*a(x);return Q>-H&&Q<l+H&&ln>-H&&ln<c+H}))}),kn(()=>(Nn(h()),a(C),a(x),a(M),a(I)),()=>{h()?(b(C,[]),o("visibleItemsChange",a(C))):(a(x),a(M),a(I),dn())}),kn(()=>Nn(s()),()=>{if(typeof window<"u"){const P=window.matchMedia?.("(pointer: coarse)")?.matches||window.matchMedia?.("(hover: none)")?.matches;b(z,!!(s()&&P))}}),Ye(),yt();var mt=ji(),xt=q(mt),Ct=q(xt),se=nn(Ct,4);Y(xt);var Rn=nn(xt,2);J(Rn,"viewBox",`0 0 ${l} ${c}`);var Mt=q(Rn),ce=q(Mt);{var hr=P=>{var S=Bi();hn(()=>J(S,"d",a(v))),an(P,S)};An(ce,P=>{a(v)&&P(hr)})}var gr=nn(ce);qe(gr,1,()=>a(w),Xr,(P,S)=>{var H=Wi(),X=q(H),Q=q(X);{var ln=Yn=>{var qn=Gi();hn(()=>{J(qn,"x1",(a(S),D(()=>a(S).x0))),J(qn,"y1",(a(S),D(()=>a(S).y0))),J(qn,"x2",(a(S),D(()=>a(S).x))),J(qn,"y2",(a(S),D(()=>a(S).y)))}),an(Yn,qn)};An(Q,Yn=>{a(S),D(()=>Math.hypot(a(S).x-a(S).x0,a(S).y-a(S).y0)>6)&&Yn(ln)})}var yn=nn(Q),En=nn(yn),_r=q(En,!0);Y(En);var ve=nn(En),yr=q(ve);Y(ve),Y(X),Y(H),hn(()=>{J(yn,"x",(a(S),D(()=>a(S).x-a(S).width/2))),J(yn,"y",(a(S),D(()=>a(S).y-a(S).height/2))),J(yn,"width",(a(S),D(()=>a(S).width))),J(yn,"height",(a(S),D(()=>a(S).height))),J(En,"x",(a(S),D(()=>a(S).x))),J(En,"y",(a(S),D(()=>a(S).y))),J(En,"font-size",(a(S),D(()=>a(S).fontSize))),xn(_r,(a(S),D(()=>a(S).text))),xn(yr,`${a(S),D(()=>a(S).fanzine)??""} (${a(S),D(()=>a(S).city)??""})`)}),fn("pointerup",X,ni(()=>{Et(),!a(R)&&!a($)&&!a(z)&&(g()?.(a(S)),o("select",a(S)))})),fn("click",X,()=>{!a(R)&&!a($)&&!a(z)&&(g()?.(a(S)),o("select",a(S)))}),fn("keydown",X,Yn=>pr(Yn,a(S))),an(P,H)}),Y(Mt),Y(Rn),Y(mt),hn(()=>{Ct.disabled=a(z),se.disabled=a(z),J(Mt,"transform",`translate(${a(M)} ${a(I)}) scale(${a(x)})`)}),fn("click",Ct,()=>en(1)),fn("click",se,()=>en(-1)),fn("wheel",Rn,bn),fn("pointerdown",Rn,Pn),fn("pointermove",Rn,sr),fn("pointerup",Rn,cr),fn("pointercancel",Rn,vr),an(n,mt),wt()}var Qi=gn('<button type="button" class=" border border-black px-1 py-0.5 text-xs text-black">X</button>'),Ji=gn('<div class="grid w-full max-w-[280px]"><div class="flex items-center gap-0.5"><input type="text" placeholder="Cerca..." class="flex-1 border border-black bg-white px-1 py-0.5 text-xs text-black outline-none" aria-label="Search fanzines"/> <!></div></div>');function no(n,t){St(t,!1);let r=j(t,"query",12,"");j(t,"totalCount",8,0),j(t,"visibleCount",8,0),j(t,"resultsCount",8,0);let e=j(t,"hasSelection",8,!1);const i=$e();function f(){r(""),i("clear")}yt();var u=Ji(),s=q(u),h=q(s);Vr(h);var g=nn(h,2);{var o=l=>{var c=Qi();fn("click",c,f),an(l,c)};An(g,l=>{(r()||e())&&l(o)})}Y(s),Y(u),Jr(h,r),an(n,u),wt()}var to=gn('<img class="h-full w-full object-contain" loading="lazy"/>'),eo=gn('<div class="mt-0.5 text-[.6rem] leading-snug text-black/60"><div> </div> <button type="button" class="mt-0.5 text-[.6rem] font-medium text-blue-600 hover:text-blue-800"> </button></div>'),ro=gn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] hover:bg-black/10" target="_blank" rel="noreferrer">PDF</a>'),io=gn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] text-black hover:bg-black/10" target="_blank" rel="noreferrer">Link</a>'),oo=gn('<div role="listitem" class=" bg-white p-0.5 text-left shadow-sm"><div class="aspect-[3/4] w-full overflow-hidden  bg-black/5"><!></div> <div class="mt-0 mb-0.5 truncate font-bold leading-tight text-[.6rem]"> </div> <div class="truncate leading-tight text-[.6rem]"> </div> <div class="mt-0 line-clamp-2 leading-tight text-[.6rem]"> </div> <!> <div class="mt-0.5 gap-0.5 "><!> <!></div></div>'),ao=gn('<div class="py-0.5"><div class="text-xs leading-tight text-black/70"><strong class="text-black"> </strong> fanzine</div> <div class="grid grid-cols-5 md:grid-cols-12  gap-0.5 p-0.5" role="list" aria-label="Fanzines"></div></div>');function lo(n,t){St(t,!1);let r=j(t,"items",24,()=>[]);const e="https://www.paolopalmacci.it/capitmundi/";let i=W(null);function f(d){return d?/^https?:\/\//i.test(d)?d:`${e}${String(d).replace(/^\/+/,"")}`:""}function u(d){return d?.yearStart?d?.yearEnd&&d.yearEnd!==d.yearStart?`${d.yearStart}-${d.yearEnd}`:String(d.yearStart):""}function s(d,v){const E=[d?.sourceFile,d?.canonicalUrl,d?.pdfHref,d?.title,d?.fanzine,d?.city,d?.yearStart,d?.yearEnd].filter(p=>p!=null&&String(p).trim()!=="").map(p=>String(p));return E.length?`${E.join("|")}|${v}`:String(v)}yt();var h=ao(),g=q(h),o=q(g),l=q(o,!0);Y(o),Yr(),Y(g);var c=nn(g,2);qe(c,7,r,(d,v)=>s(d,v),(d,v,E)=>{var p=oo(),w=q(p),C=q(w);{var T=A=>{var z=to();hn(Z=>{J(z,"src",Z),J(z,"alt",(a(v),D(()=>a(v).fanzine||"Fanzine cover")))},[()=>(a(v),D(()=>f(a(v).ogImage)))]),an(A,z)};An(C,A=>{a(v),D(()=>a(v).ogImage)&&A(T)})}Y(w);var m=nn(w,2),x=q(m,!0);Y(m);var M=nn(m,2),I=q(M);Y(M);var y=nn(M,2),N=q(y);Y(y);var k=nn(y,2);{var R=A=>{var z=eo(),Z=q(z),_n=q(Z,!0);Y(Z);var en=nn(Z,2),un=q(en,!0);Y(en),Y(z),hn(()=>{Qr(Z,1,jr(a(i)===a(E)?"":"line-clamp-3")),xn(_n,(a(v),D(()=>a(v).description))),xn(un,a(i)===a(E)?"Read less":"Read more")}),fn("click",en,()=>{b(i,a(i)===a(E)?null:a(E))}),an(A,z)};An(k,A=>{a(v),D(()=>a(v).description)&&A(R)})}var $=nn(k,2),O=q($);{var U=A=>{var z=ro();hn(Z=>J(z,"href",Z),[()=>(a(v),D(()=>f(a(v).pdfHref)))]),an(A,z)};An(O,A=>{a(v),D(()=>a(v)?.pdfHref)&&A(U)})}var _=nn(O,2);{var F=A=>{var z=io();hn(()=>J(z,"href",(a(v),D(()=>a(v).canonicalUrl)))),an(A,z)};An(_,A=>{a(v),D(()=>a(v)?.canonicalUrl)&&A(F)})}Y($),Y(p),hn(A=>{xn(x,(a(v),D(()=>a(v).fanzine))),xn(I,`${a(v),D(()=>a(v).city)??""}${a(v),D(()=>a(v).country?`, ${a(v).country}`:"")??""}`),xn(N,`${a(v),D(()=>a(v).genre||"—")??""}${A??""}`)},[()=>(a(v),D(()=>u(a(v))?` · ${u(a(v))}`:""))]),an(d,p)}),Y(c),Y(h),hn(()=>xn(l,(Nn(r()),D(()=>r().length)))),an(n,h),wt()}var uo=gn('<!> <div class="sticky top-0 z-0 h-[65vh] w-full"><div class="h-full w-full overflow-hidden bg-white"><!></div></div> <div class="relative mx-auto bg-white w-full px-2 py-1"><!> <!></div>',1);function _o(n,t){St(t,!1);const r=W(),e=W();function i(y){return{sourceFile:y.source_file,canonicalUrl:y.canonical_url,title:y.title,fanzine:y.fanzine||"N/A",city:y.city||"Unknown",country:y.country,activity:y.activity,yearStart:y.year_start,yearEnd:y.year_end,genre:y.genre,description:y.description,pdfHref:y.pdf_href,ogImage:y.og_image,latitude:y.latitude,longitude:y.longitude}}let f=W(null),u=W([]),s=W([]),h=W([]),g=!0,o=W(""),l=W(null),c=W([]);function d(){b(o,""),b(l,null)}function v(y){b(l,y.detail)}function E(y){b(c,y.detail)}Sr(async()=>{try{g=!0;const y=await fetch("/data/italy2.geojson");if(!y.ok)throw new Error("Failed to load geojson");b(f,await y.json());const N=await fetch("/fanzines.csv");if(!N.ok)throw new Error("Failed to load fanzines.csv");const k=await N.text();b(u,ai(k).map(i));try{const R=await fetch("/data/label_placements.json");if(R.ok){const $=await R.json();b(h,Array.isArray($)?$:$.labels||[])}}catch(R){console.warn("Failed to load label placements",R)}b(s,a(u).map(R=>{const $=parseFloat(R.latitude),O=parseFloat(R.longitude);return!isFinite($)||!isFinite(O)?null:{...R,lat:$,lon:O}}).filter(Boolean))}catch(y){y instanceof Error?y.message:String(y)}finally{g=!1}}),kn(()=>(a(o),a(u)),()=>{b(r,a(o)?a(u).filter(y=>{const N=a(o).toLowerCase();return y.fanzine?.toLowerCase().includes(N)||y.city?.toLowerCase().includes(N)||y.genre?.toLowerCase().includes(N)}):[])}),kn(()=>(a(o),a(s)),()=>{b(e,a(o)?a(s).filter(y=>{const N=a(o).toLowerCase();return y.fanzine?.toLowerCase().includes(N)||y.city?.toLowerCase().includes(N)||y.genre?.toLowerCase().includes(N)}).length:a(s).length)}),Ye(),yt();var p=uo(),w=qr(p);ui(w,{});var C=nn(w,2),T=q(C),m=q(T);{let y=ut(()=>a(l)?[a(l)]:a(o)?a(r):a(u));Ki(m,{get italy(){return a(f)},get points(){return a(s)},get labelPlacements(){return a(h)},get query(){return a(o)},projectionZoom:1,get filteredItems(){return a(y)},$$events:{select:v,visibleItemsChange:E}})}Y(T),Y(C);var x=nn(C,2),M=q(x);{let y=ut(()=>!!a(l));no(M,{get totalCount(){return a(u),D(()=>a(u).length)},get visibleCount(){return a(e)},get resultsCount(){return a(r),D(()=>a(r).length)},get hasSelection(){return a(y)},get query(){return a(o)},set query(N){b(o,N)},$$events:{clear:d},$$legacy:!0})}var I=nn(M,2);{let y=ut(()=>(a(l),a(o),a(r),a(c),a(u),D(()=>a(l)?[a(l)]:a(o)?a(r):a(c).length>0?a(c):a(u))));lo(I,{get items(){return a(y)}})}Y(x),an(n,p),wt()}export{_o as component};

import{a as on,f as gn,d as oe}from"../chunks/evFuCTkd.js";import{e as bt,n as Sr,aR as Ue,h as En,w as Tt,T as mr,o as wr,A as f,t as Er,H as xr,v as ve,x as Rt,i as it,ae as Cr,aI as Mr,aq as de,c as Un,aS as Mn,f as qt,s as Pr,M as br,aT as Tr,aG as ae,aU as Rr,aV as Ir,aN as Ar,ad as pe,aW as kr,r as Ye,p as He,aX as It,q as Nr,aY as zr,aZ as Fr,aF as Lr,d as Dr,aC as Ur,a_ as Yr,aO as Hr,k as qr,ab as Or,a$ as Xr,a5 as vn,a7 as H,a8 as Y,a9 as J,a3 as St,aP as O,B as xn,u as Dn,C as R,a6 as mt,ar as $r,_ as Vr,a4 as Zr,aQ as $n}from"../chunks/Bp8pB4gU.js";import{s as yn,e as cn}from"../chunks/DEBbc6RU.js";import{p as j,i as Nn}from"../chunks/D8zbcI5x.js";import{s as K,r as Br}from"../chunks/DzEVTUEa.js";function Gr(n,t){return t}function Wr(n,t,r){for(var e=[],i=t.length,l,u=t.length,s=0;s<i;s++){let a=t[s];He(a,()=>{if(l){if(l.pending.delete(a),l.done.add(a),l.pending.size===0){var c=n.outrogroups;Ot(ae(l.done)),c.delete(l),c.size===0&&(n.outrogroups=null)}}else u-=1},!1)}if(u===0){var p=e.length===0&&r!==null;if(p){var h=r,o=h.parentNode;Lr(o),o.append(h),n.items.clear()}Ot(t,!p)}else l={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(l)}function Ot(n,t=!0){for(var r=0;r<n.length;r++)Dr(n[r],t)}var he;function qe(n,t,r,e,i,l=null){var u=n,s=new Map,p=(t&Ue)!==0;if(p){var h=n;u=En?Tt(mr(h)):h.appendChild(bt())}En&&wr();var o=null,a=br(()=>{var S=r();return Tr(S)?S:S==null?[]:ae(S)}),c,v=!0;function g(){d.fallback=o,jr(d,c,u,t,e),o!==null&&(c.length===0?(o.f&Mn)===0?Ye(o):(o.f^=Mn,Bn(o,null,u)):He(o,()=>{o=null}))}var E=Sr(()=>{c=f(a);var S=c.length;let b=!1;if(En){var T=Er(u)===xr;T!==(S===0)&&(u=ve(),Tt(u),Rt(!1),b=!0)}for(var m=new Set,x=Un,M=Pr(),I=0;I<S;I+=1){En&&it.nodeType===Cr&&it.data===Mr&&(u=it,b=!0,Rt(!1));var k=c[I],z=e(k,I),y=v?null:s.get(z);y?(y.v&&de(y.v,k),y.i&&de(y.i,I),M&&x.skipped_effects.delete(y.e)):(y=Qr(s,v?u:he??=bt(),k,z,I,i,t,r),v||(y.e.f|=Mn),s.set(z,y)),m.add(z)}if(S===0&&l&&!o&&(v?o=qt(()=>l(u)):(o=qt(()=>l(he??=bt())),o.f|=Mn)),En&&S>0&&Tt(ve()),!v)if(M){for(const[C,Z]of s)m.has(C)||x.skipped_effects.add(Z.e);x.oncommit(g),x.ondiscard(()=>{})}else g();b&&Rt(!0),f(a)}),d={effect:E,items:s,outrogroups:null,fallback:o};v=!1,En&&(u=it)}function Vn(n){for(;n!==null&&(n.f&zr)===0;)n=n.next;return n}function jr(n,t,r,e,i){var l=(e&Fr)!==0,u=t.length,s=n.items,p=Vn(n.effect.first),h,o=null,a,c=[],v=[],g,E,d,S;if(l)for(S=0;S<u;S+=1)g=t[S],E=i(g,S),d=s.get(E).e,(d.f&Mn)===0&&(d.nodes?.a?.measure(),(a??=new Set).add(d));for(S=0;S<u;S+=1){if(g=t[S],E=i(g,S),d=s.get(E).e,n.outrogroups!==null)for(const y of n.outrogroups)y.pending.delete(d),y.done.delete(d);if((d.f&Mn)!==0)if(d.f^=Mn,d===p)Bn(d,null,r);else{var b=o?o.next:p;d===n.effect.last&&(n.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),In(n,o,d),In(n,d,b),Bn(d,b,r),o=d,c=[],v=[],p=Vn(o.next);continue}if((d.f&It)!==0&&(Ye(d),l&&(d.nodes?.a?.unfix(),(a??=new Set).delete(d))),d!==p){if(h!==void 0&&h.has(d)){if(c.length<v.length){var T=v[0],m;o=T.prev;var x=c[0],M=c[c.length-1];for(m=0;m<c.length;m+=1)Bn(c[m],T,r);for(m=0;m<v.length;m+=1)h.delete(v[m]);In(n,x.prev,M.next),In(n,o,x),In(n,M,T),p=T,o=M,S-=1,c=[],v=[]}else h.delete(d),Bn(d,p,r),In(n,d.prev,d.next),In(n,d,o===null?n.effect.first:o.next),In(n,o,d),o=d;continue}for(c=[],v=[];p!==null&&p!==d;)(h??=new Set).add(p),v.push(p),p=Vn(p.next);if(p===null)continue}(d.f&Mn)===0&&c.push(d),o=d,p=Vn(d.next)}if(n.outrogroups!==null){for(const y of n.outrogroups)y.pending.size===0&&(Ot(ae(y.done)),n.outrogroups?.delete(y));n.outrogroups.size===0&&(n.outrogroups=null)}if(p!==null||h!==void 0){var I=[];if(h!==void 0)for(d of h)(d.f&It)===0&&I.push(d);for(;p!==null;)(p.f&It)===0&&p!==n.fallback&&I.push(p),p=Vn(p.next);var k=I.length;if(k>0){var z=(e&Ue)!==0&&u===0?r:null;if(l){for(S=0;S<k;S+=1)I[S].nodes?.a?.measure();for(S=0;S<k;S+=1)I[S].nodes?.a?.fix()}Wr(n,I,z)}}l&&Nr(()=>{if(a!==void 0)for(d of a)d.nodes?.a?.apply()})}function Qr(n,t,r,e,i,l,u,s){var p=(u&Rr)!==0?(u&Ir)===0?Ar(r,!1,!1):pe(r):null,h=(u&kr)!==0?pe(i):null;return{v:p,i:h,e:qt(()=>(l(t,p??r,h??i,s),()=>{n.delete(e)}))}}function Bn(n,t,r){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end,l=t&&(t.f&Mn)===0?t.nodes.start:r;e!==null;){var u=Ur(e);if(l.before(e),e===i)return;e=u}}function In(n,t,r){t===null?n.effect.first=r:t.next=r,r===null?n.effect.last=t:r.prev=t}function Oe(n){var t,r,e="";if(typeof n=="string"||typeof n=="number")e+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=Oe(n[t]))&&(e&&(e+=" "),e+=r)}else for(r in n)n[r]&&(e&&(e+=" "),e+=r);return e}function Kr(){for(var n,t,r=0,e="",i=arguments.length;r<i;r++)(n=arguments[r])&&(t=Oe(n))&&(e&&(e+=" "),e+=t);return e}function Jr(n){return typeof n=="object"?Kr(n):n??""}function ni(n,t,r){var e=n==null?"":""+n;return e===""?null:e}function ti(n,t,r,e,i,l){var u=n.__className;if(En||u!==r||u===void 0){var s=ni(r);(!En||s!==n.getAttribute("class"))&&(s==null?n.removeAttribute("class"):n.className=s),n.__className=r}return l}function ei(n,t,r=t){var e=new WeakSet;Yr(n,"input",async i=>{var l=i?n.defaultValue:n.value;if(l=At(n)?kt(l):l,r(l),Un!==null&&e.add(Un),await Hr(),l!==(l=t())){var u=n.selectionStart,s=n.selectionEnd,p=n.value.length;if(n.value=l??"",s!==null){var h=n.value.length;u===s&&s===p&&h>p?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=u,n.selectionEnd=Math.min(s,h))}}}),(En&&n.defaultValue!==n.value||qr(t)==null&&n.value)&&(r(At(n)?kt(n.value):n.value),Un!==null&&e.add(Un)),Or(()=>{var i=t();if(n===document.activeElement){var l=Xr??Un;if(e.has(l))return}At(n)&&i===kt(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function At(n){var t=n.type;return t==="number"||t==="range"}function kt(n){return n===""?null:+n}function ri(n){return function(...t){var r=t[0];return r.stopPropagation(),n?.apply(this,t)}}var ge={},Nt={},zt=34,Zn=10,Ft=13;function Xe(n){return new Function("d","return {"+n.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function ii(n,t){var r=Xe(n);return function(e,i){return t(r(e),i,n)}}function _e(n){var t=Object.create(null),r=[];return n.forEach(function(e){for(var i in e)i in t||r.push(t[i]=i)}),r}function sn(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function oi(n){return n<0?"-"+sn(-n,6):n>9999?"+"+sn(n,6):sn(n,4)}function ai(n){var t=n.getUTCHours(),r=n.getUTCMinutes(),e=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":oi(n.getUTCFullYear())+"-"+sn(n.getUTCMonth()+1,2)+"-"+sn(n.getUTCDate(),2)+(i?"T"+sn(t,2)+":"+sn(r,2)+":"+sn(e,2)+"."+sn(i,3)+"Z":e?"T"+sn(t,2)+":"+sn(r,2)+":"+sn(e,2)+"Z":r||t?"T"+sn(t,2)+":"+sn(r,2)+"Z":"")}function li(n){var t=new RegExp('["'+n+`
\r]`),r=n.charCodeAt(0);function e(a,c){var v,g,E=i(a,function(d,S){if(v)return v(d,S-1);g=d,v=c?ii(d,c):Xe(d)});return E.columns=g||[],E}function i(a,c){var v=[],g=a.length,E=0,d=0,S,b=g<=0,T=!1;a.charCodeAt(g-1)===Zn&&--g,a.charCodeAt(g-1)===Ft&&--g;function m(){if(b)return Nt;if(T)return T=!1,ge;var M,I=E,k;if(a.charCodeAt(I)===zt){for(;E++<g&&a.charCodeAt(E)!==zt||a.charCodeAt(++E)===zt;);return(M=E)>=g?b=!0:(k=a.charCodeAt(E++))===Zn?T=!0:k===Ft&&(T=!0,a.charCodeAt(E)===Zn&&++E),a.slice(I+1,M-1).replace(/""/g,'"')}for(;E<g;){if((k=a.charCodeAt(M=E++))===Zn)T=!0;else if(k===Ft)T=!0,a.charCodeAt(E)===Zn&&++E;else if(k!==r)continue;return a.slice(I,M)}return b=!0,a.slice(I,g)}for(;(S=m())!==Nt;){for(var x=[];S!==ge&&S!==Nt;)x.push(S),S=m();c&&(x=c(x,d++))==null||v.push(x)}return v}function l(a,c){return a.map(function(v){return c.map(function(g){return o(v[g])}).join(n)})}function u(a,c){return c==null&&(c=_e(a)),[c.map(o).join(n)].concat(l(a,c)).join(`
`)}function s(a,c){return c==null&&(c=_e(a)),l(a,c).join(`
`)}function p(a){return a.map(h).join(`
`)}function h(a){return a.map(o).join(n)}function o(a){return a==null?"":a instanceof Date?ai(a):t.test(a+="")?'"'+a.replace(/"/g,'""')+'"':a}return{parse:e,parseRows:i,format:u,formatBody:s,formatRows:p,formatRow:h,formatValue:o}}var ui=li(","),si=ui.parse,fi=gn('<header class="bg-black border-b text-xs"><div class="mx-auto p-1"><div class="text-white"> </div></div></header>');function ci(n,t){const r=j(t,"title",3,"fanzinet"),e=j(t,"subtitle",3,"analogikal knot map"),i=j(t,"version",3,"0.?");var l=fi(),u=H(l),s=H(u),p=H(s);Y(s),Y(u),Y(l),vn(()=>yn(p,`${r()??""}
      ${e()??""} v.${i()??""}`)),on(n,l)}var vi=gn('<footer class="bg-black border-t text-xs text-white/70 px-2 py-1"><div class="flex flex-wrap items-center justify-between gap-1"><a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a> · <a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a></div></footer>');function di(n,t){const r=j(t,"author",3,"Paolo Palmacci"),e=j(t,"authorUrl",3,"https://www.paolopalmacci.it/"),i=j(t,"developer",3,"Giacomo Nanni"),l=j(t,"developerUrl",3,"https://giacomo.website/");var u=vi(),s=H(u),p=H(s),h=H(p,!0);Y(p);var o=J(p,2),a=H(o,!0);Y(o),Y(s),Y(u),vn(()=>{K(p,"href",e()),yn(h,r()),K(o,"href",l()),yn(a,i())}),on(n,u)}class zn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const r=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const l=r[i],u=t+l,s=Math.abs(t)<Math.abs(l)?t-(u-l):l-(u-t);s&&(r[e++]=s),t=u}return r[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let r=this._n,e,i,l,u=0;if(r>0){for(u=t[--r];r>0&&(e=u,i=t[--r],u=e+i,l=i-(u-e),!l););r>0&&(l<0&&t[r-1]<0||l>0&&t[r-1]>0)&&(i=l*2,e=u+i,i==e-u&&(u=e))}return u}}function*pi(n){for(const t of n)yield*t}function $e(n){return Array.from(pi(n))}var X=1e-6,U=Math.PI,nn=U/2,ye=U/4,hn=U*2,_n=180/U,rn=U/180,G=Math.abs,le=Math.atan,qn=Math.atan2,B=Math.cos,hi=Math.exp,Xt=Math.log,Lt=Math.pow,W=Math.sin,Gn=Math.sign||function(n){return n>0?1:n<0?-1:0},An=Math.sqrt,Ve=Math.tan;function gi(n){return n>1?0:n<-1?U:Math.acos(n)}function nt(n){return n>1?nn:n<-1?-nn:Math.asin(n)}function pn(){}function ct(n,t){n&&me.hasOwnProperty(n.type)&&me[n.type](n,t)}var Se={Feature:function(n,t){ct(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)ct(r[e].geometry,t)}},me={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){$t(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)$t(r[e],t,0)},Polygon:function(n,t){we(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)we(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)ct(r[e],t)}};function $t(n,t,r){var e=-1,i=n.length-r,l;for(t.lineStart();++e<i;)l=n[e],t.point(l[0],l[1],l[2]);t.lineEnd()}function we(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)$t(n[r],t,1);t.polygonEnd()}function Yn(n,t){n&&Se.hasOwnProperty(n.type)?Se[n.type](n,t):ct(n,t)}function Vt(n){return[qn(n[1],n[0]),nt(n[2])]}function On(n){var t=n[0],r=n[1],e=B(r);return[e*B(t),e*W(t),W(r)]}function ot(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function vt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Dt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function at(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Zt(n){var t=An(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Bt(n,t){function r(e,i){return e=n(e,i),t(e[0],e[1])}return n.invert&&t.invert&&(r.invert=function(e,i){return e=t.invert(e,i),e&&n.invert(e[0],e[1])}),r}function Gt(n,t){return G(n)>U&&(n-=Math.round(n/hn)*hn),[n,t]}Gt.invert=Gt;function _i(n,t,r){return(n%=hn)?t||r?Bt(xe(n),Ce(t,r)):xe(n):t||r?Ce(t,r):Gt}function Ee(n){return function(t,r){return t+=n,G(t)>U&&(t-=Math.round(t/hn)*hn),[t,r]}}function xe(n){var t=Ee(n);return t.invert=Ee(-n),t}function Ce(n,t){var r=B(n),e=W(n),i=B(t),l=W(t);function u(s,p){var h=B(p),o=B(s)*h,a=W(s)*h,c=W(p),v=c*r+o*e;return[qn(a*i-v*l,o*r-c*e),nt(v*i+a*l)]}return u.invert=function(s,p){var h=B(p),o=B(s)*h,a=W(s)*h,c=W(p),v=c*i-a*l;return[qn(a*i+c*l,o*r+v*e),nt(v*r-o*e)]},u}function yi(n,t,r,e,i,l){if(r){var u=B(t),s=W(t),p=e*r;i==null?(i=t+e*hn,l=t-p/2):(i=Me(u,i),l=Me(u,l),(e>0?i<l:i>l)&&(i+=e*hn));for(var h,o=i;e>0?o>l:o<l;o-=p)h=Vt([u,-s*B(o),-s*W(o)]),n.point(h[0],h[1])}}function Me(n,t){t=On(t),t[0]-=n,Zt(t);var r=gi(-t[1]);return((-t[2]<0?-r:r)+hn-X)%hn}function Ze(){var n=[],t;return{point:function(r,e,i){t.push([r,e,i])},lineStart:function(){n.push(t=[])},lineEnd:pn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var r=n;return n=[],t=null,r}}}function ft(n,t){return G(n[0]-t[0])<X&&G(n[1]-t[1])<X}function lt(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function Be(n,t,r,e,i){var l=[],u=[],s,p;if(n.forEach(function(g){if(!((E=g.length-1)<=0)){var E,d=g[0],S=g[E],b;if(ft(d,S)){if(!d[2]&&!S[2]){for(i.lineStart(),s=0;s<E;++s)i.point((d=g[s])[0],d[1]);i.lineEnd();return}S[0]+=2*X}l.push(b=new lt(d,g,null,!0)),u.push(b.o=new lt(d,null,b,!1)),l.push(b=new lt(S,g,null,!1)),u.push(b.o=new lt(S,null,b,!0))}}),!!l.length){for(u.sort(t),Pe(l),Pe(u),s=0,p=u.length;s<p;++s)u[s].e=r=!r;for(var h=l[0],o,a;;){for(var c=h,v=!0;c.v;)if((c=c.n)===h)return;o=c.z,i.lineStart();do{if(c.v=c.o.v=!0,c.e){if(v)for(s=0,p=o.length;s<p;++s)i.point((a=o[s])[0],a[1]);else e(c.x,c.n.x,1,i);c=c.n}else{if(v)for(o=c.p.z,s=o.length-1;s>=0;--s)i.point((a=o[s])[0],a[1]);else e(c.x,c.p.x,-1,i);c=c.p}c=c.o,o=c.z,v=!v}while(!c.v);i.lineEnd()}}}function Pe(n){if(t=n.length){for(var t,r=0,e=n[0],i;++r<t;)e.n=i=n[r],i.p=e,e=i;e.n=i=n[0],i.p=e}}function Ut(n){return G(n[0])<=U?n[0]:Gn(n[0])*((G(n[0])+U)%hn-U)}function Si(n,t){var r=Ut(t),e=t[1],i=W(e),l=[W(r),-B(r),0],u=0,s=0,p=new zn;i===1?e=nn+X:i===-1&&(e=-nn-X);for(var h=0,o=n.length;h<o;++h)if(c=(a=n[h]).length)for(var a,c,v=a[c-1],g=Ut(v),E=v[1]/2+ye,d=W(E),S=B(E),b=0;b<c;++b,g=m,d=M,S=I,v=T){var T=a[b],m=Ut(T),x=T[1]/2+ye,M=W(x),I=B(x),k=m-g,z=k>=0?1:-1,y=z*k,C=y>U,Z=d*M;if(p.add(qn(Z*z*W(y),S*I+Z*B(y))),u+=C?k+z*hn:k,C^g>=r^m>=r){var F=vt(On(v),On(T));Zt(F);var A=vt(l,F);Zt(A);var _=(C^k>=0?-1:1)*nt(A[2]);(e>_||e===_&&(F[0]||F[1]))&&(s+=C^k>=0?1:-1)}}return(u<-X||u<X&&p<-1e-12)^s&1}function Ge(n,t,r,e){return function(i){var l=t(i),u=Ze(),s=t(u),p=!1,h,o,a,c={point:v,lineStart:E,lineEnd:d,polygonStart:function(){c.point=S,c.lineStart=b,c.lineEnd=T,o=[],h=[]},polygonEnd:function(){c.point=v,c.lineStart=E,c.lineEnd=d,o=$e(o);var m=Si(h,e);o.length?(p||(i.polygonStart(),p=!0),Be(o,wi,m,r,i)):m&&(p||(i.polygonStart(),p=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),o=h=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function v(m,x){n(m,x)&&i.point(m,x)}function g(m,x){l.point(m,x)}function E(){c.point=g,l.lineStart()}function d(){c.point=v,l.lineEnd()}function S(m,x){a.push([m,x]),s.point(m,x)}function b(){s.lineStart(),a=[]}function T(){S(a[0][0],a[0][1]),s.lineEnd();var m=s.clean(),x=u.result(),M,I=x.length,k,z,y;if(a.pop(),h.push(a),a=null,!!I){if(m&1){if(z=x[0],(k=z.length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),M=0;M<k;++M)i.point((y=z[M])[0],y[1]);i.lineEnd()}return}I>1&&m&2&&x.push(x.pop().concat(x.shift())),o.push(x.filter(mi))}}return c}}function mi(n){return n.length>1}function wi(n,t){return((n=n.x)[0]<0?n[1]-nn-X:nn-n[1])-((t=t.x)[0]<0?t[1]-nn-X:nn-t[1])}const be=Ge(function(){return!0},Ei,Ci,[-U,-nn]);function Ei(n){var t=NaN,r=NaN,e=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(l,u){var s=l>0?U:-U,p=G(l-t);G(p-U)<X?(n.point(t,r=(r+u)/2>0?nn:-nn),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),n.point(l,r),i=0):e!==s&&p>=U&&(G(t-e)<X&&(t-=e*X),G(l-s)<X&&(l-=s*X),r=xi(t,r,l,u),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),i=0),n.point(t=l,r=u),e=s},lineEnd:function(){n.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function xi(n,t,r,e){var i,l,u=W(n-r);return G(u)>X?le((W(t)*(l=B(e))*W(r)-W(e)*(i=B(t))*W(n))/(i*l*u)):(t+e)/2}function Ci(n,t,r,e){var i;if(n==null)i=r*nn,e.point(-U,i),e.point(0,i),e.point(U,i),e.point(U,0),e.point(U,-i),e.point(0,-i),e.point(-U,-i),e.point(-U,0),e.point(-U,i);else if(G(n[0]-t[0])>X){var l=n[0]<t[0]?U:-U;i=r*l/2,e.point(-l,i),e.point(0,i),e.point(l,i)}else e.point(t[0],t[1])}function Mi(n){var t=B(n),r=2*rn,e=t>0,i=G(t)>X;function l(o,a,c,v){yi(v,n,r,c,o,a)}function u(o,a){return B(o)*B(a)>t}function s(o){var a,c,v,g,E;return{lineStart:function(){g=v=!1,E=1},point:function(d,S){var b=[d,S],T,m=u(d,S),x=e?m?0:h(d,S):m?h(d+(d<0?U:-U),S):0;if(!a&&(g=v=m)&&o.lineStart(),m!==v&&(T=p(a,b),(!T||ft(a,T)||ft(b,T))&&(b[2]=1)),m!==v)E=0,m?(o.lineStart(),T=p(b,a),o.point(T[0],T[1])):(T=p(a,b),o.point(T[0],T[1],2),o.lineEnd()),a=T;else if(i&&a&&e^m){var M;!(x&c)&&(M=p(b,a,!0))&&(E=0,e?(o.lineStart(),o.point(M[0][0],M[0][1]),o.point(M[1][0],M[1][1]),o.lineEnd()):(o.point(M[1][0],M[1][1]),o.lineEnd(),o.lineStart(),o.point(M[0][0],M[0][1],3)))}m&&(!a||!ft(a,b))&&o.point(b[0],b[1]),a=b,v=m,c=x},lineEnd:function(){v&&o.lineEnd(),a=null},clean:function(){return E|(g&&v)<<1}}}function p(o,a,c){var v=On(o),g=On(a),E=[1,0,0],d=vt(v,g),S=ot(d,d),b=d[0],T=S-b*b;if(!T)return!c&&o;var m=t*S/T,x=-t*b/T,M=vt(E,d),I=at(E,m),k=at(d,x);Dt(I,k);var z=M,y=ot(I,z),C=ot(z,z),Z=y*y-C*(ot(I,I)-1);if(!(Z<0)){var F=An(Z),A=at(z,(-y-F)/C);if(Dt(A,I),A=Vt(A),!c)return A;var _=o[0],N=a[0],q=o[1],$=a[1],tn;N<_&&(tn=_,_=N,N=tn);var en=N-_,an=G(en-U)<X,Sn=an||en<X;if(!an&&$<q&&(tn=q,q=$,$=tn),Sn?an?q+$>0^A[1]<(G(A[0]-_)<X?q:$):q<=A[1]&&A[1]<=$:en>U^(_<=A[0]&&A[0]<=N)){var fn=at(z,(-y+F)/C);return Dt(fn,I),[A,Vt(fn)]}}}function h(o,a){var c=e?n:U-n,v=0;return o<-c?v|=1:o>c&&(v|=2),a<-c?v|=4:a>c&&(v|=8),v}return Ge(u,s,l,e?[0,-n]:[-U,n-U])}function Pi(n,t,r,e,i,l){var u=n[0],s=n[1],p=t[0],h=t[1],o=0,a=1,c=p-u,v=h-s,g;if(g=r-u,!(!c&&g>0)){if(g/=c,c<0){if(g<o)return;g<a&&(a=g)}else if(c>0){if(g>a)return;g>o&&(o=g)}if(g=i-u,!(!c&&g<0)){if(g/=c,c<0){if(g>a)return;g>o&&(o=g)}else if(c>0){if(g<o)return;g<a&&(a=g)}if(g=e-s,!(!v&&g>0)){if(g/=v,v<0){if(g<o)return;g<a&&(a=g)}else if(v>0){if(g>a)return;g>o&&(o=g)}if(g=l-s,!(!v&&g<0)){if(g/=v,v<0){if(g>a)return;g>o&&(o=g)}else if(v>0){if(g<o)return;g<a&&(a=g)}return o>0&&(n[0]=u+o*c,n[1]=s+o*v),a<1&&(t[0]=u+a*c,t[1]=s+a*v),!0}}}}}var Wn=1e9,ut=-Wn;function bi(n,t,r,e){function i(h,o){return n<=h&&h<=r&&t<=o&&o<=e}function l(h,o,a,c){var v=0,g=0;if(h==null||(v=u(h,a))!==(g=u(o,a))||p(h,o)<0^a>0)do c.point(v===0||v===3?n:r,v>1?e:t);while((v=(v+a+4)%4)!==g);else c.point(o[0],o[1])}function u(h,o){return G(h[0]-n)<X?o>0?0:3:G(h[0]-r)<X?o>0?2:1:G(h[1]-t)<X?o>0?1:0:o>0?3:2}function s(h,o){return p(h.x,o.x)}function p(h,o){var a=u(h,1),c=u(o,1);return a!==c?a-c:a===0?o[1]-h[1]:a===1?h[0]-o[0]:a===2?h[1]-o[1]:o[0]-h[0]}return function(h){var o=h,a=Ze(),c,v,g,E,d,S,b,T,m,x,M,I={point:k,lineStart:Z,lineEnd:F,polygonStart:y,polygonEnd:C};function k(_,N){i(_,N)&&o.point(_,N)}function z(){for(var _=0,N=0,q=v.length;N<q;++N)for(var $=v[N],tn=1,en=$.length,an=$[0],Sn,fn,kn=an[0],Pn=an[1];tn<en;++tn)Sn=kn,fn=Pn,an=$[tn],kn=an[0],Pn=an[1],fn<=e?Pn>e&&(kn-Sn)*(e-fn)>(Pn-fn)*(n-Sn)&&++_:Pn<=e&&(kn-Sn)*(e-fn)<(Pn-fn)*(n-Sn)&&--_;return _}function y(){o=a,c=[],v=[],M=!0}function C(){var _=z(),N=M&&_,q=(c=$e(c)).length;(N||q)&&(h.polygonStart(),N&&(h.lineStart(),l(null,null,1,h),h.lineEnd()),q&&Be(c,s,_,l,h),h.polygonEnd()),o=h,c=v=g=null}function Z(){I.point=A,v&&v.push(g=[]),x=!0,m=!1,b=T=NaN}function F(){c&&(A(E,d),S&&m&&a.rejoin(),c.push(a.result())),I.point=k,m&&o.lineEnd()}function A(_,N){var q=i(_,N);if(v&&g.push([_,N]),x)E=_,d=N,S=q,x=!1,q&&(o.lineStart(),o.point(_,N));else if(q&&m)o.point(_,N);else{var $=[b=Math.max(ut,Math.min(Wn,b)),T=Math.max(ut,Math.min(Wn,T))],tn=[_=Math.max(ut,Math.min(Wn,_)),N=Math.max(ut,Math.min(Wn,N))];Pi($,tn,n,t,r,e)?(m||(o.lineStart(),o.point($[0],$[1])),o.point(tn[0],tn[1]),q||o.lineEnd(),M=!1):q&&(o.lineStart(),o.point(_,N),M=!1)}b=_,T=N,m=q}return I}}const Wt=n=>n;var Yt=new zn,jt=new zn,We,je,Qt,Kt,Cn={point:pn,lineStart:pn,lineEnd:pn,polygonStart:function(){Cn.lineStart=Ti,Cn.lineEnd=Ii},polygonEnd:function(){Cn.lineStart=Cn.lineEnd=Cn.point=pn,Yt.add(G(jt)),jt=new zn},result:function(){var n=Yt/2;return Yt=new zn,n}};function Ti(){Cn.point=Ri}function Ri(n,t){Cn.point=Qe,We=Qt=n,je=Kt=t}function Qe(n,t){jt.add(Kt*n-Qt*t),Qt=n,Kt=t}function Ii(){Qe(We,je)}var Xn=1/0,dt=Xn,tt=-Xn,pt=tt,ht={point:Ai,lineStart:pn,lineEnd:pn,polygonStart:pn,polygonEnd:pn,result:function(){var n=[[Xn,dt],[tt,pt]];return tt=pt=-(dt=Xn=1/0),n}};function Ai(n,t){n<Xn&&(Xn=n),n>tt&&(tt=n),t<dt&&(dt=t),t>pt&&(pt=t)}var Jt=0,ne=0,jn=0,gt=0,_t=0,Hn=0,te=0,ee=0,Qn=0,Ke,Je,mn,wn,dn={point:Fn,lineStart:Te,lineEnd:Re,polygonStart:function(){dn.lineStart=zi,dn.lineEnd=Fi},polygonEnd:function(){dn.point=Fn,dn.lineStart=Te,dn.lineEnd=Re},result:function(){var n=Qn?[te/Qn,ee/Qn]:Hn?[gt/Hn,_t/Hn]:jn?[Jt/jn,ne/jn]:[NaN,NaN];return Jt=ne=jn=gt=_t=Hn=te=ee=Qn=0,n}};function Fn(n,t){Jt+=n,ne+=t,++jn}function Te(){dn.point=ki}function ki(n,t){dn.point=Ni,Fn(mn=n,wn=t)}function Ni(n,t){var r=n-mn,e=t-wn,i=An(r*r+e*e);gt+=i*(mn+n)/2,_t+=i*(wn+t)/2,Hn+=i,Fn(mn=n,wn=t)}function Re(){dn.point=Fn}function zi(){dn.point=Li}function Fi(){nr(Ke,Je)}function Li(n,t){dn.point=nr,Fn(Ke=mn=n,Je=wn=t)}function nr(n,t){var r=n-mn,e=t-wn,i=An(r*r+e*e);gt+=i*(mn+n)/2,_t+=i*(wn+t)/2,Hn+=i,i=wn*n-mn*t,te+=i*(mn+n),ee+=i*(wn+t),Qn+=i*3,Fn(mn=n,wn=t)}function tr(n){this._context=n}tr.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,hn);break}}},result:pn};var re=new zn,Ht,er,rr,Kn,Jn,et={point:pn,lineStart:function(){et.point=Di},lineEnd:function(){Ht&&ir(er,rr),et.point=pn},polygonStart:function(){Ht=!0},polygonEnd:function(){Ht=null},result:function(){var n=+re;return re=new zn,n}};function Di(n,t){et.point=ir,er=Kn=n,rr=Jn=t}function ir(n,t){Kn-=n,Jn-=t,re.add(An(Kn*Kn+Jn*Jn)),Kn=n,Jn=t}let Ie,yt,Ae,ke;class Ne{constructor(t){this._append=t==null?or:Ui(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Ae||this._append!==yt){const e=this._radius,i=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,Ae=e,yt=this._append,ke=this._,this._=i}this._+=ke;break}}}result(){const t=this._;return this._="",t.length?t:null}}function or(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Ui(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return or;if(t!==Ie){const r=10**t;Ie=t,yt=function(i){let l=1;this._+=i[0];for(const u=i.length;l<u;++l)this._+=Math.round(arguments[l]*r)/r+i[l]}}return yt}function ze(n,t){let r=3,e=4.5,i,l;function u(s){return s&&(typeof e=="function"&&l.pointRadius(+e.apply(this,arguments)),Yn(s,i(l))),l.result()}return u.area=function(s){return Yn(s,i(Cn)),Cn.result()},u.measure=function(s){return Yn(s,i(et)),et.result()},u.bounds=function(s){return Yn(s,i(ht)),ht.result()},u.centroid=function(s){return Yn(s,i(dn)),dn.result()},u.projection=function(s){return arguments.length?(i=s==null?(n=null,Wt):(n=s).stream,u):n},u.context=function(s){return arguments.length?(l=s==null?(t=null,new Ne(r)):new tr(t=s),typeof e!="function"&&l.pointRadius(e),u):t},u.pointRadius=function(s){return arguments.length?(e=typeof s=="function"?s:(l.pointRadius(+s),+s),u):e},u.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{const p=Math.floor(s);if(!(p>=0))throw new RangeError(`invalid digits: ${s}`);r=p}return t===null&&(l=new Ne(r)),u},u.projection(n).digits(r).context(t)}function ue(n){return function(t){var r=new ie;for(var e in n)r[e]=n[e];return r.stream=t,r}}function ie(){}ie.prototype={constructor:ie,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function se(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Yn(r,n.stream(ht)),t(ht.result()),e!=null&&n.clipExtent(e),n}function ar(n,t,r){return se(n,function(e){var i=t[1][0]-t[0][0],l=t[1][1]-t[0][1],u=Math.min(i/(e[1][0]-e[0][0]),l/(e[1][1]-e[0][1])),s=+t[0][0]+(i-u*(e[1][0]+e[0][0]))/2,p=+t[0][1]+(l-u*(e[1][1]+e[0][1]))/2;n.scale(150*u).translate([s,p])},r)}function Yi(n,t,r){return ar(n,[[0,0],t],r)}function Hi(n,t,r){return se(n,function(e){var i=+t,l=i/(e[1][0]-e[0][0]),u=(i-l*(e[1][0]+e[0][0]))/2,s=-l*e[0][1];n.scale(150*l).translate([u,s])},r)}function qi(n,t,r){return se(n,function(e){var i=+t,l=i/(e[1][1]-e[0][1]),u=-l*e[0][0],s=(i-l*(e[1][1]+e[0][1]))/2;n.scale(150*l).translate([u,s])},r)}var Fe=16,Oi=B(30*rn);function Le(n,t){return+t?$i(n,t):Xi(n)}function Xi(n){return ue({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function $i(n,t){function r(e,i,l,u,s,p,h,o,a,c,v,g,E,d){var S=h-e,b=o-i,T=S*S+b*b;if(T>4*t&&E--){var m=u+c,x=s+v,M=p+g,I=An(m*m+x*x+M*M),k=nt(M/=I),z=G(G(M)-1)<X||G(l-a)<X?(l+a)/2:qn(x,m),y=n(z,k),C=y[0],Z=y[1],F=C-e,A=Z-i,_=b*F-S*A;(_*_/T>t||G((S*F+b*A)/T-.5)>.3||u*c+s*v+p*g<Oi)&&(r(e,i,l,u,s,p,C,Z,z,m/=I,x/=I,M,E,d),d.point(C,Z),r(C,Z,z,m,x,M,h,o,a,c,v,g,E,d))}}return function(e){var i,l,u,s,p,h,o,a,c,v,g,E,d={point:S,lineStart:b,lineEnd:m,polygonStart:function(){e.polygonStart(),d.lineStart=x},polygonEnd:function(){e.polygonEnd(),d.lineStart=b}};function S(k,z){k=n(k,z),e.point(k[0],k[1])}function b(){a=NaN,d.point=T,e.lineStart()}function T(k,z){var y=On([k,z]),C=n(k,z);r(a,c,o,v,g,E,a=C[0],c=C[1],o=k,v=y[0],g=y[1],E=y[2],Fe,e),e.point(a,c)}function m(){d.point=S,e.lineEnd()}function x(){b(),d.point=M,d.lineEnd=I}function M(k,z){T(i=k,z),l=a,u=c,s=v,p=g,h=E,d.point=T}function I(){r(a,c,o,v,g,E,l,u,i,s,p,h,Fe,e),d.lineEnd=m,m()}return d}}var Vi=ue({point:function(n,t){this.stream.point(n*rn,t*rn)}});function Zi(n){return ue({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}function Bi(n,t,r,e,i){function l(u,s){return u*=e,s*=i,[t+n*u,r-n*s]}return l.invert=function(u,s){return[(u-t)/n*e,(r-s)/n*i]},l}function De(n,t,r,e,i,l){if(!l)return Bi(n,t,r,e,i);var u=B(l),s=W(l),p=u*n,h=s*n,o=u/n,a=s/n,c=(s*r-u*t)/n,v=(s*t+u*r)/n;function g(E,d){return E*=e,d*=i,[p*E-h*d+t,r-h*E-p*d]}return g.invert=function(E,d){return[e*(o*E-a*d+c),i*(v-a*E-o*d)]},g}function Gi(n){var t,r=150,e=480,i=250,l=0,u=0,s=0,p=0,h=0,o,a=0,c=1,v=1,g=null,E=be,d=null,S,b,T,m=Wt,x=.5,M,I,k,z,y;function C(_){return k(_[0]*rn,_[1]*rn)}function Z(_){return _=k.invert(_[0],_[1]),_&&[_[0]*_n,_[1]*_n]}C.stream=function(_){return z&&y===_?z:z=Vi(Zi(o)(E(M(m(y=_)))))},C.preclip=function(_){return arguments.length?(E=_,g=void 0,A()):E},C.postclip=function(_){return arguments.length?(m=_,d=S=b=T=null,A()):m},C.clipAngle=function(_){return arguments.length?(E=+_?Mi(g=_*rn):(g=null,be),A()):g*_n},C.clipExtent=function(_){return arguments.length?(m=_==null?(d=S=b=T=null,Wt):bi(d=+_[0][0],S=+_[0][1],b=+_[1][0],T=+_[1][1]),A()):d==null?null:[[d,S],[b,T]]},C.scale=function(_){return arguments.length?(r=+_,F()):r},C.translate=function(_){return arguments.length?(e=+_[0],i=+_[1],F()):[e,i]},C.center=function(_){return arguments.length?(l=_[0]%360*rn,u=_[1]%360*rn,F()):[l*_n,u*_n]},C.rotate=function(_){return arguments.length?(s=_[0]%360*rn,p=_[1]%360*rn,h=_.length>2?_[2]%360*rn:0,F()):[s*_n,p*_n,h*_n]},C.angle=function(_){return arguments.length?(a=_%360*rn,F()):a*_n},C.reflectX=function(_){return arguments.length?(c=_?-1:1,F()):c<0},C.reflectY=function(_){return arguments.length?(v=_?-1:1,F()):v<0},C.precision=function(_){return arguments.length?(M=Le(I,x=_*_),A()):An(x)},C.fitExtent=function(_,N){return ar(C,_,N)},C.fitSize=function(_,N){return Yi(C,_,N)},C.fitWidth=function(_,N){return Hi(C,_,N)},C.fitHeight=function(_,N){return qi(C,_,N)};function F(){var _=De(r,0,0,c,v,a).apply(null,t(l,u)),N=De(r,e-_[0],i-_[1],c,v,a);return o=_i(s,p,h),I=Bt(t,N),k=Bt(o,I),M=Le(I,x),A()}function A(){return z=y=null,C}return function(){return t=n.apply(this,arguments),C.invert=t.invert&&Z,F()}}function Wi(n){var t=0,r=U/3,e=Gi(n),i=e(t,r);return i.parallels=function(l){return arguments.length?e(t=l[0]*rn,r=l[1]*rn):[t*_n,r*_n]},i}function lr(n,t){return[n,Xt(Ve((nn+t)/2))]}lr.invert=function(n,t){return[n,2*le(hi(t))-nn]};function st(n){return Ve((nn+n)/2)}function ji(n,t){var r=B(n),e=n===t?W(n):Xt(r/B(t))/Xt(st(t)/st(n)),i=r*Lt(st(n),e)/e;if(!e)return lr;function l(u,s){i>0?s<-nn+X&&(s=-nn+X):s>nn-X&&(s=nn-X);var p=i/Lt(st(s),e);return[p*W(e*u),i-p*B(e*u)]}return l.invert=function(u,s){var p=i-s,h=Gn(e)*An(u*u+p*p),o=qn(u,G(p))*Gn(p);return p*e<0&&(o-=U*Gn(u)*Gn(p)),[o/e,2*le(Lt(i/h,1/e))-nn]},l}function Qi(){return Wi(ji).scale(109.5).parallels([30,30])}var Ki=oe('<path fill="#f5f5f5" stroke="#d4d4d8" stroke-width="1.5" vector-effect="non-scaling-stroke"></path>'),Ji=oe('<line stroke="#000" stroke-opacity="0.2" stroke-width="1" vector-effect="non-scaling-stroke"></line>'),no=oe('<g class="transition-opacity duration-200"><g data-label-hit="" class="cursor-pointer" role="button" tabindex="0"><!><rect fill="black" stroke="black" stroke-width="0" vector-effect="non-scaling-stroke"></rect><text text-anchor="middle" dominant-baseline="middle" font-weight="400" fill="white" class="pointer-events-none select-none" vector-effect="non-scaling-stroke"> </text><title> </title></g></g>'),to=gn('<section class="bg-[#ccc]"><div class="absolute top-1 right-1 z-50 space-y-1 text-xs"><button class="bg-white px-2 py-1  cursor-pointer font-bold text-black border disabled:opacity-40">+</button> <br/> <button class="bg-white px-2 py-1  cursor-pointer font-bold text-black border disabled:opacity-40">−</button></div> <svg class="block h-full w-full cursor-grab touch-none select-none overflow-visible active:cursor-grabbing" preserveAspectRatio="xMidYMid meet" role="application" aria-label="Fanzine map (pan and zoom)"><g><!><!></g></svg></section>');function eo(n,t){St(t,!0);const r=j(t,"italy",3,null),e=j(t,"points",19,()=>[]);j(t,"filteredItems",19,()=>[]);const i=j(t,"query",3,""),l=j(t,"projectionZoom",3,1.25),u=j(t,"labelPlacements",3,null),s=j(t,"disablePanZoomOnMobile",3,!1),p=j(t,"disableVisibleItems",3,!0),h=j(t,"onSelect",3,null),o=1500,a=1800;let c=O(null),v=O(""),g=O(null),E=O(xn([])),d=O(xn([])),S=O(xn([]));const b=0,T=0;let m=O(1),x=O(b),M=O(T),I=O(!1),k=O(xn({x:0,y:0,translateX:0,translateY:0})),z=O(!1),y=O(!1),C=O(!1),Z=O(!1),F=O(!1),A=O(null),_=O(null),N=O(null),q=O(!1),$=xn(new Map),tn=O(!1),en=O(null);function an(w){const P=w.currentTarget?.ownerSVGElement||w.currentTarget;if(!P?.createSVGPoint)return{x:0,y:0};const L=P.createSVGPoint();L.x=w.clientX,L.y=w.clientY;const D=P.getScreenCTM?.();if(!D)return{x:0,y:0};const V=D.inverse(),Q=L.matrixTransform(V);return{x:Q.x,y:Q.y}}function Sn(w){const P=w.composedPath?.();return P?P.some(L=>L?.dataset&&"labelHit"in L.dataset):!!w.target?.closest?.("[data-label-hit]")}function fn(w,P=o/2,L=a/2){if(f(q))return;const D=1.2,V=w>0?D:1/D,Q=Math.max(.5,Math.min(8,f(m)*V));if(Q===f(m))return;const ln=P-(P-f(x))/f(m)*Q,un=L-(L-f(M))/f(m)*Q;kn(ln,un,Q)}function kn(w,P,L){if(R(N,{x:w,y:P,scale:L},!0),typeof requestAnimationFrame>"u"){R(x,f(N).x,!0),R(M,f(N).y,!0),R(m,f(N).scale,!0),R(N,null);return}f(_)||R(_,requestAnimationFrame(()=>{f(N)&&(R(x,f(N).x,!0),R(M,f(N).y,!0),R(m,f(N).scale,!0)),R(N,null),R(_,null)}),!0)}function Pn(){if(!f(c)||!e()||e().length===0){R(S,[],!0);return}const w=100;R(S,e().filter(P=>{const L=parseFloat(P.latitude),D=parseFloat(P.longitude);if(!isFinite(L)||!isFinite(D))return!1;const[V,Q]=f(c)([D,L]),ln=f(x)+V*f(m),un=f(M)+Q*f(m);return ln>-w&&ln<o+w&&un>-w&&un<a+w}),!0),t.onvisibleItemsChange?.(f(S))}function ur(w){if(f(q))return;w.preventDefault();const P=w.deltaY>0?-1:1,L=an(w);fn(P,L.x,L.y)}function sr(w){if(f(q)||w.button!=null&&w.button!==0)return;w.currentTarget.setPointerCapture?.(w.pointerId),R(Z,Sn(w),!0),R(I,!1),R(F,!0),R(A,w.pointerId,!0),R(z,!1),R(C,!1);const L=an(w);if($.set(w.pointerId,L),$.size===2){const D=Array.from($.values()),V=D[1].x-D[0].x,Q=D[1].y-D[0].y,ln=Math.hypot(V,Q)||1,un={x:(D[0].x+D[1].x)/2,y:(D[0].y+D[1].y)/2};R(tn,!0),R(en,{distance:ln,center:un,scale:f(m),translateX:f(x),translateY:f(M)},!0),R(F,!1),R(I,!1);return}R(k,{x:L.x,y:L.y,translateX:f(x),translateY:f(M)},!0)}function fr(w){if(f(q))return;if($.has(w.pointerId)&&$.set(w.pointerId,an(w)),f(tn)&&$.size>=2&&f(en)){const V=Array.from($.values()),Q=V[1].x-V[0].x,ln=V[1].y-V[0].y,Pt=(Math.hypot(Q,ln)||1)/f(en).distance,Ln=Math.max(.5,Math.min(8,f(en).scale*Pt)),rt={x:(V[0].x+V[1].x)/2,y:(V[0].y+V[1].y)/2},Tn=rt.x,Rn=rt.y,_r=Tn-(Tn-f(en).translateX)/f(en).scale*Ln,yr=Rn-(Rn-f(en).translateY)/f(en).scale*Ln;kn(_r,yr,Ln);return}if(!f(F)&&!f(I)||f(A)!=null&&w.pointerId!==f(A))return;const P=an(w),L=P.x-f(k).x,D=P.y-f(k).y;!f(z)&&Math.hypot(L,D)>2&&(R(z,!0),R(C,!0),R(y,f(Z),!0),R(I,!0),Sn(w)&&R(y,!0),w.currentTarget.setPointerCapture?.(w.pointerId)),f(z)&&(R(x,f(k).translateX+L),R(M,f(k).translateY+D))}function cr(w){f(q)||wt(w)}function vr(w){f(q)||wt(w,!0)}function wt(w,P=!1){$.has(w?.pointerId)&&$.delete(w.pointerId),$.size<2&&(R(tn,!1),R(en,null)),R(I,!1),R(F,!1),R(A,null),w?.currentTarget&&w.currentTarget.releasePointerCapture?.(w.pointerId),f(z)&&!P?(R(y,!0),setTimeout(()=>{R(y,!1),R(C,!1)},160)):(R(C,!1),R(y,!1)),R(Z,!1),R(z,!1)}function dr(w,P){if(!w||!isFinite(P)||P===1)return;const L=o/2,D=a/2,[V,Q]=w.translate();w.scale(w.scale()*P),w.translate([L+(V-L)*P,D+(Q-D)*P])}function pr(w,P){(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),h()?.(P))}Dn(()=>{if(r()){const w=Qi().parallels([37,45]);w.fitExtent([[0,0],[o,a]],r()),dr(w,l()),R(c,w,!0),R(v,ze(w)(r())||"",!0);const P=ze(w).bounds(r());R(g,P?{left:P[0][0],top:P[0][1],right:P[1][0],bottom:P[1][1]}:null,!0)}}),Dn(()=>{u()&&u().length&&R(E,u())}),Dn(()=>{const w=f(E)||[],P=i()?w.filter(D=>{const V=i().toLowerCase();return D.fanzine?.toLowerCase().includes(V)||D.city?.toLowerCase().includes(V)||D.genre?.toLowerCase().includes(V)}):w,L=120;R(d,P.filter(D=>{const V=f(x)+D.x*f(m),Q=f(M)+D.y*f(m);return V>-L&&V<o+L&&Q>-L&&Q<a+L}),!0)}),Dn(()=>{p()?R(S,[],!0):Pn()}),Dn(()=>{t.onvisibleItemsChange?.(f(S))}),Dn(()=>{if(typeof window<"u"){const w=window.matchMedia?.("(pointer: coarse)")?.matches||window.matchMedia?.("(hover: none)")?.matches;R(q,!!(s()&&w),!0)}});var Et=to(),xt=H(Et),Ct=H(xt),fe=J(Ct,4);Y(xt);var bn=J(xt,2);K(bn,"viewBox",`0 0 ${o} ${a}`);var Mt=H(bn),ce=H(Mt);{var hr=w=>{var P=Ki();vn(()=>K(P,"d",f(v))),on(w,P)};Nn(ce,w=>{f(v)&&w(hr)})}var gr=J(ce);qe(gr,17,()=>f(d),Gr,(w,P)=>{var L=no(),D=H(L),V=H(D);{var Q=Tn=>{var Rn=Ji();vn(()=>{K(Rn,"x1",f(P).x0),K(Rn,"y1",f(P).y0),K(Rn,"x2",f(P).x),K(Rn,"y2",f(P).y)}),on(Tn,Rn)};Nn(V,Tn=>{Math.hypot(f(P).x-f(P).x0,f(P).y-f(P).y0)>6&&Tn(Q)})}var ln=J(V),un=J(ln),Pt=H(un,!0);Y(un);var Ln=J(un),rt=H(Ln);Y(Ln),Y(D),Y(L),vn(()=>{K(ln,"x",f(P).x-f(P).width/2),K(ln,"y",f(P).y-f(P).height/2),K(ln,"width",f(P).width),K(ln,"height",f(P).height),K(un,"x",f(P).x),K(un,"y",f(P).y),K(un,"font-size",f(P).fontSize),yn(Pt,f(P).text),yn(rt,`${f(P).fanzine??""} (${f(P).city??""})`)}),cn("pointerup",D,ri(()=>{wt(),!f(y)&&!f(C)&&!f(q)&&h()?.(f(P))})),cn("click",D,()=>{!f(y)&&!f(C)&&!f(q)&&h()?.(f(P))}),cn("keydown",D,Tn=>pr(Tn,f(P))),on(w,L)}),Y(Mt),Y(bn),Y(Et),vn(()=>{Ct.disabled=f(q),fe.disabled=f(q),K(Mt,"transform",`translate(${f(x)} ${f(M)}) scale(${f(m)})`)}),cn("click",Ct,()=>fn(2)),cn("click",fe,()=>fn(-2)),cn("wheel",bn,ur),cn("pointerdown",bn,sr),cn("pointermove",bn,fr),cn("pointerup",bn,cr),cn("pointercancel",bn,vr),on(n,Et),mt()}var ro=gn('<button type="button" class=" border border-black px-1 py-0.5 text-xs text-black cursor-pointer user-select-none">X</button>'),io=gn('<div class="flex w-full justify-between items-end gap-3 pb-3"><div class="grid w-full max-w-[280px]"><div class="flex items-center gap-0.5"><input type="text" placeholder="Cerca..." class="flex-1 border border-black bg-white px-1 py-0.5 text-xs text-black outline-none" aria-label="Search fanzines"/> <!></div></div> <div class="text-xs leading-tight text-black/70"><strong class="text-black"> </strong> fanzine</div></div>');function oo(n,t){St(t,!0);let r=j(t,"query",15,""),e=j(t,"totalCount",3,0);j(t,"visibleCount",3,0);let i=j(t,"resultsCount",3,0),l=j(t,"hasSelection",3,!1);function u(){r(""),t.onclear?.()}var s=io(),p=H(s),h=H(p),o=H(h);Br(o);var a=J(o,2);{var c=d=>{var S=ro();cn("click",S,u),on(d,S)};Nn(a,d=>{(r()||l())&&d(c)})}Y(h),Y(p);var v=J(p,2),g=H(v),E=H(g,!0);Y(g),$r(),Y(v),Y(s),vn(()=>yn(E,r()?i():e())),ei(o,r),on(n,s),mt()}var ao=gn('<img class="h-full w-full object-fill" loading="lazy"/>'),lo=gn('<div class="mt-0.5 text-[.6rem] leading-snug text-black/60"><div> </div> <button type="button" class="mt-0.5 text-[.6rem] font-medium text-blue-600 hover:text-blue-800"> </button></div>'),uo=gn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] hover:bg-black/10" target="_blank" rel="noreferrer">PDF</a>'),so=gn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] text-black hover:bg-black/10" target="_blank" rel="noreferrer">Link</a>'),fo=gn('<div role="listitem" class=" bg-white p-0.5 text-left shadow-sm"><div class="aspect-[3/4] w-full overflow-hidden bg-black/5"><!></div> <div class="mt-0 mb-0.5 truncate font-bold leading-tight text-[.6rem]"> </div> <div class="truncate leading-tight text-[.6rem]"> </div> <div class="mt-0 line-clamp-2 leading-tight text-[.6rem]"> </div> <!> <div class="mt-0.5 gap-0.5"><!> <!></div></div>'),co=gn('<div class="min-h-screen"><div class="grid grid-cols-2 md:grid-cols-8 gap-0.5 p-0.5" role="list" aria-label="Fanzines"></div></div>');function vo(n,t){St(t,!0);const r=j(t,"items",19,()=>[]),e="https://www.paolopalmacci.it/capitmundi/";let i=O(null);function l(o){return o?/^https?:\/\//i.test(o)?o:`${e}${String(o).replace(/^\/+/,"")}`:""}function u(o){return o?.yearStart?o?.yearEnd&&o.yearEnd!==o.yearStart?`${o.yearStart}-${o.yearEnd}`:String(o.yearStart):""}function s(o,a){const c=[o?.sourceFile,o?.canonicalUrl,o?.pdfHref,o?.title,o?.fanzine,o?.city,o?.yearStart,o?.yearEnd].filter(v=>v!=null&&String(v).trim()!=="").map(v=>String(v));return c.length?`${c.join("|")}|${a}`:String(a)}var p=co(),h=H(p);qe(h,23,r,(o,a)=>s(o,a),(o,a,c)=>{var v=fo(),g=H(v),E=H(g);{var d=A=>{var _=ao();vn(N=>{K(_,"src",N),K(_,"alt",f(a).fanzine||"Fanzine cover")},[()=>l(f(a).ogImage)]),on(A,_)};Nn(E,A=>{f(a).ogImage&&A(d)})}Y(g);var S=J(g,2),b=H(S,!0);Y(S);var T=J(S,2),m=H(T);Y(T);var x=J(T,2),M=H(x);Y(x);var I=J(x,2);{var k=A=>{var _=lo(),N=H(_),q=H(N,!0);Y(N);var $=J(N,2),tn=H($,!0);Y($),Y(_),vn(()=>{ti(N,1,Jr(f(i)===f(c)?"":"line-clamp-3")),yn(q,f(a).description),yn(tn,f(i)===f(c)?"Read less":"Read more")}),cn("click",$,()=>{R(i,f(i)===f(c)?null:f(c),!0)}),on(A,_)};Nn(I,A=>{f(a).description&&A(k)})}var z=J(I,2),y=H(z);{var C=A=>{var _=uo();vn(N=>K(_,"href",N),[()=>l(f(a).pdfHref)]),on(A,_)};Nn(y,A=>{f(a)?.pdfHref&&A(C)})}var Z=J(y,2);{var F=A=>{var _=so();vn(()=>K(_,"href",f(a).canonicalUrl)),on(A,_)};Nn(Z,A=>{f(a)?.canonicalUrl&&A(F)})}Y(z),Y(v),vn(A=>{yn(b,f(a).fanzine),yn(m,`${f(a).city??""}${f(a).country?`, ${f(a).country}`:""}`),yn(M,`${(f(a).genre||"—")??""}${A??""}`)},[()=>u(f(a))?` · ${u(f(a))}`:""]),on(o,v)}),Y(h),Y(p),on(n,p),mt()}var po=gn('<!> <div class="sticky top-0 z-0 max-h-[65vh] w-full"><div class="h-full w-full overflow-hidden bg-white"><!></div></div> <div class="relative mx-auto bg-white w-full px-2 py-1"><!> <!></div> <!>',1);function mo(n,t){St(t,!0);function r(y){return{sourceFile:y.source_file,canonicalUrl:y.canonical_url,title:y.title,fanzine:y.fanzine||"N/A",city:y.city||"Unknown",country:y.country,activity:y.activity,yearStart:y.year_start,yearEnd:y.year_end,genre:y.genre,description:y.description,pdfHref:y.pdf_href,ogImage:y.og_image,latitude:y.latitude,longitude:y.longitude}}let e=O(null),i=O(xn([])),l=O(xn([])),u=O(xn([])),s=O(!0),p=O(""),h=O(""),o=O(null),a=O(xn([])),c=$n(()=>f(h)?f(i).filter(y=>{const C=f(h).toLowerCase();return y.fanzine?.toLowerCase().includes(C)||y.city?.toLowerCase().includes(C)||y.genre?.toLowerCase().includes(C)}):[]),v=$n(()=>f(h)?f(l).filter(y=>{const C=f(h).toLowerCase();return y.fanzine?.toLowerCase().includes(C)||y.city?.toLowerCase().includes(C)||y.genre?.toLowerCase().includes(C)}).length:f(l).length);function g(){R(h,""),R(o,null)}function E(y){R(o,y,!0)}function d(y){R(a,y,!0)}Vr(async()=>{try{R(s,!0);const y=await fetch("/data/italy2.geojson");if(!y.ok)throw new Error("Failed to load geojson");R(e,await y.json(),!0);const C=await fetch("/fanzines.csv");if(!C.ok)throw new Error("Failed to load fanzines.csv");const Z=await C.text();R(i,si(Z).map(r),!0);try{const F=await fetch("/data/label_placements.json");if(F.ok){const A=await F.json();R(u,Array.isArray(A)?A:A.labels||[],!0)}}catch(F){console.warn("Failed to load label placements",F)}R(l,f(i).map(F=>{const A=parseFloat(F.latitude),_=parseFloat(F.longitude);return!isFinite(A)||!isFinite(_)?null:{...F,lat:A,lon:_}}).filter(Boolean),!0)}catch(y){R(p,y instanceof Error?y.message:String(y),!0)}finally{R(s,!1)}});var S=po(),b=Zr(S);ci(b,{});var T=J(b,2),m=H(T),x=H(m);{let y=$n(()=>f(o)?[f(o)]:f(h)?f(c):f(i));eo(x,{get italy(){return f(e)},get points(){return f(l)},get labelPlacements(){return f(u)},get query(){return f(h)},projectionZoom:1,get filteredItems(){return f(y)},onSelect:E,onvisibleItemsChange:d})}Y(m),Y(T);var M=J(T,2),I=H(M);{let y=$n(()=>!!f(o));oo(I,{get totalCount(){return f(i).length},get visibleCount(){return f(v)},get resultsCount(){return f(c).length},get hasSelection(){return f(y)},onclear:g,get query(){return f(h)},set query(C){R(h,C,!0)}})}var k=J(I,2);{let y=$n(()=>f(o)?[f(o)]:f(h)?f(c):f(a).length>0?f(a):f(i));vo(k,{get items(){return f(y)}})}Y(M);var z=J(M,2);di(z,{}),on(n,S),mt()}export{mo as component};

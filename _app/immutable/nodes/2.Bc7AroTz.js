import{a as en,f as vn,d as ee}from"../chunks/evFuCTkd.js";import{e as Ct,n as pr,aR as Le,h as En,w as Mt,T as hr,o as gr,A as c,t as _r,H as yr,v as se,x as Pt,i as et,ae as Sr,aI as mr,aq as ce,c as zn,aS as Cn,f as Ut,s as wr,M as Er,aT as xr,aG as re,aU as Cr,aV as Mr,aN as Pr,ad as ve,aW as br,r as De,p as Ue,aX as bt,q as Rr,aY as Tr,aZ as Ir,aF as kr,d as Nr,aC as Ar,a_ as Fr,aO as zr,k as Lr,ab as Dr,a$ as Ur,a5 as un,a7 as U,a8 as D,a9 as K,a3 as _t,aP as O,B as Rn,u as Fn,C as A,a6 as yt,ar as Hr,_ as qr,a4 as Or,aQ as $n}from"../chunks/Bp8pB4gU.js";import{s as hn,e as ln}from"../chunks/DEBbc6RU.js";import{p as W,i as In}from"../chunks/D8zbcI5x.js";import{s as Q,r as Yr}from"../chunks/DzEVTUEa.js";function $r(n,t){return t}function Vr(n,t,r){for(var e=[],i=t.length,l,u=t.length,f=0;f<i;f++){let a=t[f];Ue(a,()=>{if(l){if(l.pending.delete(a),l.done.add(a),l.pending.size===0){var s=n.outrogroups;Ht(re(l.done)),s.delete(l),s.size===0&&(n.outrogroups=null)}}else u-=1},!1)}if(u===0){var p=e.length===0&&r!==null;if(p){var h=r,o=h.parentNode;kr(o),o.append(h),n.items.clear()}Ht(t,!p)}else l={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(l)}function Ht(n,t=!0){for(var r=0;r<n.length;r++)Nr(n[r],t)}var de;function He(n,t,r,e,i,l=null){var u=n,f=new Map,p=(t&Le)!==0;if(p){var h=n;u=En?Mt(hr(h)):h.appendChild(Ct())}En&&gr();var o=null,a=Er(()=>{var S=r();return xr(S)?S:S==null?[]:re(S)}),s,v=!0;function g(){d.fallback=o,Xr(d,s,u,t,e),o!==null&&(s.length===0?(o.f&Cn)===0?De(o):(o.f^=Cn,Zn(o,null,u)):Ue(o,()=>{o=null}))}var w=pr(()=>{s=c(a);var S=s.length;let P=!1;if(En){var b=_r(u)===yr;b!==(S===0)&&(u=se(),Mt(u),Pt(!1),P=!0)}for(var m=new Set,M=zn,R=wr(),T=0;T<S;T+=1){En&&et.nodeType===Sr&&et.data===mr&&(u=et,P=!0,Pt(!1));var k=s[T],F=e(k,T),y=v?null:f.get(F);y?(y.v&&ce(y.v,k),y.i&&ce(y.i,T),R&&M.skipped_effects.delete(y.e)):(y=Zr(f,v?u:de??=Ct(),k,F,T,i,t,r),v||(y.e.f|=Cn),f.set(F,y)),m.add(F)}if(S===0&&l&&!o&&(v?o=Ut(()=>l(u)):(o=Ut(()=>l(de??=Ct())),o.f|=Cn)),En&&S>0&&Mt(se()),!v)if(R){for(const[C,V]of f)m.has(C)||M.skipped_effects.add(V.e);M.oncommit(g),M.ondiscard(()=>{})}else g();P&&Pt(!0),c(a)}),d={effect:w,items:f,outrogroups:null,fallback:o};v=!1,En&&(u=et)}function Vn(n){for(;n!==null&&(n.f&Tr)===0;)n=n.next;return n}function Xr(n,t,r,e,i){var l=(e&Ir)!==0,u=t.length,f=n.items,p=Vn(n.effect.first),h,o=null,a,s=[],v=[],g,w,d,S;if(l)for(S=0;S<u;S+=1)g=t[S],w=i(g,S),d=f.get(w).e,(d.f&Cn)===0&&(d.nodes?.a?.measure(),(a??=new Set).add(d));for(S=0;S<u;S+=1){if(g=t[S],w=i(g,S),d=f.get(w).e,n.outrogroups!==null)for(const y of n.outrogroups)y.pending.delete(d),y.done.delete(d);if((d.f&Cn)!==0)if(d.f^=Cn,d===p)Zn(d,null,r);else{var P=o?o.next:p;d===n.effect.last&&(n.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),bn(n,o,d),bn(n,d,P),Zn(d,P,r),o=d,s=[],v=[],p=Vn(o.next);continue}if((d.f&bt)!==0&&(De(d),l&&(d.nodes?.a?.unfix(),(a??=new Set).delete(d))),d!==p){if(h!==void 0&&h.has(d)){if(s.length<v.length){var b=v[0],m;o=b.prev;var M=s[0],R=s[s.length-1];for(m=0;m<s.length;m+=1)Zn(s[m],b,r);for(m=0;m<v.length;m+=1)h.delete(v[m]);bn(n,M.prev,R.next),bn(n,o,M),bn(n,R,b),p=b,o=R,S-=1,s=[],v=[]}else h.delete(d),Zn(d,p,r),bn(n,d.prev,d.next),bn(n,d,o===null?n.effect.first:o.next),bn(n,o,d),o=d;continue}for(s=[],v=[];p!==null&&p!==d;)(h??=new Set).add(p),v.push(p),p=Vn(p.next);if(p===null)continue}(d.f&Cn)===0&&s.push(d),o=d,p=Vn(d.next)}if(n.outrogroups!==null){for(const y of n.outrogroups)y.pending.size===0&&(Ht(re(y.done)),n.outrogroups?.delete(y));n.outrogroups.size===0&&(n.outrogroups=null)}if(p!==null||h!==void 0){var T=[];if(h!==void 0)for(d of h)(d.f&bt)===0&&T.push(d);for(;p!==null;)(p.f&bt)===0&&p!==n.fallback&&T.push(p),p=Vn(p.next);var k=T.length;if(k>0){var F=(e&Le)!==0&&u===0?r:null;if(l){for(S=0;S<k;S+=1)T[S].nodes?.a?.measure();for(S=0;S<k;S+=1)T[S].nodes?.a?.fix()}Vr(n,T,F)}}l&&Rr(()=>{if(a!==void 0)for(d of a)d.nodes?.a?.apply()})}function Zr(n,t,r,e,i,l,u,f){var p=(u&Cr)!==0?(u&Mr)===0?Pr(r,!1,!1):ve(r):null,h=(u&br)!==0?ve(i):null;return{v:p,i:h,e:Ut(()=>(l(t,p??r,h??i,f),()=>{n.delete(e)}))}}function Zn(n,t,r){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end,l=t&&(t.f&Cn)===0?t.nodes.start:r;e!==null;){var u=Ar(e);if(l.before(e),e===i)return;e=u}}function bn(n,t,r){t===null?n.effect.first=r:t.next=r,r===null?n.effect.last=t:r.prev=t}function qe(n){var t,r,e="";if(typeof n=="string"||typeof n=="number")e+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=qe(n[t]))&&(e&&(e+=" "),e+=r)}else for(r in n)n[r]&&(e&&(e+=" "),e+=r);return e}function Br(){for(var n,t,r=0,e="",i=arguments.length;r<i;r++)(n=arguments[r])&&(t=qe(n))&&(e&&(e+=" "),e+=t);return e}function Gr(n){return typeof n=="object"?Br(n):n??""}function Wr(n,t,r){var e=n==null?"":""+n;return e===""?null:e}function jr(n,t,r,e,i,l){var u=n.__className;if(En||u!==r||u===void 0){var f=Wr(r);(!En||f!==n.getAttribute("class"))&&(f==null?n.removeAttribute("class"):n.className=f),n.__className=r}return l}function Qr(n,t,r=t){var e=new WeakSet;Fr(n,"input",async i=>{var l=i?n.defaultValue:n.value;if(l=Rt(n)?Tt(l):l,r(l),zn!==null&&e.add(zn),await zr(),l!==(l=t())){var u=n.selectionStart,f=n.selectionEnd,p=n.value.length;if(n.value=l??"",f!==null){var h=n.value.length;u===f&&f===p&&h>p?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=u,n.selectionEnd=Math.min(f,h))}}}),(En&&n.defaultValue!==n.value||Lr(t)==null&&n.value)&&(r(Rt(n)?Tt(n.value):n.value),zn!==null&&e.add(zn)),Dr(()=>{var i=t();if(n===document.activeElement){var l=Ur??zn;if(e.has(l))return}Rt(n)&&i===Tt(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function Rt(n){var t=n.type;return t==="number"||t==="range"}function Tt(n){return n===""?null:+n}function Kr(n){return function(...t){var r=t[0];return r.stopPropagation(),n?.apply(this,t)}}var pe={},It={},kt=34,Xn=10,Nt=13;function Oe(n){return new Function("d","return {"+n.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function Jr(n,t){var r=Oe(n);return function(e,i){return t(r(e),i,n)}}function he(n){var t=Object.create(null),r=[];return n.forEach(function(e){for(var i in e)i in t||r.push(t[i]=i)}),r}function rn(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function ni(n){return n<0?"-"+rn(-n,6):n>9999?"+"+rn(n,6):rn(n,4)}function ti(n){var t=n.getUTCHours(),r=n.getUTCMinutes(),e=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":ni(n.getUTCFullYear())+"-"+rn(n.getUTCMonth()+1,2)+"-"+rn(n.getUTCDate(),2)+(i?"T"+rn(t,2)+":"+rn(r,2)+":"+rn(e,2)+"."+rn(i,3)+"Z":e?"T"+rn(t,2)+":"+rn(r,2)+":"+rn(e,2)+"Z":r||t?"T"+rn(t,2)+":"+rn(r,2)+"Z":"")}function ei(n){var t=new RegExp('["'+n+`
\r]`),r=n.charCodeAt(0);function e(a,s){var v,g,w=i(a,function(d,S){if(v)return v(d,S-1);g=d,v=s?Jr(d,s):Oe(d)});return w.columns=g||[],w}function i(a,s){var v=[],g=a.length,w=0,d=0,S,P=g<=0,b=!1;a.charCodeAt(g-1)===Xn&&--g,a.charCodeAt(g-1)===Nt&&--g;function m(){if(P)return It;if(b)return b=!1,pe;var R,T=w,k;if(a.charCodeAt(T)===kt){for(;w++<g&&a.charCodeAt(w)!==kt||a.charCodeAt(++w)===kt;);return(R=w)>=g?P=!0:(k=a.charCodeAt(w++))===Xn?b=!0:k===Nt&&(b=!0,a.charCodeAt(w)===Xn&&++w),a.slice(T+1,R-1).replace(/""/g,'"')}for(;w<g;){if((k=a.charCodeAt(R=w++))===Xn)b=!0;else if(k===Nt)b=!0,a.charCodeAt(w)===Xn&&++w;else if(k!==r)continue;return a.slice(T,R)}return P=!0,a.slice(T,g)}for(;(S=m())!==It;){for(var M=[];S!==pe&&S!==It;)M.push(S),S=m();s&&(M=s(M,d++))==null||v.push(M)}return v}function l(a,s){return a.map(function(v){return s.map(function(g){return o(v[g])}).join(n)})}function u(a,s){return s==null&&(s=he(a)),[s.map(o).join(n)].concat(l(a,s)).join(`
`)}function f(a,s){return s==null&&(s=he(a)),l(a,s).join(`
`)}function p(a){return a.map(h).join(`
`)}function h(a){return a.map(o).join(n)}function o(a){return a==null?"":a instanceof Date?ti(a):t.test(a+="")?'"'+a.replace(/"/g,'""')+'"':a}return{parse:e,parseRows:i,format:u,formatBody:f,formatRows:p,formatRow:h,formatValue:o}}var ri=ei(","),ii=ri.parse,oi=vn('<header class="bg-black border-b text-xs"><div class="mx-auto p-1"><div class="text-white"> </div></div></header>');function ai(n,t){const r=W(t,"title",3,"fanzinet"),e=W(t,"subtitle",3,"analogikal knot map"),i=W(t,"version",3,"0.?");var l=oi(),u=U(l),f=U(u),p=U(f);D(f),D(u),D(l),un(()=>hn(p,`${r()??""}
      ${e()??""} v.${i()??""}`)),en(n,l)}var li=vn('<footer class="bg-black border-t text-xs text-white/70 px-2 py-1"><div class="flex flex-wrap items-center justify-between gap-1"><a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a> · <a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a></div></footer>');function ui(n,t){const r=W(t,"author",3,"Paolo Palmacci"),e=W(t,"authorUrl",3,"https://www.paolopalmacci.it/"),i=W(t,"developer",3,"Giacomo Nanni"),l=W(t,"developerUrl",3,"https://giacomo.website/");var u=li(),f=U(u),p=U(f),h=U(p,!0);D(p);var o=K(p,2),a=U(o,!0);D(o),D(f),D(u),un(()=>{Q(p,"href",e()),hn(h,r()),Q(o,"href",l()),hn(a,i())}),en(n,u)}class kn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const r=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const l=r[i],u=t+l,f=Math.abs(t)<Math.abs(l)?t-(u-l):l-(u-t);f&&(r[e++]=f),t=u}return r[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let r=this._n,e,i,l,u=0;if(r>0){for(u=t[--r];r>0&&(e=u,i=t[--r],u=e+i,l=i-(u-e),!l););r>0&&(l<0&&t[r-1]<0||l>0&&t[r-1]>0)&&(i=l*2,e=u+i,i==e-u&&(u=e))}return u}}function*fi(n){for(const t of n)yield*t}function Ye(n){return Array.from(fi(n))}var Y=1e-6,L=Math.PI,J=L/2,ge=L/4,cn=L*2,pn=180/L,tn=L/180,Z=Math.abs,ie=Math.atan,Un=Math.atan2,X=Math.cos,si=Math.exp,qt=Math.log,At=Math.pow,B=Math.sin,Bn=Math.sign||function(n){return n>0?1:n<0?-1:0},Tn=Math.sqrt,$e=Math.tan;function ci(n){return n>1?0:n<-1?L:Math.acos(n)}function Jn(n){return n>1?J:n<-1?-J:Math.asin(n)}function sn(){}function ft(n,t){n&&ye.hasOwnProperty(n.type)&&ye[n.type](n,t)}var _e={Feature:function(n,t){ft(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)ft(r[e].geometry,t)}},ye={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Ot(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Ot(r[e],t,0)},Polygon:function(n,t){Se(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Se(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)ft(r[e],t)}};function Ot(n,t,r){var e=-1,i=n.length-r,l;for(t.lineStart();++e<i;)l=n[e],t.point(l[0],l[1],l[2]);t.lineEnd()}function Se(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)Ot(n[r],t,1);t.polygonEnd()}function Ln(n,t){n&&_e.hasOwnProperty(n.type)?_e[n.type](n,t):ft(n,t)}function Yt(n){return[Un(n[1],n[0]),Jn(n[2])]}function Hn(n){var t=n[0],r=n[1],e=X(r);return[e*X(t),e*B(t),B(r)]}function rt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function st(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Ft(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function it(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function $t(n){var t=Tn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Vt(n,t){function r(e,i){return e=n(e,i),t(e[0],e[1])}return n.invert&&t.invert&&(r.invert=function(e,i){return e=t.invert(e,i),e&&n.invert(e[0],e[1])}),r}function Xt(n,t){return Z(n)>L&&(n-=Math.round(n/cn)*cn),[n,t]}Xt.invert=Xt;function vi(n,t,r){return(n%=cn)?t||r?Vt(we(n),Ee(t,r)):we(n):t||r?Ee(t,r):Xt}function me(n){return function(t,r){return t+=n,Z(t)>L&&(t-=Math.round(t/cn)*cn),[t,r]}}function we(n){var t=me(n);return t.invert=me(-n),t}function Ee(n,t){var r=X(n),e=B(n),i=X(t),l=B(t);function u(f,p){var h=X(p),o=X(f)*h,a=B(f)*h,s=B(p),v=s*r+o*e;return[Un(a*i-v*l,o*r-s*e),Jn(v*i+a*l)]}return u.invert=function(f,p){var h=X(p),o=X(f)*h,a=B(f)*h,s=B(p),v=s*i-a*l;return[Un(a*i+s*l,o*r+v*e),Jn(v*r-o*e)]},u}function di(n,t,r,e,i,l){if(r){var u=X(t),f=B(t),p=e*r;i==null?(i=t+e*cn,l=t-p/2):(i=xe(u,i),l=xe(u,l),(e>0?i<l:i>l)&&(i+=e*cn));for(var h,o=i;e>0?o>l:o<l;o-=p)h=Yt([u,-f*X(o),-f*B(o)]),n.point(h[0],h[1])}}function xe(n,t){t=Hn(t),t[0]-=n,$t(t);var r=ci(-t[1]);return((-t[2]<0?-r:r)+cn-Y)%cn}function Ve(){var n=[],t;return{point:function(r,e,i){t.push([r,e,i])},lineStart:function(){n.push(t=[])},lineEnd:sn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var r=n;return n=[],t=null,r}}}function ut(n,t){return Z(n[0]-t[0])<Y&&Z(n[1]-t[1])<Y}function ot(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function Xe(n,t,r,e,i){var l=[],u=[],f,p;if(n.forEach(function(g){if(!((w=g.length-1)<=0)){var w,d=g[0],S=g[w],P;if(ut(d,S)){if(!d[2]&&!S[2]){for(i.lineStart(),f=0;f<w;++f)i.point((d=g[f])[0],d[1]);i.lineEnd();return}S[0]+=2*Y}l.push(P=new ot(d,g,null,!0)),u.push(P.o=new ot(d,null,P,!1)),l.push(P=new ot(S,g,null,!1)),u.push(P.o=new ot(S,null,P,!0))}}),!!l.length){for(u.sort(t),Ce(l),Ce(u),f=0,p=u.length;f<p;++f)u[f].e=r=!r;for(var h=l[0],o,a;;){for(var s=h,v=!0;s.v;)if((s=s.n)===h)return;o=s.z,i.lineStart();do{if(s.v=s.o.v=!0,s.e){if(v)for(f=0,p=o.length;f<p;++f)i.point((a=o[f])[0],a[1]);else e(s.x,s.n.x,1,i);s=s.n}else{if(v)for(o=s.p.z,f=o.length-1;f>=0;--f)i.point((a=o[f])[0],a[1]);else e(s.x,s.p.x,-1,i);s=s.p}s=s.o,o=s.z,v=!v}while(!s.v);i.lineEnd()}}}function Ce(n){if(t=n.length){for(var t,r=0,e=n[0],i;++r<t;)e.n=i=n[r],i.p=e,e=i;e.n=i=n[0],i.p=e}}function zt(n){return Z(n[0])<=L?n[0]:Bn(n[0])*((Z(n[0])+L)%cn-L)}function pi(n,t){var r=zt(t),e=t[1],i=B(e),l=[B(r),-X(r),0],u=0,f=0,p=new kn;i===1?e=J+Y:i===-1&&(e=-J-Y);for(var h=0,o=n.length;h<o;++h)if(s=(a=n[h]).length)for(var a,s,v=a[s-1],g=zt(v),w=v[1]/2+ge,d=B(w),S=X(w),P=0;P<s;++P,g=m,d=R,S=T,v=b){var b=a[P],m=zt(b),M=b[1]/2+ge,R=B(M),T=X(M),k=m-g,F=k>=0?1:-1,y=F*k,C=y>L,V=d*R;if(p.add(Un(V*F*B(y),S*T+V*X(y))),u+=C?k+F*cn:k,C^g>=r^m>=r){var z=st(Hn(v),Hn(b));$t(z);var I=st(l,z);$t(I);var _=(C^k>=0?-1:1)*Jn(I[2]);(e>_||e===_&&(z[0]||z[1]))&&(f+=C^k>=0?1:-1)}}return(u<-Y||u<Y&&p<-1e-12)^f&1}function Ze(n,t,r,e){return function(i){var l=t(i),u=Ve(),f=t(u),p=!1,h,o,a,s={point:v,lineStart:w,lineEnd:d,polygonStart:function(){s.point=S,s.lineStart=P,s.lineEnd=b,o=[],h=[]},polygonEnd:function(){s.point=v,s.lineStart=w,s.lineEnd=d,o=Ye(o);var m=pi(h,e);o.length?(p||(i.polygonStart(),p=!0),Xe(o,gi,m,r,i)):m&&(p||(i.polygonStart(),p=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),p&&(i.polygonEnd(),p=!1),o=h=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function v(m,M){n(m,M)&&i.point(m,M)}function g(m,M){l.point(m,M)}function w(){s.point=g,l.lineStart()}function d(){s.point=v,l.lineEnd()}function S(m,M){a.push([m,M]),f.point(m,M)}function P(){f.lineStart(),a=[]}function b(){S(a[0][0],a[0][1]),f.lineEnd();var m=f.clean(),M=u.result(),R,T=M.length,k,F,y;if(a.pop(),h.push(a),a=null,!!T){if(m&1){if(F=M[0],(k=F.length-1)>0){for(p||(i.polygonStart(),p=!0),i.lineStart(),R=0;R<k;++R)i.point((y=F[R])[0],y[1]);i.lineEnd()}return}T>1&&m&2&&M.push(M.pop().concat(M.shift())),o.push(M.filter(hi))}}return s}}function hi(n){return n.length>1}function gi(n,t){return((n=n.x)[0]<0?n[1]-J-Y:J-n[1])-((t=t.x)[0]<0?t[1]-J-Y:J-t[1])}const Me=Ze(function(){return!0},_i,Si,[-L,-J]);function _i(n){var t=NaN,r=NaN,e=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(l,u){var f=l>0?L:-L,p=Z(l-t);Z(p-L)<Y?(n.point(t,r=(r+u)/2>0?J:-J),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(f,r),n.point(l,r),i=0):e!==f&&p>=L&&(Z(t-e)<Y&&(t-=e*Y),Z(l-f)<Y&&(l-=f*Y),r=yi(t,r,l,u),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(f,r),i=0),n.point(t=l,r=u),e=f},lineEnd:function(){n.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function yi(n,t,r,e){var i,l,u=B(n-r);return Z(u)>Y?ie((B(t)*(l=X(e))*B(r)-B(e)*(i=X(t))*B(n))/(i*l*u)):(t+e)/2}function Si(n,t,r,e){var i;if(n==null)i=r*J,e.point(-L,i),e.point(0,i),e.point(L,i),e.point(L,0),e.point(L,-i),e.point(0,-i),e.point(-L,-i),e.point(-L,0),e.point(-L,i);else if(Z(n[0]-t[0])>Y){var l=n[0]<t[0]?L:-L;i=r*l/2,e.point(-l,i),e.point(0,i),e.point(l,i)}else e.point(t[0],t[1])}function mi(n){var t=X(n),r=2*tn,e=t>0,i=Z(t)>Y;function l(o,a,s,v){di(v,n,r,s,o,a)}function u(o,a){return X(o)*X(a)>t}function f(o){var a,s,v,g,w;return{lineStart:function(){g=v=!1,w=1},point:function(d,S){var P=[d,S],b,m=u(d,S),M=e?m?0:h(d,S):m?h(d+(d<0?L:-L),S):0;if(!a&&(g=v=m)&&o.lineStart(),m!==v&&(b=p(a,P),(!b||ut(a,b)||ut(P,b))&&(P[2]=1)),m!==v)w=0,m?(o.lineStart(),b=p(P,a),o.point(b[0],b[1])):(b=p(a,P),o.point(b[0],b[1],2),o.lineEnd()),a=b;else if(i&&a&&e^m){var R;!(M&s)&&(R=p(P,a,!0))&&(w=0,e?(o.lineStart(),o.point(R[0][0],R[0][1]),o.point(R[1][0],R[1][1]),o.lineEnd()):(o.point(R[1][0],R[1][1]),o.lineEnd(),o.lineStart(),o.point(R[0][0],R[0][1],3)))}m&&(!a||!ut(a,P))&&o.point(P[0],P[1]),a=P,v=m,s=M},lineEnd:function(){v&&o.lineEnd(),a=null},clean:function(){return w|(g&&v)<<1}}}function p(o,a,s){var v=Hn(o),g=Hn(a),w=[1,0,0],d=st(v,g),S=rt(d,d),P=d[0],b=S-P*P;if(!b)return!s&&o;var m=t*S/b,M=-t*P/b,R=st(w,d),T=it(w,m),k=it(d,M);Ft(T,k);var F=R,y=rt(T,F),C=rt(F,F),V=y*y-C*(rt(T,T)-1);if(!(V<0)){var z=Tn(V),I=it(F,(-y-z)/C);if(Ft(I,T),I=Yt(I),!s)return I;var _=o[0],N=a[0],H=o[1],G=a[1],nn;N<_&&(nn=_,_=N,N=nn);var Sn=N-_,an=Z(Sn-L)<Y,mn=an||Sn<Y;if(!an&&G<H&&(nn=H,H=G,G=nn),mn?an?H+G>0^I[1]<(Z(I[0]-_)<Y?H:G):H<=I[1]&&I[1]<=G:Sn>L^(_<=I[0]&&I[0]<=N)){var dn=it(F,(-y+z)/C);return Ft(dn,T),[I,Yt(dn)]}}}function h(o,a){var s=e?n:L-n,v=0;return o<-s?v|=1:o>s&&(v|=2),a<-s?v|=4:a>s&&(v|=8),v}return Ze(u,f,l,e?[0,-n]:[-L,n-L])}function wi(n,t,r,e,i,l){var u=n[0],f=n[1],p=t[0],h=t[1],o=0,a=1,s=p-u,v=h-f,g;if(g=r-u,!(!s&&g>0)){if(g/=s,s<0){if(g<o)return;g<a&&(a=g)}else if(s>0){if(g>a)return;g>o&&(o=g)}if(g=i-u,!(!s&&g<0)){if(g/=s,s<0){if(g>a)return;g>o&&(o=g)}else if(s>0){if(g<o)return;g<a&&(a=g)}if(g=e-f,!(!v&&g>0)){if(g/=v,v<0){if(g<o)return;g<a&&(a=g)}else if(v>0){if(g>a)return;g>o&&(o=g)}if(g=l-f,!(!v&&g<0)){if(g/=v,v<0){if(g>a)return;g>o&&(o=g)}else if(v>0){if(g<o)return;g<a&&(a=g)}return o>0&&(n[0]=u+o*s,n[1]=f+o*v),a<1&&(t[0]=u+a*s,t[1]=f+a*v),!0}}}}}var Gn=1e9,at=-Gn;function Ei(n,t,r,e){function i(h,o){return n<=h&&h<=r&&t<=o&&o<=e}function l(h,o,a,s){var v=0,g=0;if(h==null||(v=u(h,a))!==(g=u(o,a))||p(h,o)<0^a>0)do s.point(v===0||v===3?n:r,v>1?e:t);while((v=(v+a+4)%4)!==g);else s.point(o[0],o[1])}function u(h,o){return Z(h[0]-n)<Y?o>0?0:3:Z(h[0]-r)<Y?o>0?2:1:Z(h[1]-t)<Y?o>0?1:0:o>0?3:2}function f(h,o){return p(h.x,o.x)}function p(h,o){var a=u(h,1),s=u(o,1);return a!==s?a-s:a===0?o[1]-h[1]:a===1?h[0]-o[0]:a===2?h[1]-o[1]:o[0]-h[0]}return function(h){var o=h,a=Ve(),s,v,g,w,d,S,P,b,m,M,R,T={point:k,lineStart:V,lineEnd:z,polygonStart:y,polygonEnd:C};function k(_,N){i(_,N)&&o.point(_,N)}function F(){for(var _=0,N=0,H=v.length;N<H;++N)for(var G=v[N],nn=1,Sn=G.length,an=G[0],mn,dn,An=an[0],Mn=an[1];nn<Sn;++nn)mn=An,dn=Mn,an=G[nn],An=an[0],Mn=an[1],dn<=e?Mn>e&&(An-mn)*(e-dn)>(Mn-dn)*(n-mn)&&++_:Mn<=e&&(An-mn)*(e-dn)<(Mn-dn)*(n-mn)&&--_;return _}function y(){o=a,s=[],v=[],R=!0}function C(){var _=F(),N=R&&_,H=(s=Ye(s)).length;(N||H)&&(h.polygonStart(),N&&(h.lineStart(),l(null,null,1,h),h.lineEnd()),H&&Xe(s,f,_,l,h),h.polygonEnd()),o=h,s=v=g=null}function V(){T.point=I,v&&v.push(g=[]),M=!0,m=!1,P=b=NaN}function z(){s&&(I(w,d),S&&m&&a.rejoin(),s.push(a.result())),T.point=k,m&&o.lineEnd()}function I(_,N){var H=i(_,N);if(v&&g.push([_,N]),M)w=_,d=N,S=H,M=!1,H&&(o.lineStart(),o.point(_,N));else if(H&&m)o.point(_,N);else{var G=[P=Math.max(at,Math.min(Gn,P)),b=Math.max(at,Math.min(Gn,b))],nn=[_=Math.max(at,Math.min(Gn,_)),N=Math.max(at,Math.min(Gn,N))];wi(G,nn,n,t,r,e)?(m||(o.lineStart(),o.point(G[0],G[1])),o.point(nn[0],nn[1]),H||o.lineEnd(),R=!1):H&&(o.lineStart(),o.point(_,N),R=!1)}P=_,b=N,m=H}return T}}const Zt=n=>n;var Lt=new kn,Bt=new kn,Be,Ge,Gt,Wt,xn={point:sn,lineStart:sn,lineEnd:sn,polygonStart:function(){xn.lineStart=xi,xn.lineEnd=Mi},polygonEnd:function(){xn.lineStart=xn.lineEnd=xn.point=sn,Lt.add(Z(Bt)),Bt=new kn},result:function(){var n=Lt/2;return Lt=new kn,n}};function xi(){xn.point=Ci}function Ci(n,t){xn.point=We,Be=Gt=n,Ge=Wt=t}function We(n,t){Bt.add(Wt*n-Gt*t),Gt=n,Wt=t}function Mi(){We(Be,Ge)}var qn=1/0,ct=qn,nt=-qn,vt=nt,dt={point:Pi,lineStart:sn,lineEnd:sn,polygonStart:sn,polygonEnd:sn,result:function(){var n=[[qn,ct],[nt,vt]];return nt=vt=-(ct=qn=1/0),n}};function Pi(n,t){n<qn&&(qn=n),n>nt&&(nt=n),t<ct&&(ct=t),t>vt&&(vt=t)}var jt=0,Qt=0,Wn=0,pt=0,ht=0,Dn=0,Kt=0,Jt=0,jn=0,je,Qe,_n,yn,fn={point:Nn,lineStart:Pe,lineEnd:be,polygonStart:function(){fn.lineStart=Ti,fn.lineEnd=Ii},polygonEnd:function(){fn.point=Nn,fn.lineStart=Pe,fn.lineEnd=be},result:function(){var n=jn?[Kt/jn,Jt/jn]:Dn?[pt/Dn,ht/Dn]:Wn?[jt/Wn,Qt/Wn]:[NaN,NaN];return jt=Qt=Wn=pt=ht=Dn=Kt=Jt=jn=0,n}};function Nn(n,t){jt+=n,Qt+=t,++Wn}function Pe(){fn.point=bi}function bi(n,t){fn.point=Ri,Nn(_n=n,yn=t)}function Ri(n,t){var r=n-_n,e=t-yn,i=Tn(r*r+e*e);pt+=i*(_n+n)/2,ht+=i*(yn+t)/2,Dn+=i,Nn(_n=n,yn=t)}function be(){fn.point=Nn}function Ti(){fn.point=ki}function Ii(){Ke(je,Qe)}function ki(n,t){fn.point=Ke,Nn(je=_n=n,Qe=yn=t)}function Ke(n,t){var r=n-_n,e=t-yn,i=Tn(r*r+e*e);pt+=i*(_n+n)/2,ht+=i*(yn+t)/2,Dn+=i,i=yn*n-_n*t,Kt+=i*(_n+n),Jt+=i*(yn+t),jn+=i*3,Nn(_n=n,yn=t)}function Je(n){this._context=n}Je.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,cn);break}}},result:sn};var ne=new kn,Dt,nr,tr,Qn,Kn,tt={point:sn,lineStart:function(){tt.point=Ni},lineEnd:function(){Dt&&er(nr,tr),tt.point=sn},polygonStart:function(){Dt=!0},polygonEnd:function(){Dt=null},result:function(){var n=+ne;return ne=new kn,n}};function Ni(n,t){tt.point=er,nr=Qn=n,tr=Kn=t}function er(n,t){Qn-=n,Kn-=t,ne.add(Tn(Qn*Qn+Kn*Kn)),Qn=n,Kn=t}let Re,gt,Te,Ie;class ke{constructor(t){this._append=t==null?rr:Ai(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Te||this._append!==gt){const e=this._radius,i=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,Te=e,gt=this._append,Ie=this._,this._=i}this._+=Ie;break}}}result(){const t=this._;return this._="",t.length?t:null}}function rr(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Ai(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return rr;if(t!==Re){const r=10**t;Re=t,gt=function(i){let l=1;this._+=i[0];for(const u=i.length;l<u;++l)this._+=Math.round(arguments[l]*r)/r+i[l]}}return gt}function Ne(n,t){let r=3,e=4.5,i,l;function u(f){return f&&(typeof e=="function"&&l.pointRadius(+e.apply(this,arguments)),Ln(f,i(l))),l.result()}return u.area=function(f){return Ln(f,i(xn)),xn.result()},u.measure=function(f){return Ln(f,i(tt)),tt.result()},u.bounds=function(f){return Ln(f,i(dt)),dt.result()},u.centroid=function(f){return Ln(f,i(fn)),fn.result()},u.projection=function(f){return arguments.length?(i=f==null?(n=null,Zt):(n=f).stream,u):n},u.context=function(f){return arguments.length?(l=f==null?(t=null,new ke(r)):new Je(t=f),typeof e!="function"&&l.pointRadius(e),u):t},u.pointRadius=function(f){return arguments.length?(e=typeof f=="function"?f:(l.pointRadius(+f),+f),u):e},u.digits=function(f){if(!arguments.length)return r;if(f==null)r=null;else{const p=Math.floor(f);if(!(p>=0))throw new RangeError(`invalid digits: ${f}`);r=p}return t===null&&(l=new ke(r)),u},u.projection(n).digits(r).context(t)}function oe(n){return function(t){var r=new te;for(var e in n)r[e]=n[e];return r.stream=t,r}}function te(){}te.prototype={constructor:te,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ae(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Ln(r,n.stream(dt)),t(dt.result()),e!=null&&n.clipExtent(e),n}function ir(n,t,r){return ae(n,function(e){var i=t[1][0]-t[0][0],l=t[1][1]-t[0][1],u=Math.min(i/(e[1][0]-e[0][0]),l/(e[1][1]-e[0][1])),f=+t[0][0]+(i-u*(e[1][0]+e[0][0]))/2,p=+t[0][1]+(l-u*(e[1][1]+e[0][1]))/2;n.scale(150*u).translate([f,p])},r)}function Fi(n,t,r){return ir(n,[[0,0],t],r)}function zi(n,t,r){return ae(n,function(e){var i=+t,l=i/(e[1][0]-e[0][0]),u=(i-l*(e[1][0]+e[0][0]))/2,f=-l*e[0][1];n.scale(150*l).translate([u,f])},r)}function Li(n,t,r){return ae(n,function(e){var i=+t,l=i/(e[1][1]-e[0][1]),u=-l*e[0][0],f=(i-l*(e[1][1]+e[0][1]))/2;n.scale(150*l).translate([u,f])},r)}var Ae=16,Di=X(30*tn);function Fe(n,t){return+t?Hi(n,t):Ui(n)}function Ui(n){return oe({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function Hi(n,t){function r(e,i,l,u,f,p,h,o,a,s,v,g,w,d){var S=h-e,P=o-i,b=S*S+P*P;if(b>4*t&&w--){var m=u+s,M=f+v,R=p+g,T=Tn(m*m+M*M+R*R),k=Jn(R/=T),F=Z(Z(R)-1)<Y||Z(l-a)<Y?(l+a)/2:Un(M,m),y=n(F,k),C=y[0],V=y[1],z=C-e,I=V-i,_=P*z-S*I;(_*_/b>t||Z((S*z+P*I)/b-.5)>.3||u*s+f*v+p*g<Di)&&(r(e,i,l,u,f,p,C,V,F,m/=T,M/=T,R,w,d),d.point(C,V),r(C,V,F,m,M,R,h,o,a,s,v,g,w,d))}}return function(e){var i,l,u,f,p,h,o,a,s,v,g,w,d={point:S,lineStart:P,lineEnd:m,polygonStart:function(){e.polygonStart(),d.lineStart=M},polygonEnd:function(){e.polygonEnd(),d.lineStart=P}};function S(k,F){k=n(k,F),e.point(k[0],k[1])}function P(){a=NaN,d.point=b,e.lineStart()}function b(k,F){var y=Hn([k,F]),C=n(k,F);r(a,s,o,v,g,w,a=C[0],s=C[1],o=k,v=y[0],g=y[1],w=y[2],Ae,e),e.point(a,s)}function m(){d.point=S,e.lineEnd()}function M(){P(),d.point=R,d.lineEnd=T}function R(k,F){b(i=k,F),l=a,u=s,f=v,p=g,h=w,d.point=b}function T(){r(a,s,o,v,g,w,l,u,i,f,p,h,Ae,e),d.lineEnd=m,m()}return d}}var qi=oe({point:function(n,t){this.stream.point(n*tn,t*tn)}});function Oi(n){return oe({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}function Yi(n,t,r,e,i){function l(u,f){return u*=e,f*=i,[t+n*u,r-n*f]}return l.invert=function(u,f){return[(u-t)/n*e,(r-f)/n*i]},l}function ze(n,t,r,e,i,l){if(!l)return Yi(n,t,r,e,i);var u=X(l),f=B(l),p=u*n,h=f*n,o=u/n,a=f/n,s=(f*r-u*t)/n,v=(f*t+u*r)/n;function g(w,d){return w*=e,d*=i,[p*w-h*d+t,r-h*w-p*d]}return g.invert=function(w,d){return[e*(o*w-a*d+s),i*(v-a*w-o*d)]},g}function $i(n){var t,r=150,e=480,i=250,l=0,u=0,f=0,p=0,h=0,o,a=0,s=1,v=1,g=null,w=Me,d=null,S,P,b,m=Zt,M=.5,R,T,k,F,y;function C(_){return k(_[0]*tn,_[1]*tn)}function V(_){return _=k.invert(_[0],_[1]),_&&[_[0]*pn,_[1]*pn]}C.stream=function(_){return F&&y===_?F:F=qi(Oi(o)(w(R(m(y=_)))))},C.preclip=function(_){return arguments.length?(w=_,g=void 0,I()):w},C.postclip=function(_){return arguments.length?(m=_,d=S=P=b=null,I()):m},C.clipAngle=function(_){return arguments.length?(w=+_?mi(g=_*tn):(g=null,Me),I()):g*pn},C.clipExtent=function(_){return arguments.length?(m=_==null?(d=S=P=b=null,Zt):Ei(d=+_[0][0],S=+_[0][1],P=+_[1][0],b=+_[1][1]),I()):d==null?null:[[d,S],[P,b]]},C.scale=function(_){return arguments.length?(r=+_,z()):r},C.translate=function(_){return arguments.length?(e=+_[0],i=+_[1],z()):[e,i]},C.center=function(_){return arguments.length?(l=_[0]%360*tn,u=_[1]%360*tn,z()):[l*pn,u*pn]},C.rotate=function(_){return arguments.length?(f=_[0]%360*tn,p=_[1]%360*tn,h=_.length>2?_[2]%360*tn:0,z()):[f*pn,p*pn,h*pn]},C.angle=function(_){return arguments.length?(a=_%360*tn,z()):a*pn},C.reflectX=function(_){return arguments.length?(s=_?-1:1,z()):s<0},C.reflectY=function(_){return arguments.length?(v=_?-1:1,z()):v<0},C.precision=function(_){return arguments.length?(R=Fe(T,M=_*_),I()):Tn(M)},C.fitExtent=function(_,N){return ir(C,_,N)},C.fitSize=function(_,N){return Fi(C,_,N)},C.fitWidth=function(_,N){return zi(C,_,N)},C.fitHeight=function(_,N){return Li(C,_,N)};function z(){var _=ze(r,0,0,s,v,a).apply(null,t(l,u)),N=ze(r,e-_[0],i-_[1],s,v,a);return o=vi(f,p,h),T=Vt(t,N),k=Vt(o,T),R=Fe(T,M),I()}function I(){return F=y=null,C}return function(){return t=n.apply(this,arguments),C.invert=t.invert&&V,z()}}function Vi(n){var t=0,r=L/3,e=$i(n),i=e(t,r);return i.parallels=function(l){return arguments.length?e(t=l[0]*tn,r=l[1]*tn):[t*pn,r*pn]},i}function or(n,t){return[n,qt($e((J+t)/2))]}or.invert=function(n,t){return[n,2*ie(si(t))-J]};function lt(n){return $e((J+n)/2)}function Xi(n,t){var r=X(n),e=n===t?B(n):qt(r/X(t))/qt(lt(t)/lt(n)),i=r*At(lt(n),e)/e;if(!e)return or;function l(u,f){i>0?f<-J+Y&&(f=-J+Y):f>J-Y&&(f=J-Y);var p=i/At(lt(f),e);return[p*B(e*u),i-p*X(e*u)]}return l.invert=function(u,f){var p=i-f,h=Bn(e)*Tn(u*u+p*p),o=Un(u,Z(p))*Bn(p);return p*e<0&&(o-=L*Bn(u)*Bn(p)),[o/e,2*ie(At(i/h,1/e))-J]},l}function Zi(){return Vi(Xi).scale(109.5).parallels([30,30])}var Bi=ee('<path fill="#f5f5f5" stroke="#d4d4d8" stroke-width="1.5" vector-effect="non-scaling-stroke"></path>'),Gi=ee('<line stroke="#000" stroke-opacity="0.2" stroke-width="1" vector-effect="non-scaling-stroke"></line>'),Wi=ee('<g class="transition-opacity duration-200"><g data-label-hit="" class="cursor-pointer" role="button" tabindex="0"><!><rect fill="black" stroke="black" stroke-width="0" vector-effect="non-scaling-stroke"></rect><text text-anchor="middle" dominant-baseline="middle" font-weight="400" fill="white" class="pointer-events-none select-none" vector-effect="non-scaling-stroke"> </text><title> </title></g></g>'),ji=vn('<section class="bg-[#ccc]"><div class="absolute top-1 right-1 z-50 space-y-1 text-xs"><button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">+</button> <br/> <button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">−</button></div> <svg class="block h-full w-full cursor-grab touch-none select-none overflow-visible active:cursor-grabbing" preserveAspectRatio="xMidYMid meet" role="application" aria-label="Fanzine map (pan and zoom)"><g><!><!></g></svg></section>');function Qi(n,t){_t(t,!0);const r=W(t,"italy",3,null),e=W(t,"points",19,()=>[]);W(t,"filteredItems",19,()=>[]);const i=W(t,"query",3,""),l=W(t,"projectionZoom",3,1.25),u=W(t,"labelPlacements",3,null),f=W(t,"disablePanZoomOnMobile",3,!0),p=W(t,"disableVisibleItems",3,!0),h=W(t,"onSelect",3,null),o=1500,a=1800;let s=O(null),v=O(""),g=O(null),w=O(Rn([])),d=O(Rn([])),S=O(Rn([]));const P=0,b=0;let m=O(1),M=O(P),R=O(b),T=O(!1),k=O(Rn({x:0,y:0,translateX:0,translateY:0})),F=O(!1),y=O(!1),C=O(!1),V=O(!1),z=O(!1),I=O(null),_=O(null),N=O(null),H=O(!1);function G(E){const x=E.currentTarget?.ownerSVGElement||E.currentTarget;if(!x?.createSVGPoint)return{x:0,y:0};const q=x.createSVGPoint();q.x=E.clientX,q.y=E.clientY;const $=x.getScreenCTM?.();if(!$)return{x:0,y:0};const j=$.inverse(),on=q.matrixTransform(j);return{x:on.x,y:on.y}}function nn(E){const x=E.composedPath?.();return x?x.some(q=>q?.dataset&&"labelHit"in q.dataset):!!E.target?.closest?.("[data-label-hit]")}function Sn(E,x=o/2,q=a/2){if(c(H))return;const $=E>0?1.02:1/1.02,j=Math.max(.5,Math.min(8,c(m)*$));if(j===c(m))return;const on=x-(x-c(M))/c(m)*j,gn=q-(q-c(R))/c(m)*j;an(on,gn,j)}function an(E,x,q){if(A(N,{x:E,y:x,scale:q},!0),typeof requestAnimationFrame>"u"){A(M,c(N).x,!0),A(R,c(N).y,!0),A(m,c(N).scale,!0),A(N,null);return}c(_)||A(_,requestAnimationFrame(()=>{c(N)&&(A(M,c(N).x,!0),A(R,c(N).y,!0),A(m,c(N).scale,!0)),A(N,null),A(_,null)}),!0)}function mn(){if(!c(s)||!e()||e().length===0){A(S,[],!0);return}const E=100;A(S,e().filter(x=>{const q=parseFloat(x.latitude),$=parseFloat(x.longitude);if(!isFinite(q)||!isFinite($))return!1;const[j,on]=c(s)([$,q]),gn=c(M)+j*c(m),wn=c(R)+on*c(m);return gn>-E&&gn<o+E&&wn>-E&&wn<a+E}),!0),t.onvisibleItemsChange?.(c(S))}function dn(E){if(c(H))return;E.preventDefault();const x=E.deltaY>0?-1:1,q=G(E);Sn(x,q.x,q.y)}function An(E){if(c(H)||E.button!=null&&E.button!==0)return;A(V,nn(E),!0),A(T,!1),A(z,!0),A(I,E.pointerId,!0),A(F,!1),A(C,!1);const x=G(E);A(k,{x:x.x,y:x.y,translateX:c(M),translateY:c(R)},!0)}function Mn(E){if(c(H)||!c(z)&&!c(T)||c(I)!=null&&E.pointerId!==c(I))return;const x=G(E),q=x.x-c(k).x,$=x.y-c(k).y;!c(F)&&Math.hypot(q,$)>3&&(A(F,!0),A(C,!0),A(y,c(V),!0),A(T,!0),nn(E)&&A(y,!0),E.currentTarget.setPointerCapture?.(E.pointerId)),c(F)&&an(c(k).translateX+q,c(k).translateY+$,c(m))}function ar(E){c(H)||St(E)}function lr(E){c(H)||St(E,!0)}function St(E,x=!1){A(T,!1),A(z,!1),A(I,null),E?.currentTarget&&E.currentTarget.releasePointerCapture?.(E.pointerId),c(F)&&!x?(A(y,!0),setTimeout(()=>{A(y,!1),A(C,!1)},160)):(A(C,!1),A(y,!1)),A(V,!1),A(F,!1)}function ur(E,x){if(!E||!isFinite(x)||x===1)return;const q=o/2,$=a/2,[j,on]=E.translate();E.scale(E.scale()*x),E.translate([q+(j-q)*x,$+(on-$)*x])}function fr(E,x){(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),h()?.(x))}Fn(()=>{if(r()){const E=Zi().parallels([37,45]);E.fitExtent([[0,0],[o,a]],r()),ur(E,l()),A(s,E,!0),A(v,Ne(E)(r())||"",!0);const x=Ne(E).bounds(r());A(g,x?{left:x[0][0],top:x[0][1],right:x[1][0],bottom:x[1][1]}:null,!0)}}),Fn(()=>{u()&&u().length&&A(w,u())}),Fn(()=>{const E=c(w)||[],x=i()?E.filter($=>{const j=i().toLowerCase();return $.fanzine?.toLowerCase().includes(j)||$.city?.toLowerCase().includes(j)||$.genre?.toLowerCase().includes(j)}):E,q=120;A(d,x.filter($=>{const j=c(M)+$.x*c(m),on=c(R)+$.y*c(m);return j>-q&&j<o+q&&on>-q&&on<a+q}),!0)}),Fn(()=>{p()?A(S,[],!0):mn()}),Fn(()=>{t.onvisibleItemsChange?.(c(S))}),Fn(()=>{if(typeof window<"u"){const E=window.matchMedia?.("(pointer: coarse)")?.matches||window.matchMedia?.("(hover: none)")?.matches;A(H,!!(f()&&E),!0)}});var mt=ji(),wt=U(mt),Et=U(wt),le=K(Et,4);D(wt);var Pn=K(wt,2);Q(Pn,"viewBox",`0 0 ${o} ${a}`);var xt=U(Pn),ue=U(xt);{var sr=E=>{var x=Bi();un(()=>Q(x,"d",c(v))),en(E,x)};In(ue,E=>{c(v)&&E(sr)})}var cr=K(ue);He(cr,17,()=>c(d),$r,(E,x)=>{var q=Wi(),$=U(q),j=U($);{var on=On=>{var Yn=Gi();un(()=>{Q(Yn,"x1",c(x).x0),Q(Yn,"y1",c(x).y0),Q(Yn,"x2",c(x).x),Q(Yn,"y2",c(x).y)}),en(On,Yn)};In(j,On=>{Math.hypot(c(x).x-c(x).x0,c(x).y-c(x).y0)>6&&On(on)})}var gn=K(j),wn=K(gn),vr=U(wn,!0);D(wn);var fe=K(wn),dr=U(fe);D(fe),D($),D(q),un(()=>{Q(gn,"x",c(x).x-c(x).width/2),Q(gn,"y",c(x).y-c(x).height/2),Q(gn,"width",c(x).width),Q(gn,"height",c(x).height),Q(wn,"x",c(x).x),Q(wn,"y",c(x).y),Q(wn,"font-size",c(x).fontSize),hn(vr,c(x).text),hn(dr,`${c(x).fanzine??""} (${c(x).city??""})`)}),ln("pointerup",$,Kr(()=>{St(),!c(y)&&!c(C)&&!c(H)&&h()?.(c(x))})),ln("click",$,()=>{!c(y)&&!c(C)&&!c(H)&&h()?.(c(x))}),ln("keydown",$,On=>fr(On,c(x))),en(E,q)}),D(xt),D(Pn),D(mt),un(()=>{Et.disabled=c(H),le.disabled=c(H),Q(xt,"transform",`translate(${c(M)} ${c(R)}) scale(${c(m)})`)}),ln("click",Et,()=>Sn(1)),ln("click",le,()=>Sn(-1)),ln("wheel",Pn,dn),ln("pointerdown",Pn,An),ln("pointermove",Pn,Mn),ln("pointerup",Pn,ar),ln("pointercancel",Pn,lr),en(n,mt),yt()}var Ki=vn('<button type="button" class=" border border-black px-1 py-0.5 text-xs text-black cursor-pointer user-select-none">X</button>'),Ji=vn('<div class="flex w-full justify-between items-end gap-3 pb-3"><div class="grid w-full max-w-[280px]"><div class="flex items-center gap-0.5"><input type="text" placeholder="Cerca..." class="flex-1 border border-black bg-white px-1 py-0.5 text-xs text-black outline-none" aria-label="Search fanzines"/> <!></div></div> <div class="text-xs leading-tight text-black/70"><strong class="text-black"> </strong> fanzine</div></div>');function no(n,t){_t(t,!0);let r=W(t,"query",15,""),e=W(t,"totalCount",3,0);W(t,"visibleCount",3,0);let i=W(t,"resultsCount",3,0),l=W(t,"hasSelection",3,!1);function u(){r(""),t.onclear?.()}var f=Ji(),p=U(f),h=U(p),o=U(h);Yr(o);var a=K(o,2);{var s=d=>{var S=Ki();ln("click",S,u),en(d,S)};In(a,d=>{(r()||l())&&d(s)})}D(h),D(p);var v=K(p,2),g=U(v),w=U(g,!0);D(g),Hr(),D(v),D(f),un(()=>hn(w,r()?i():e())),Qr(o,r),en(n,f),yt()}var to=vn('<img class="h-full w-full object-fill" loading="lazy"/>'),eo=vn('<div class="mt-0.5 text-[.6rem] leading-snug text-black/60"><div> </div> <button type="button" class="mt-0.5 text-[.6rem] font-medium text-blue-600 hover:text-blue-800"> </button></div>'),ro=vn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] hover:bg-black/10" target="_blank" rel="noreferrer">PDF</a>'),io=vn('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] text-black hover:bg-black/10" target="_blank" rel="noreferrer">Link</a>'),oo=vn('<div role="listitem" class=" bg-white p-0.5 text-left shadow-sm"><div class="aspect-[3/4] w-full overflow-hidden bg-black/5"><!></div> <div class="mt-0 mb-0.5 truncate font-bold leading-tight text-[.6rem]"> </div> <div class="truncate leading-tight text-[.6rem]"> </div> <div class="mt-0 line-clamp-2 leading-tight text-[.6rem]"> </div> <!> <div class="mt-0.5 gap-0.5"><!> <!></div></div>'),ao=vn('<div class="h-screen"><div class="grid grid-cols-2 md:grid-cols-8 gap-0.5 p-0.5" role="list" aria-label="Fanzines"></div></div>');function lo(n,t){_t(t,!0);const r=W(t,"items",19,()=>[]),e="https://www.paolopalmacci.it/capitmundi/";let i=O(null);function l(o){return o?/^https?:\/\//i.test(o)?o:`${e}${String(o).replace(/^\/+/,"")}`:""}function u(o){return o?.yearStart?o?.yearEnd&&o.yearEnd!==o.yearStart?`${o.yearStart}-${o.yearEnd}`:String(o.yearStart):""}function f(o,a){const s=[o?.sourceFile,o?.canonicalUrl,o?.pdfHref,o?.title,o?.fanzine,o?.city,o?.yearStart,o?.yearEnd].filter(v=>v!=null&&String(v).trim()!=="").map(v=>String(v));return s.length?`${s.join("|")}|${a}`:String(a)}var p=ao(),h=U(p);He(h,23,r,(o,a)=>f(o,a),(o,a,s)=>{var v=oo(),g=U(v),w=U(g);{var d=I=>{var _=to();un(N=>{Q(_,"src",N),Q(_,"alt",c(a).fanzine||"Fanzine cover")},[()=>l(c(a).ogImage)]),en(I,_)};In(w,I=>{c(a).ogImage&&I(d)})}D(g);var S=K(g,2),P=U(S,!0);D(S);var b=K(S,2),m=U(b);D(b);var M=K(b,2),R=U(M);D(M);var T=K(M,2);{var k=I=>{var _=eo(),N=U(_),H=U(N,!0);D(N);var G=K(N,2),nn=U(G,!0);D(G),D(_),un(()=>{jr(N,1,Gr(c(i)===c(s)?"":"line-clamp-3")),hn(H,c(a).description),hn(nn,c(i)===c(s)?"Read less":"Read more")}),ln("click",G,()=>{A(i,c(i)===c(s)?null:c(s),!0)}),en(I,_)};In(T,I=>{c(a).description&&I(k)})}var F=K(T,2),y=U(F);{var C=I=>{var _=ro();un(N=>Q(_,"href",N),[()=>l(c(a).pdfHref)]),en(I,_)};In(y,I=>{c(a)?.pdfHref&&I(C)})}var V=K(y,2);{var z=I=>{var _=io();un(()=>Q(_,"href",c(a).canonicalUrl)),en(I,_)};In(V,I=>{c(a)?.canonicalUrl&&I(z)})}D(F),D(v),un(I=>{hn(P,c(a).fanzine),hn(m,`${c(a).city??""}${c(a).country?`, ${c(a).country}`:""}`),hn(R,`${(c(a).genre||"—")??""}${I??""}`)},[()=>u(c(a))?` · ${u(c(a))}`:""]),en(o,v)}),D(h),D(p),en(n,p),yt()}var uo=vn('<!> <div class="sticky top-0 z-0 max-h-[65vh] w-full"><div class="h-full w-full overflow-hidden bg-white"><!></div></div> <div class="relative mx-auto bg-white w-full px-2 py-1"><!> <!></div> <!>',1);function ho(n,t){_t(t,!0);function r(y){return{sourceFile:y.source_file,canonicalUrl:y.canonical_url,title:y.title,fanzine:y.fanzine||"N/A",city:y.city||"Unknown",country:y.country,activity:y.activity,yearStart:y.year_start,yearEnd:y.year_end,genre:y.genre,description:y.description,pdfHref:y.pdf_href,ogImage:y.og_image,latitude:y.latitude,longitude:y.longitude}}let e=O(null),i=O(Rn([])),l=O(Rn([])),u=O(Rn([])),f=O(!0),p=O(""),h=O(""),o=O(null),a=O(Rn([])),s=$n(()=>c(h)?c(i).filter(y=>{const C=c(h).toLowerCase();return y.fanzine?.toLowerCase().includes(C)||y.city?.toLowerCase().includes(C)||y.genre?.toLowerCase().includes(C)}):[]),v=$n(()=>c(h)?c(l).filter(y=>{const C=c(h).toLowerCase();return y.fanzine?.toLowerCase().includes(C)||y.city?.toLowerCase().includes(C)||y.genre?.toLowerCase().includes(C)}).length:c(l).length);function g(){A(h,""),A(o,null)}function w(y){A(o,y,!0)}function d(y){A(a,y,!0)}qr(async()=>{try{A(f,!0);const y=await fetch("/data/italy2.geojson");if(!y.ok)throw new Error("Failed to load geojson");A(e,await y.json(),!0);const C=await fetch("/fanzines.csv");if(!C.ok)throw new Error("Failed to load fanzines.csv");const V=await C.text();A(i,ii(V).map(r),!0);try{const z=await fetch("/data/label_placements.json");if(z.ok){const I=await z.json();A(u,Array.isArray(I)?I:I.labels||[],!0)}}catch(z){console.warn("Failed to load label placements",z)}A(l,c(i).map(z=>{const I=parseFloat(z.latitude),_=parseFloat(z.longitude);return!isFinite(I)||!isFinite(_)?null:{...z,lat:I,lon:_}}).filter(Boolean),!0)}catch(y){A(p,y instanceof Error?y.message:String(y),!0)}finally{A(f,!1)}});var S=uo(),P=Or(S);ai(P,{});var b=K(P,2),m=U(b),M=U(m);{let y=$n(()=>c(o)?[c(o)]:c(h)?c(s):c(i));Qi(M,{get italy(){return c(e)},get points(){return c(l)},get labelPlacements(){return c(u)},get query(){return c(h)},projectionZoom:1,get filteredItems(){return c(y)},onSelect:w,onvisibleItemsChange:d})}D(m),D(b);var R=K(b,2),T=U(R);{let y=$n(()=>!!c(o));no(T,{get totalCount(){return c(i).length},get visibleCount(){return c(v)},get resultsCount(){return c(s).length},get hasSelection(){return c(y)},onclear:g,get query(){return c(h)},set query(C){A(h,C,!0)}})}var k=K(T,2);{let y=$n(()=>c(o)?[c(o)]:c(h)?c(s):c(a).length>0?c(a):c(i));lo(k,{get items(){return c(y)}})}D(R);var F=K(R,2);ui(F,{}),en(n,S),yt()}export{ho as component};

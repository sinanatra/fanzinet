import{a as rn,f as un,d as oe}from"../chunks/9_CLEqmL.js";import{i as mt}from"../chunks/ClBiQ8ZL.js";import{c as De,o as wr}from"../chunks/CbAV-f2U.js";import{a as Pt,f as Sr,aS as Ue,h as xn,j as It,k as Er,Q as xr,z as a,S as Cr,T as Mr,U as pe,i as Rt,e as et,C as Pr,aK as Ir,at as de,c as Ln,aT as Mn,b as Ht,s as Rr,a3 as ut,E as Tr,aI as ae,aU as kr,aV as br,aO as K,ah as he,aW as Ar,r as Ye,p as He,aX as Tt,q as zr,aY as Nr,aZ as Fr,aH as Lr,d as $r,g as Dr,a_ as Ur,aP as Yr,w as Y,af as Hr,a$ as Or,J as cn,M as q,O as H,P as nn,G as yt,b0 as bn,b1 as Oe,K as wt,A as kn,Z as L,au as qe,I as qr,aM as Zr,b2 as Vr}from"../chunks/BqMQiygt.js";import{s as J,r as Xr,h as Br}from"../chunks/BZqVLxDD.js";import{s as _n,e as sn}from"../chunks/BoHkNz5Y.js";import{p as j,i as An}from"../chunks/wBBVvnhn.js";function Gr(n,t){return t}function Kr(n,t,r){for(var e=[],i=t.length,f,l=t.length,s=0;s<i;s++){let u=t[s];He(u,()=>{if(f){if(f.pending.delete(u),f.done.add(u),f.pending.size===0){var c=n.outrogroups;Ot(ae(f.done)),c.delete(f),c.size===0&&(n.outrogroups=null)}}else l-=1},!1)}if(l===0){var h=e.length===0&&r!==null;if(h){var g=r,o=g.parentNode;Lr(o),o.append(g),n.items.clear()}Ot(t,!h)}else f={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(f)}function Ot(n,t=!0){for(var r=0;r<n.length;r++)$r(n[r],t)}var ge;function Ze(n,t,r,e,i,f=null){var l=n,s=new Map,h=(t&Ue)!==0;if(h){var g=n;l=xn?It(Er(g)):g.appendChild(Pt())}xn&&xr();var o=null,u=ut(()=>{var w=r();return Tr(w)?w:w==null?[]:ae(w)}),c,p=!0;function v(){d.fallback=o,Wr(d,c,l,t,e),o!==null&&(c.length===0?(o.f&Mn)===0?Ye(o):(o.f^=Mn,Xn(o,null,l)):He(o,()=>{o=null}))}var S=Sr(()=>{c=a(u);var w=c.length;let C=!1;if(xn){var R=Cr(l)===Mr;R!==(w===0)&&(l=pe(),It(l),Rt(!1),C=!0)}for(var E=new Set,x=Ln,M=Rr(),T=0;T<w;T+=1){xn&&et.nodeType===Pr&&et.data===Ir&&(l=et,C=!0,Rt(!1));var k=c[T],m=e(k,T),I=p?null:s.get(m);I?(I.v&&de(I.v,k),I.i&&de(I.i,T),M&&x.skipped_effects.delete(I.e)):(I=jr(s,p?l:ge??=Pt(),k,m,T,i,t,r),p||(I.e.f|=Mn),s.set(m,I)),E.add(m)}if(w===0&&f&&!o&&(p?o=Ht(()=>f(l)):(o=Ht(()=>f(ge??=Pt())),o.f|=Mn)),xn&&w>0&&It(pe()),!p)if(M){for(const[b,$]of s)E.has(b)||x.skipped_effects.add($.e);x.oncommit(v),x.ondiscard(()=>{})}else v();C&&Rt(!0),a(u)}),d={effect:S,items:s,outrogroups:null,fallback:o};p=!1,xn&&(l=et)}function Zn(n){for(;n!==null&&(n.f&Nr)===0;)n=n.next;return n}function Wr(n,t,r,e,i){var f=(e&Fr)!==0,l=t.length,s=n.items,h=Zn(n.effect.first),g,o=null,u,c=[],p=[],v,S,d,w;if(f)for(w=0;w<l;w+=1)v=t[w],S=i(v,w),d=s.get(S).e,(d.f&Mn)===0&&(d.nodes?.a?.measure(),(u??=new Set).add(d));for(w=0;w<l;w+=1){if(v=t[w],S=i(v,w),d=s.get(S).e,n.outrogroups!==null)for(const I of n.outrogroups)I.pending.delete(d),I.done.delete(d);if((d.f&Mn)!==0)if(d.f^=Mn,d===h)Xn(d,null,r);else{var C=o?o.next:h;d===n.effect.last&&(n.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),Rn(n,o,d),Rn(n,d,C),Xn(d,C,r),o=d,c=[],p=[],h=Zn(o.next);continue}if((d.f&Tt)!==0&&(Ye(d),f&&(d.nodes?.a?.unfix(),(u??=new Set).delete(d))),d!==h){if(g!==void 0&&g.has(d)){if(c.length<p.length){var R=p[0],E;o=R.prev;var x=c[0],M=c[c.length-1];for(E=0;E<c.length;E+=1)Xn(c[E],R,r);for(E=0;E<p.length;E+=1)g.delete(p[E]);Rn(n,x.prev,M.next),Rn(n,o,x),Rn(n,M,R),h=R,o=M,w-=1,c=[],p=[]}else g.delete(d),Xn(d,h,r),Rn(n,d.prev,d.next),Rn(n,d,o===null?n.effect.first:o.next),Rn(n,o,d),o=d;continue}for(c=[],p=[];h!==null&&h!==d;)(g??=new Set).add(h),p.push(h),h=Zn(h.next);if(h===null)continue}(d.f&Mn)===0&&c.push(d),o=d,h=Zn(d.next)}if(n.outrogroups!==null){for(const I of n.outrogroups)I.pending.size===0&&(Ot(ae(I.done)),n.outrogroups?.delete(I));n.outrogroups.size===0&&(n.outrogroups=null)}if(h!==null||g!==void 0){var T=[];if(g!==void 0)for(d of g)(d.f&Tt)===0&&T.push(d);for(;h!==null;)(h.f&Tt)===0&&h!==n.fallback&&T.push(h),h=Zn(h.next);var k=T.length;if(k>0){var m=(e&Ue)!==0&&l===0?r:null;if(f){for(w=0;w<k;w+=1)T[w].nodes?.a?.measure();for(w=0;w<k;w+=1)T[w].nodes?.a?.fix()}Kr(n,T,m)}}f&&zr(()=>{if(u!==void 0)for(d of u)d.nodes?.a?.apply()})}function jr(n,t,r,e,i,f,l,s){var h=(l&kr)!==0?(l&br)===0?K(r,!1,!1):he(r):null,g=(l&Ar)!==0?he(i):null;return{v:h,i:g,e:Ht(()=>(f(t,h??r,g??i,s),()=>{n.delete(e)}))}}function Xn(n,t,r){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end,f=t&&(t.f&Mn)===0?t.nodes.start:r;e!==null;){var l=Dr(e);if(f.before(e),e===i)return;e=l}}function Rn(n,t,r){t===null?n.effect.first=r:t.next=r,r===null?n.effect.last=t:r.prev=t}function Ve(n){var t,r,e="";if(typeof n=="string"||typeof n=="number")e+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(r=Ve(n[t]))&&(e&&(e+=" "),e+=r)}else for(r in n)n[r]&&(e&&(e+=" "),e+=r);return e}function Qr(){for(var n,t,r=0,e="",i=arguments.length;r<i;r++)(n=arguments[r])&&(t=Ve(n))&&(e&&(e+=" "),e+=t);return e}function Jr(n){return typeof n=="object"?Qr(n):n??""}function ni(n,t,r){var e=n==null?"":""+n;return e===""?null:e}function ti(n,t,r,e,i,f){var l=n.__className;if(xn||l!==r||l===void 0){var s=ni(r);(!xn||s!==n.getAttribute("class"))&&(s==null?n.removeAttribute("class"):n.className=s),n.__className=r}return f}function ei(n,t,r=t){var e=new WeakSet;Ur(n,"input",async i=>{var f=i?n.defaultValue:n.value;if(f=kt(n)?bt(f):f,r(f),Ln!==null&&e.add(Ln),await Yr(),f!==(f=t())){var l=n.selectionStart,s=n.selectionEnd,h=n.value.length;if(n.value=f??"",s!==null){var g=n.value.length;l===s&&s===h&&g>h?(n.selectionStart=g,n.selectionEnd=g):(n.selectionStart=l,n.selectionEnd=Math.min(s,g))}}}),(xn&&n.defaultValue!==n.value||Y(t)==null&&n.value)&&(r(kt(n)?bt(n.value):n.value),Ln!==null&&e.add(Ln)),Hr(()=>{var i=t();if(n===document.activeElement){var f=Or??Ln;if(e.has(f))return}kt(n)&&i===bt(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function kt(n){var t=n.type;return t==="number"||t==="range"}function bt(n){return n===""?null:+n}function ri(n){return function(...t){var r=t[0];return r.stopPropagation(),n?.apply(this,t)}}var _e={},At={},zt=34,Vn=10,Nt=13;function Xe(n){return new Function("d","return {"+n.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function ii(n,t){var r=Xe(n);return function(e,i){return t(r(e),i,n)}}function me(n){var t=Object.create(null),r=[];return n.forEach(function(e){for(var i in e)i in t||r.push(t[i]=i)}),r}function an(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function oi(n){return n<0?"-"+an(-n,6):n>9999?"+"+an(n,6):an(n,4)}function ai(n){var t=n.getUTCHours(),r=n.getUTCMinutes(),e=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":oi(n.getUTCFullYear())+"-"+an(n.getUTCMonth()+1,2)+"-"+an(n.getUTCDate(),2)+(i?"T"+an(t,2)+":"+an(r,2)+":"+an(e,2)+"."+an(i,3)+"Z":e?"T"+an(t,2)+":"+an(r,2)+":"+an(e,2)+"Z":r||t?"T"+an(t,2)+":"+an(r,2)+"Z":"")}function li(n){var t=new RegExp('["'+n+`
\r]`),r=n.charCodeAt(0);function e(u,c){var p,v,S=i(u,function(d,w){if(p)return p(d,w-1);v=d,p=c?ii(d,c):Xe(d)});return S.columns=v||[],S}function i(u,c){var p=[],v=u.length,S=0,d=0,w,C=v<=0,R=!1;u.charCodeAt(v-1)===Vn&&--v,u.charCodeAt(v-1)===Nt&&--v;function E(){if(C)return At;if(R)return R=!1,_e;var M,T=S,k;if(u.charCodeAt(T)===zt){for(;S++<v&&u.charCodeAt(S)!==zt||u.charCodeAt(++S)===zt;);return(M=S)>=v?C=!0:(k=u.charCodeAt(S++))===Vn?R=!0:k===Nt&&(R=!0,u.charCodeAt(S)===Vn&&++S),u.slice(T+1,M-1).replace(/""/g,'"')}for(;S<v;){if((k=u.charCodeAt(M=S++))===Vn)R=!0;else if(k===Nt)R=!0,u.charCodeAt(S)===Vn&&++S;else if(k!==r)continue;return u.slice(T,M)}return C=!0,u.slice(T,v)}for(;(w=E())!==At;){for(var x=[];w!==_e&&w!==At;)x.push(w),w=E();c&&(x=c(x,d++))==null||p.push(x)}return p}function f(u,c){return u.map(function(p){return c.map(function(v){return o(p[v])}).join(n)})}function l(u,c){return c==null&&(c=me(u)),[c.map(o).join(n)].concat(f(u,c)).join(`
`)}function s(u,c){return c==null&&(c=me(u)),f(u,c).join(`
`)}function h(u){return u.map(g).join(`
`)}function g(u){return u.map(o).join(n)}function o(u){return u==null?"":u instanceof Date?ai(u):t.test(u+="")?'"'+u.replace(/"/g,'""')+'"':u}return{parse:e,parseRows:i,format:l,formatBody:s,formatRows:h,formatRow:g,formatValue:o}}var ui=li(","),fi=ui.parse,si=un('<header class="bg-black border-b text-xs"><div class="mx-auto p-1"><div class="text-white"> </div></div></header>');function ci(n,t){let r=j(t,"title",8,"fanzinet"),e=j(t,"subtitle",8,"analogikal knot map"),i=j(t,"version",8,"0.?");var f=si(),l=q(f),s=q(l),h=q(s);H(s),H(l),H(f),cn(()=>_n(h,`${r()??""}
      ${e()??""} v.${i()??""}`)),rn(n,f)}var vi=un('<footer class="bg-black border-t text-xs text-white/70 px-2 py-1"><div class="flex flex-wrap items-center justify-between gap-1"><a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a> · <a target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800"> </a></div></footer>');function pi(n,t){let r=j(t,"author",8,"Paolo Palmacci"),e=j(t,"authorUrl",8,"https://www.paolopalmacci.it/"),i=j(t,"developer",8,"Giacomo Nanni"),f=j(t,"developerUrl",8,"https://giacomo.website/");var l=vi(),s=q(l),h=q(s),g=q(h,!0);H(h);var o=nn(h,2),u=q(o,!0);H(o),H(s),H(l),cn(()=>{J(h,"href",e()),_n(g,r()),J(o,"href",f()),_n(u,i())}),rn(n,l)}class zn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const r=this._partials;let e=0;for(let i=0;i<this._n&&i<32;i++){const f=r[i],l=t+f,s=Math.abs(t)<Math.abs(f)?t-(l-f):f-(l-t);s&&(r[e++]=s),t=l}return r[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let r=this._n,e,i,f,l=0;if(r>0){for(l=t[--r];r>0&&(e=l,i=t[--r],l=e+i,f=i-(l-e),!f););r>0&&(f<0&&t[r-1]<0||f>0&&t[r-1]>0)&&(i=f*2,e=l+i,i==e-l&&(l=e))}return l}}function*di(n){for(const t of n)yield*t}function Be(n){return Array.from(di(n))}var Z=1e-6,U=Math.PI,tn=U/2,ye=U/4,dn=U*2,gn=180/U,on=U/180,G=Math.abs,le=Math.atan,Un=Math.atan2,B=Math.cos,hi=Math.exp,qt=Math.log,Ft=Math.pow,W=Math.sin,Bn=Math.sign||function(n){return n>0?1:n<0?-1:0},Tn=Math.sqrt,Ge=Math.tan;function gi(n){return n>1?0:n<-1?U:Math.acos(n)}function Jn(n){return n>1?tn:n<-1?-tn:Math.asin(n)}function pn(){}function st(n,t){n&&Se.hasOwnProperty(n.type)&&Se[n.type](n,t)}var we={Feature:function(n,t){st(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)st(r[e].geometry,t)}},Se={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){Zt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Zt(r[e],t,0)},Polygon:function(n,t){Ee(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Ee(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)st(r[e],t)}};function Zt(n,t,r){var e=-1,i=n.length-r,f;for(t.lineStart();++e<i;)f=n[e],t.point(f[0],f[1],f[2]);t.lineEnd()}function Ee(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)Zt(n[r],t,1);t.polygonEnd()}function $n(n,t){n&&we.hasOwnProperty(n.type)?we[n.type](n,t):st(n,t)}function Vt(n){return[Un(n[1],n[0]),Jn(n[2])]}function Yn(n){var t=n[0],r=n[1],e=B(r);return[e*B(t),e*W(t),W(r)]}function rt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function ct(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Lt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function it(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Xt(n){var t=Tn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Bt(n,t){function r(e,i){return e=n(e,i),t(e[0],e[1])}return n.invert&&t.invert&&(r.invert=function(e,i){return e=t.invert(e,i),e&&n.invert(e[0],e[1])}),r}function Gt(n,t){return G(n)>U&&(n-=Math.round(n/dn)*dn),[n,t]}Gt.invert=Gt;function _i(n,t,r){return(n%=dn)?t||r?Bt(Ce(n),Me(t,r)):Ce(n):t||r?Me(t,r):Gt}function xe(n){return function(t,r){return t+=n,G(t)>U&&(t-=Math.round(t/dn)*dn),[t,r]}}function Ce(n){var t=xe(n);return t.invert=xe(-n),t}function Me(n,t){var r=B(n),e=W(n),i=B(t),f=W(t);function l(s,h){var g=B(h),o=B(s)*g,u=W(s)*g,c=W(h),p=c*r+o*e;return[Un(u*i-p*f,o*r-c*e),Jn(p*i+u*f)]}return l.invert=function(s,h){var g=B(h),o=B(s)*g,u=W(s)*g,c=W(h),p=c*i-u*f;return[Un(u*i+c*f,o*r+p*e),Jn(p*r-o*e)]},l}function mi(n,t,r,e,i,f){if(r){var l=B(t),s=W(t),h=e*r;i==null?(i=t+e*dn,f=t-h/2):(i=Pe(l,i),f=Pe(l,f),(e>0?i<f:i>f)&&(i+=e*dn));for(var g,o=i;e>0?o>f:o<f;o-=h)g=Vt([l,-s*B(o),-s*W(o)]),n.point(g[0],g[1])}}function Pe(n,t){t=Yn(t),t[0]-=n,Xt(t);var r=gi(-t[1]);return((-t[2]<0?-r:r)+dn-Z)%dn}function Ke(){var n=[],t;return{point:function(r,e,i){t.push([r,e,i])},lineStart:function(){n.push(t=[])},lineEnd:pn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var r=n;return n=[],t=null,r}}}function ft(n,t){return G(n[0]-t[0])<Z&&G(n[1]-t[1])<Z}function ot(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function We(n,t,r,e,i){var f=[],l=[],s,h;if(n.forEach(function(v){if(!((S=v.length-1)<=0)){var S,d=v[0],w=v[S],C;if(ft(d,w)){if(!d[2]&&!w[2]){for(i.lineStart(),s=0;s<S;++s)i.point((d=v[s])[0],d[1]);i.lineEnd();return}w[0]+=2*Z}f.push(C=new ot(d,v,null,!0)),l.push(C.o=new ot(d,null,C,!1)),f.push(C=new ot(w,v,null,!1)),l.push(C.o=new ot(w,null,C,!0))}}),!!f.length){for(l.sort(t),Ie(f),Ie(l),s=0,h=l.length;s<h;++s)l[s].e=r=!r;for(var g=f[0],o,u;;){for(var c=g,p=!0;c.v;)if((c=c.n)===g)return;o=c.z,i.lineStart();do{if(c.v=c.o.v=!0,c.e){if(p)for(s=0,h=o.length;s<h;++s)i.point((u=o[s])[0],u[1]);else e(c.x,c.n.x,1,i);c=c.n}else{if(p)for(o=c.p.z,s=o.length-1;s>=0;--s)i.point((u=o[s])[0],u[1]);else e(c.x,c.p.x,-1,i);c=c.p}c=c.o,o=c.z,p=!p}while(!c.v);i.lineEnd()}}}function Ie(n){if(t=n.length){for(var t,r=0,e=n[0],i;++r<t;)e.n=i=n[r],i.p=e,e=i;e.n=i=n[0],i.p=e}}function $t(n){return G(n[0])<=U?n[0]:Bn(n[0])*((G(n[0])+U)%dn-U)}function yi(n,t){var r=$t(t),e=t[1],i=W(e),f=[W(r),-B(r),0],l=0,s=0,h=new zn;i===1?e=tn+Z:i===-1&&(e=-tn-Z);for(var g=0,o=n.length;g<o;++g)if(c=(u=n[g]).length)for(var u,c,p=u[c-1],v=$t(p),S=p[1]/2+ye,d=W(S),w=B(S),C=0;C<c;++C,v=E,d=M,w=T,p=R){var R=u[C],E=$t(R),x=R[1]/2+ye,M=W(x),T=B(x),k=E-v,m=k>=0?1:-1,I=m*k,b=I>U,$=d*M;if(h.add(Un($*m*W(I),w*T+$*B(I))),l+=b?k+m*dn:k,b^v>=r^E>=r){var D=ct(Yn(p),Yn(R));Xt(D);var F=ct(f,D);Xt(F);var _=(b^k>=0?-1:1)*Jn(F[2]);(e>_||e===_&&(D[0]||D[1]))&&(s+=b^k>=0?1:-1)}}return(l<-Z||l<Z&&h<-1e-12)^s&1}function je(n,t,r,e){return function(i){var f=t(i),l=Ke(),s=t(l),h=!1,g,o,u,c={point:p,lineStart:S,lineEnd:d,polygonStart:function(){c.point=w,c.lineStart=C,c.lineEnd=R,o=[],g=[]},polygonEnd:function(){c.point=p,c.lineStart=S,c.lineEnd=d,o=Be(o);var E=yi(g,e);o.length?(h||(i.polygonStart(),h=!0),We(o,Si,E,r,i)):E&&(h||(i.polygonStart(),h=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=g=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(E,x){n(E,x)&&i.point(E,x)}function v(E,x){f.point(E,x)}function S(){c.point=v,f.lineStart()}function d(){c.point=p,f.lineEnd()}function w(E,x){u.push([E,x]),s.point(E,x)}function C(){s.lineStart(),u=[]}function R(){w(u[0][0],u[0][1]),s.lineEnd();var E=s.clean(),x=l.result(),M,T=x.length,k,m,I;if(u.pop(),g.push(u),u=null,!!T){if(E&1){if(m=x[0],(k=m.length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),M=0;M<k;++M)i.point((I=m[M])[0],I[1]);i.lineEnd()}return}T>1&&E&2&&x.push(x.pop().concat(x.shift())),o.push(x.filter(wi))}}return c}}function wi(n){return n.length>1}function Si(n,t){return((n=n.x)[0]<0?n[1]-tn-Z:tn-n[1])-((t=t.x)[0]<0?t[1]-tn-Z:tn-t[1])}const Re=je(function(){return!0},Ei,Ci,[-U,-tn]);function Ei(n){var t=NaN,r=NaN,e=NaN,i;return{lineStart:function(){n.lineStart(),i=1},point:function(f,l){var s=f>0?U:-U,h=G(f-t);G(h-U)<Z?(n.point(t,r=(r+l)/2>0?tn:-tn),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),n.point(f,r),i=0):e!==s&&h>=U&&(G(t-e)<Z&&(t-=e*Z),G(f-s)<Z&&(f-=s*Z),r=xi(t,r,f,l),n.point(e,r),n.lineEnd(),n.lineStart(),n.point(s,r),i=0),n.point(t=f,r=l),e=s},lineEnd:function(){n.lineEnd(),t=r=NaN},clean:function(){return 2-i}}}function xi(n,t,r,e){var i,f,l=W(n-r);return G(l)>Z?le((W(t)*(f=B(e))*W(r)-W(e)*(i=B(t))*W(n))/(i*f*l)):(t+e)/2}function Ci(n,t,r,e){var i;if(n==null)i=r*tn,e.point(-U,i),e.point(0,i),e.point(U,i),e.point(U,0),e.point(U,-i),e.point(0,-i),e.point(-U,-i),e.point(-U,0),e.point(-U,i);else if(G(n[0]-t[0])>Z){var f=n[0]<t[0]?U:-U;i=r*f/2,e.point(-f,i),e.point(0,i),e.point(f,i)}else e.point(t[0],t[1])}function Mi(n){var t=B(n),r=2*on,e=t>0,i=G(t)>Z;function f(o,u,c,p){mi(p,n,r,c,o,u)}function l(o,u){return B(o)*B(u)>t}function s(o){var u,c,p,v,S;return{lineStart:function(){v=p=!1,S=1},point:function(d,w){var C=[d,w],R,E=l(d,w),x=e?E?0:g(d,w):E?g(d+(d<0?U:-U),w):0;if(!u&&(v=p=E)&&o.lineStart(),E!==p&&(R=h(u,C),(!R||ft(u,R)||ft(C,R))&&(C[2]=1)),E!==p)S=0,E?(o.lineStart(),R=h(C,u),o.point(R[0],R[1])):(R=h(u,C),o.point(R[0],R[1],2),o.lineEnd()),u=R;else if(i&&u&&e^E){var M;!(x&c)&&(M=h(C,u,!0))&&(S=0,e?(o.lineStart(),o.point(M[0][0],M[0][1]),o.point(M[1][0],M[1][1]),o.lineEnd()):(o.point(M[1][0],M[1][1]),o.lineEnd(),o.lineStart(),o.point(M[0][0],M[0][1],3)))}E&&(!u||!ft(u,C))&&o.point(C[0],C[1]),u=C,p=E,c=x},lineEnd:function(){p&&o.lineEnd(),u=null},clean:function(){return S|(v&&p)<<1}}}function h(o,u,c){var p=Yn(o),v=Yn(u),S=[1,0,0],d=ct(p,v),w=rt(d,d),C=d[0],R=w-C*C;if(!R)return!c&&o;var E=t*w/R,x=-t*C/R,M=ct(S,d),T=it(S,E),k=it(d,x);Lt(T,k);var m=M,I=rt(T,m),b=rt(m,m),$=I*I-b*(rt(T,T)-1);if(!($<0)){var D=Tn($),F=it(m,(-I-D)/b);if(Lt(F,T),F=Vt(F),!c)return F;var _=o[0],z=u[0],A=o[1],N=u[1],X;z<_&&(X=_,_=z,z=X);var mn=z-_,en=G(mn-U)<Z,fn=en||mn<Z;if(!en&&N<A&&(X=A,A=N,N=X),fn?en?A+N>0^F[1]<(G(F[0]-_)<Z?A:N):A<=F[1]&&F[1]<=N:mn>U^(_<=F[0]&&F[0]<=z)){var hn=it(m,(-I+D)/b);return Lt(hn,T),[F,Vt(hn)]}}}function g(o,u){var c=e?n:U-n,p=0;return o<-c?p|=1:o>c&&(p|=2),u<-c?p|=4:u>c&&(p|=8),p}return je(l,s,f,e?[0,-n]:[-U,n-U])}function Pi(n,t,r,e,i,f){var l=n[0],s=n[1],h=t[0],g=t[1],o=0,u=1,c=h-l,p=g-s,v;if(v=r-l,!(!c&&v>0)){if(v/=c,c<0){if(v<o)return;v<u&&(u=v)}else if(c>0){if(v>u)return;v>o&&(o=v)}if(v=i-l,!(!c&&v<0)){if(v/=c,c<0){if(v>u)return;v>o&&(o=v)}else if(c>0){if(v<o)return;v<u&&(u=v)}if(v=e-s,!(!p&&v>0)){if(v/=p,p<0){if(v<o)return;v<u&&(u=v)}else if(p>0){if(v>u)return;v>o&&(o=v)}if(v=f-s,!(!p&&v<0)){if(v/=p,p<0){if(v>u)return;v>o&&(o=v)}else if(p>0){if(v<o)return;v<u&&(u=v)}return o>0&&(n[0]=l+o*c,n[1]=s+o*p),u<1&&(t[0]=l+u*c,t[1]=s+u*p),!0}}}}}var Gn=1e9,at=-Gn;function Ii(n,t,r,e){function i(g,o){return n<=g&&g<=r&&t<=o&&o<=e}function f(g,o,u,c){var p=0,v=0;if(g==null||(p=l(g,u))!==(v=l(o,u))||h(g,o)<0^u>0)do c.point(p===0||p===3?n:r,p>1?e:t);while((p=(p+u+4)%4)!==v);else c.point(o[0],o[1])}function l(g,o){return G(g[0]-n)<Z?o>0?0:3:G(g[0]-r)<Z?o>0?2:1:G(g[1]-t)<Z?o>0?1:0:o>0?3:2}function s(g,o){return h(g.x,o.x)}function h(g,o){var u=l(g,1),c=l(o,1);return u!==c?u-c:u===0?o[1]-g[1]:u===1?g[0]-o[0]:u===2?g[1]-o[1]:o[0]-g[0]}return function(g){var o=g,u=Ke(),c,p,v,S,d,w,C,R,E,x,M,T={point:k,lineStart:$,lineEnd:D,polygonStart:I,polygonEnd:b};function k(_,z){i(_,z)&&o.point(_,z)}function m(){for(var _=0,z=0,A=p.length;z<A;++z)for(var N=p[z],X=1,mn=N.length,en=N[0],fn,hn,Fn=en[0],Pn=en[1];X<mn;++X)fn=Fn,hn=Pn,en=N[X],Fn=en[0],Pn=en[1],hn<=e?Pn>e&&(Fn-fn)*(e-hn)>(Pn-hn)*(n-fn)&&++_:Pn<=e&&(Fn-fn)*(e-hn)<(Pn-hn)*(n-fn)&&--_;return _}function I(){o=u,c=[],p=[],M=!0}function b(){var _=m(),z=M&&_,A=(c=Be(c)).length;(z||A)&&(g.polygonStart(),z&&(g.lineStart(),f(null,null,1,g),g.lineEnd()),A&&We(c,s,_,f,g),g.polygonEnd()),o=g,c=p=v=null}function $(){T.point=F,p&&p.push(v=[]),x=!0,E=!1,C=R=NaN}function D(){c&&(F(S,d),w&&E&&u.rejoin(),c.push(u.result())),T.point=k,E&&o.lineEnd()}function F(_,z){var A=i(_,z);if(p&&v.push([_,z]),x)S=_,d=z,w=A,x=!1,A&&(o.lineStart(),o.point(_,z));else if(A&&E)o.point(_,z);else{var N=[C=Math.max(at,Math.min(Gn,C)),R=Math.max(at,Math.min(Gn,R))],X=[_=Math.max(at,Math.min(Gn,_)),z=Math.max(at,Math.min(Gn,z))];Pi(N,X,n,t,r,e)?(E||(o.lineStart(),o.point(N[0],N[1])),o.point(X[0],X[1]),A||o.lineEnd(),M=!1):A&&(o.lineStart(),o.point(_,z),M=!1)}C=_,R=z,E=A}return T}}const Kt=n=>n;var Dt=new zn,Wt=new zn,Qe,Je,jt,Qt,Cn={point:pn,lineStart:pn,lineEnd:pn,polygonStart:function(){Cn.lineStart=Ri,Cn.lineEnd=ki},polygonEnd:function(){Cn.lineStart=Cn.lineEnd=Cn.point=pn,Dt.add(G(Wt)),Wt=new zn},result:function(){var n=Dt/2;return Dt=new zn,n}};function Ri(){Cn.point=Ti}function Ti(n,t){Cn.point=nr,Qe=jt=n,Je=Qt=t}function nr(n,t){Wt.add(Qt*n-jt*t),jt=n,Qt=t}function ki(){nr(Qe,Je)}var Hn=1/0,vt=Hn,nt=-Hn,pt=nt,dt={point:bi,lineStart:pn,lineEnd:pn,polygonStart:pn,polygonEnd:pn,result:function(){var n=[[Hn,vt],[nt,pt]];return nt=pt=-(vt=Hn=1/0),n}};function bi(n,t){n<Hn&&(Hn=n),n>nt&&(nt=n),t<vt&&(vt=t),t>pt&&(pt=t)}var Jt=0,ne=0,Kn=0,ht=0,gt=0,Dn=0,te=0,ee=0,Wn=0,tr,er,wn,Sn,vn={point:Nn,lineStart:Te,lineEnd:ke,polygonStart:function(){vn.lineStart=Ni,vn.lineEnd=Fi},polygonEnd:function(){vn.point=Nn,vn.lineStart=Te,vn.lineEnd=ke},result:function(){var n=Wn?[te/Wn,ee/Wn]:Dn?[ht/Dn,gt/Dn]:Kn?[Jt/Kn,ne/Kn]:[NaN,NaN];return Jt=ne=Kn=ht=gt=Dn=te=ee=Wn=0,n}};function Nn(n,t){Jt+=n,ne+=t,++Kn}function Te(){vn.point=Ai}function Ai(n,t){vn.point=zi,Nn(wn=n,Sn=t)}function zi(n,t){var r=n-wn,e=t-Sn,i=Tn(r*r+e*e);ht+=i*(wn+n)/2,gt+=i*(Sn+t)/2,Dn+=i,Nn(wn=n,Sn=t)}function ke(){vn.point=Nn}function Ni(){vn.point=Li}function Fi(){rr(tr,er)}function Li(n,t){vn.point=rr,Nn(tr=wn=n,er=Sn=t)}function rr(n,t){var r=n-wn,e=t-Sn,i=Tn(r*r+e*e);ht+=i*(wn+n)/2,gt+=i*(Sn+t)/2,Dn+=i,i=Sn*n-wn*t,te+=i*(wn+n),ee+=i*(Sn+t),Wn+=i*3,Nn(wn=n,Sn=t)}function ir(n){this._context=n}ir.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,dn);break}}},result:pn};var re=new zn,Ut,or,ar,jn,Qn,tt={point:pn,lineStart:function(){tt.point=$i},lineEnd:function(){Ut&&lr(or,ar),tt.point=pn},polygonStart:function(){Ut=!0},polygonEnd:function(){Ut=null},result:function(){var n=+re;return re=new zn,n}};function $i(n,t){tt.point=lr,or=jn=n,ar=Qn=t}function lr(n,t){jn-=n,Qn-=t,re.add(Tn(jn*jn+Qn*Qn)),jn=n,Qn=t}let be,_t,Ae,ze;class Ne{constructor(t){this._append=t==null?ur:Di(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Ae||this._append!==_t){const e=this._radius,i=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,Ae=e,_t=this._append,ze=this._,this._=i}this._+=ze;break}}}result(){const t=this._;return this._="",t.length?t:null}}function ur(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Di(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return ur;if(t!==be){const r=10**t;be=t,_t=function(i){let f=1;this._+=i[0];for(const l=i.length;f<l;++f)this._+=Math.round(arguments[f]*r)/r+i[f]}}return _t}function Yt(n,t){let r=3,e=4.5,i,f;function l(s){return s&&(typeof e=="function"&&f.pointRadius(+e.apply(this,arguments)),$n(s,i(f))),f.result()}return l.area=function(s){return $n(s,i(Cn)),Cn.result()},l.measure=function(s){return $n(s,i(tt)),tt.result()},l.bounds=function(s){return $n(s,i(dt)),dt.result()},l.centroid=function(s){return $n(s,i(vn)),vn.result()},l.projection=function(s){return arguments.length?(i=s==null?(n=null,Kt):(n=s).stream,l):n},l.context=function(s){return arguments.length?(f=s==null?(t=null,new Ne(r)):new ir(t=s),typeof e!="function"&&f.pointRadius(e),l):t},l.pointRadius=function(s){return arguments.length?(e=typeof s=="function"?s:(f.pointRadius(+s),+s),l):e},l.digits=function(s){if(!arguments.length)return r;if(s==null)r=null;else{const h=Math.floor(s);if(!(h>=0))throw new RangeError(`invalid digits: ${s}`);r=h}return t===null&&(f=new Ne(r)),l},l.projection(n).digits(r).context(t)}function ue(n){return function(t){var r=new ie;for(var e in n)r[e]=n[e];return r.stream=t,r}}function ie(){}ie.prototype={constructor:ie,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fe(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),$n(r,n.stream(dt)),t(dt.result()),e!=null&&n.clipExtent(e),n}function fr(n,t,r){return fe(n,function(e){var i=t[1][0]-t[0][0],f=t[1][1]-t[0][1],l=Math.min(i/(e[1][0]-e[0][0]),f/(e[1][1]-e[0][1])),s=+t[0][0]+(i-l*(e[1][0]+e[0][0]))/2,h=+t[0][1]+(f-l*(e[1][1]+e[0][1]))/2;n.scale(150*l).translate([s,h])},r)}function Ui(n,t,r){return fr(n,[[0,0],t],r)}function Yi(n,t,r){return fe(n,function(e){var i=+t,f=i/(e[1][0]-e[0][0]),l=(i-f*(e[1][0]+e[0][0]))/2,s=-f*e[0][1];n.scale(150*f).translate([l,s])},r)}function Hi(n,t,r){return fe(n,function(e){var i=+t,f=i/(e[1][1]-e[0][1]),l=-f*e[0][0],s=(i-f*(e[1][1]+e[0][1]))/2;n.scale(150*f).translate([l,s])},r)}var Fe=16,Oi=B(30*on);function Le(n,t){return+t?Zi(n,t):qi(n)}function qi(n){return ue({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function Zi(n,t){function r(e,i,f,l,s,h,g,o,u,c,p,v,S,d){var w=g-e,C=o-i,R=w*w+C*C;if(R>4*t&&S--){var E=l+c,x=s+p,M=h+v,T=Tn(E*E+x*x+M*M),k=Jn(M/=T),m=G(G(M)-1)<Z||G(f-u)<Z?(f+u)/2:Un(x,E),I=n(m,k),b=I[0],$=I[1],D=b-e,F=$-i,_=C*D-w*F;(_*_/R>t||G((w*D+C*F)/R-.5)>.3||l*c+s*p+h*v<Oi)&&(r(e,i,f,l,s,h,b,$,m,E/=T,x/=T,M,S,d),d.point(b,$),r(b,$,m,E,x,M,g,o,u,c,p,v,S,d))}}return function(e){var i,f,l,s,h,g,o,u,c,p,v,S,d={point:w,lineStart:C,lineEnd:E,polygonStart:function(){e.polygonStart(),d.lineStart=x},polygonEnd:function(){e.polygonEnd(),d.lineStart=C}};function w(k,m){k=n(k,m),e.point(k[0],k[1])}function C(){u=NaN,d.point=R,e.lineStart()}function R(k,m){var I=Yn([k,m]),b=n(k,m);r(u,c,o,p,v,S,u=b[0],c=b[1],o=k,p=I[0],v=I[1],S=I[2],Fe,e),e.point(u,c)}function E(){d.point=w,e.lineEnd()}function x(){C(),d.point=M,d.lineEnd=T}function M(k,m){R(i=k,m),f=u,l=c,s=p,h=v,g=S,d.point=R}function T(){r(u,c,o,p,v,S,f,l,i,s,h,g,Fe,e),d.lineEnd=E,E()}return d}}var Vi=ue({point:function(n,t){this.stream.point(n*on,t*on)}});function Xi(n){return ue({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}function Bi(n,t,r,e,i){function f(l,s){return l*=e,s*=i,[t+n*l,r-n*s]}return f.invert=function(l,s){return[(l-t)/n*e,(r-s)/n*i]},f}function $e(n,t,r,e,i,f){if(!f)return Bi(n,t,r,e,i);var l=B(f),s=W(f),h=l*n,g=s*n,o=l/n,u=s/n,c=(s*r-l*t)/n,p=(s*t+l*r)/n;function v(S,d){return S*=e,d*=i,[h*S-g*d+t,r-g*S-h*d]}return v.invert=function(S,d){return[e*(o*S-u*d+c),i*(p-u*S-o*d)]},v}function Gi(n){var t,r=150,e=480,i=250,f=0,l=0,s=0,h=0,g=0,o,u=0,c=1,p=1,v=null,S=Re,d=null,w,C,R,E=Kt,x=.5,M,T,k,m,I;function b(_){return k(_[0]*on,_[1]*on)}function $(_){return _=k.invert(_[0],_[1]),_&&[_[0]*gn,_[1]*gn]}b.stream=function(_){return m&&I===_?m:m=Vi(Xi(o)(S(M(E(I=_)))))},b.preclip=function(_){return arguments.length?(S=_,v=void 0,F()):S},b.postclip=function(_){return arguments.length?(E=_,d=w=C=R=null,F()):E},b.clipAngle=function(_){return arguments.length?(S=+_?Mi(v=_*on):(v=null,Re),F()):v*gn},b.clipExtent=function(_){return arguments.length?(E=_==null?(d=w=C=R=null,Kt):Ii(d=+_[0][0],w=+_[0][1],C=+_[1][0],R=+_[1][1]),F()):d==null?null:[[d,w],[C,R]]},b.scale=function(_){return arguments.length?(r=+_,D()):r},b.translate=function(_){return arguments.length?(e=+_[0],i=+_[1],D()):[e,i]},b.center=function(_){return arguments.length?(f=_[0]%360*on,l=_[1]%360*on,D()):[f*gn,l*gn]},b.rotate=function(_){return arguments.length?(s=_[0]%360*on,h=_[1]%360*on,g=_.length>2?_[2]%360*on:0,D()):[s*gn,h*gn,g*gn]},b.angle=function(_){return arguments.length?(u=_%360*on,D()):u*gn},b.reflectX=function(_){return arguments.length?(c=_?-1:1,D()):c<0},b.reflectY=function(_){return arguments.length?(p=_?-1:1,D()):p<0},b.precision=function(_){return arguments.length?(M=Le(T,x=_*_),F()):Tn(x)},b.fitExtent=function(_,z){return fr(b,_,z)},b.fitSize=function(_,z){return Ui(b,_,z)},b.fitWidth=function(_,z){return Yi(b,_,z)},b.fitHeight=function(_,z){return Hi(b,_,z)};function D(){var _=$e(r,0,0,c,p,u).apply(null,t(f,l)),z=$e(r,e-_[0],i-_[1],c,p,u);return o=_i(s,h,g),T=Bt(t,z),k=Bt(o,T),M=Le(T,x),F()}function F(){return m=I=null,b}return function(){return t=n.apply(this,arguments),b.invert=t.invert&&$,D()}}function Ki(n){var t=0,r=U/3,e=Gi(n),i=e(t,r);return i.parallels=function(f){return arguments.length?e(t=f[0]*on,r=f[1]*on):[t*gn,r*gn]},i}function sr(n,t){return[n,qt(Ge((tn+t)/2))]}sr.invert=function(n,t){return[n,2*le(hi(t))-tn]};function lt(n){return Ge((tn+n)/2)}function Wi(n,t){var r=B(n),e=n===t?W(n):qt(r/B(t))/qt(lt(t)/lt(n)),i=r*Ft(lt(n),e)/e;if(!e)return sr;function f(l,s){i>0?s<-tn+Z&&(s=-tn+Z):s>tn-Z&&(s=tn-Z);var h=i/Ft(lt(s),e);return[h*W(e*l),i-h*B(e*l)]}return f.invert=function(l,s){var h=i-s,g=Bn(e)*Tn(l*l+h*h),o=Un(l,G(h))*Bn(h);return h*e<0&&(o-=U*Bn(l)*Bn(h)),[o/e,2*le(Ft(i/g,1/e))-tn]},f}function ji(){return Ki(Wi).scale(109.5).parallels([30,30])}var Qi=oe('<path fill="#f5f5f5" stroke="#d4d4d8" stroke-width="1.5" vector-effect="non-scaling-stroke"></path>'),Ji=oe('<line stroke="#000" stroke-opacity="0.2" stroke-width="1" vector-effect="non-scaling-stroke"></line>'),no=oe('<g class="transition-opacity duration-200"><g data-label-hit="" class="cursor-pointer" role="button" tabindex="0"><!><rect fill="black" stroke="black" stroke-width="0" vector-effect="non-scaling-stroke"></rect><text text-anchor="middle" dominant-baseline="middle" font-weight="400" fill="white" class="pointer-events-none select-none" vector-effect="non-scaling-stroke"> </text><title> </title></g></g>'),to=un('<section class="bg-[#ccc]"><div class="absolute top-1 right-1 z-50 space-y-1 text-xs"><button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">+</button> <br/> <button class="bg-white px-2 py-1 font-bold text-black border disabled:opacity-40">−</button></div> <svg class="block h-full w-full cursor-grab touch-none select-none overflow-visible active:cursor-grabbing" preserveAspectRatio="xMidYMid meet" role="application" aria-label="Fanzine map (pan and zoom)"><g><!><!></g></svg></section>');function eo(n,t){yt(t,!1);let r=j(t,"italy",8,null),e=j(t,"points",24,()=>[]);j(t,"filteredItems",24,()=>[]);let i=j(t,"query",8,""),f=j(t,"projectionZoom",8,1.25),l=j(t,"labelPlacements",8,null),s=j(t,"disablePanZoomOnMobile",8,!0),h=j(t,"disableVisibleItems",8,!0),g=j(t,"onSelect",8,null);const o=De(),u=1500,c=1800;let p=K(null),v=K(""),S=K(null),d=K([]),w=K([]),C=K([]);const R=0,E=0;let x=K(1),M=K(R),T=K(E),k=!1,m={x:0,y:0,translateX:0,translateY:0},I=!1,b=K(!1),$=K(!1),D=!1,F=!1,_=null,z=null,A=null,N=K(!1);function X(P){const y=P.currentTarget?.ownerSVGElement||P.currentTarget;if(!y?.createSVGPoint)return{x:0,y:0};const O=y.createSVGPoint();O.x=P.clientX,O.y=P.clientY;const V=y.getScreenCTM?.();if(!V)return{x:0,y:0};const Q=V.inverse(),ln=O.matrixTransform(Q);return{x:ln.x,y:ln.y}}function mn(P){const y=P.composedPath?.();return y?y.some(O=>O?.dataset&&"labelHit"in O.dataset):!!P.target?.closest?.("[data-label-hit]")}function en(P,y=u/2,O=c/2){if(a(N))return;const V=P>0?1.02:1/1.02,Q=Math.max(.5,Math.min(8,a(x)*V));if(Q===a(x))return;const ln=y-(y-a(M))/a(x)*Q,yn=O-(O-a(T))/a(x)*Q;fn(ln,yn,Q)}function fn(P,y,O){if(A={x:P,y,scale:O},typeof requestAnimationFrame>"u"){L(M,A.x),L(T,A.y),L(x,A.scale),A=null;return}z||(z=requestAnimationFrame(()=>{A&&(L(M,A.x),L(T,A.y),L(x,A.scale)),A=null,z=null}))}function hn(){if(!a(p)||!e()||e().length===0){L(C,[]);return}const P=100;L(C,e().filter(y=>{const O=parseFloat(y.latitude),V=parseFloat(y.longitude);if(!isFinite(O)||!isFinite(V))return!1;const[Q,ln]=a(p)([V,O]),yn=a(M)+Q*a(x),En=a(T)+ln*a(x);return yn>-P&&yn<u+P&&En>-P&&En<c+P})),o("visibleItemsChange",a(C))}function Fn(P){if(a(N))return;P.preventDefault();const y=P.deltaY>0?-1:1,O=X(P);en(y,O.x,O.y)}function Pn(P){if(a(N)||P.button!=null&&P.button!==0)return;D=mn(P),k=!1,F=!0,_=P.pointerId,I=!1,L($,!1);const y=X(P);m={x:y.x,y:y.y,translateX:a(M),translateY:a(T)}}function cr(P){if(a(N)||!F&&!k||_!=null&&P.pointerId!==_)return;const y=X(P),O=y.x-m.x,V=y.y-m.y;!I&&Math.hypot(O,V)>3&&(I=!0,L($,!0),L(b,D),k=!0,mn(P)&&L(b,!0),P.currentTarget.setPointerCapture?.(P.pointerId)),I&&fn(m.translateX+O,m.translateY+V,a(x))}function vr(P){a(N)||St(P)}function pr(P){a(N)||St(P,!0)}function St(P,y=!1){k=!1,F=!1,_=null,P?.currentTarget&&P.currentTarget.releasePointerCapture?.(P.pointerId),I&&!y?(L(b,!0),setTimeout(()=>{L(b,!1),L($,!1)},160)):(L($,!1),L(b,!1)),D=!1,I=!1}function dr(P,y){if(!P||!isFinite(y)||y===1)return;const O=u/2,V=c/2,[Q,ln]=P.translate();P.scale(P.scale()*y),P.translate([O+(Q-O)*y,V+(ln-V)*y])}function hr(P,y){(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),o("select",y))}bn(()=>(kn(r()),kn(f()),Yt),()=>{if(r()){const P=ji().parallels([37,45]);P.fitExtent([[0,0],[u,c]],r()),dr(P,f()),L(p,P),L(v,Yt(P)(r())||"");const y=Yt(P).bounds(r());L(S,y?{left:y[0][0],top:y[0][1],right:y[1][0],bottom:y[1][1]}:null)}}),bn(()=>kn(l()),()=>{l()&&l().length&&L(d,l())}),bn(()=>(a(d),kn(i()),a(M),a(x),a(T)),()=>{const P=a(d)||[],y=i()?P.filter(V=>{const Q=i().toLowerCase();return V.fanzine?.toLowerCase().includes(Q)||V.city?.toLowerCase().includes(Q)||V.genre?.toLowerCase().includes(Q)}):P,O=120;L(w,y.filter(V=>{const Q=a(M)+V.x*a(x),ln=a(T)+V.y*a(x);return Q>-O&&Q<u+O&&ln>-O&&ln<c+O}))}),bn(()=>(kn(h()),a(C),a(x),a(M),a(T)),()=>{h()?(L(C,[]),o("visibleItemsChange",a(C))):(a(x),a(M),a(T),hn())}),bn(()=>kn(s()),()=>{if(typeof window<"u"){const P=window.matchMedia?.("(pointer: coarse)")?.matches||window.matchMedia?.("(hover: none)")?.matches;L(N,!!(s()&&P))}}),Oe(),mt();var Et=to(),xt=q(Et),Ct=q(xt),se=nn(Ct,4);H(xt);var In=nn(xt,2);J(In,"viewBox",`0 0 ${u} ${c}`);var Mt=q(In),ce=q(Mt);{var gr=P=>{var y=Qi();cn(()=>J(y,"d",a(v))),rn(P,y)};An(ce,P=>{a(v)&&P(gr)})}var _r=nn(ce);Ze(_r,1,()=>a(w),Gr,(P,y)=>{var O=no(),V=q(O),Q=q(V);{var ln=On=>{var qn=Ji();cn(()=>{J(qn,"x1",(a(y),Y(()=>a(y).x0))),J(qn,"y1",(a(y),Y(()=>a(y).y0))),J(qn,"x2",(a(y),Y(()=>a(y).x))),J(qn,"y2",(a(y),Y(()=>a(y).y)))}),rn(On,qn)};An(Q,On=>{a(y),Y(()=>Math.hypot(a(y).x-a(y).x0,a(y).y-a(y).y0)>6)&&On(ln)})}var yn=nn(Q),En=nn(yn),mr=q(En,!0);H(En);var ve=nn(En),yr=q(ve);H(ve),H(V),H(O),cn(()=>{J(yn,"x",(a(y),Y(()=>a(y).x-a(y).width/2))),J(yn,"y",(a(y),Y(()=>a(y).y-a(y).height/2))),J(yn,"width",(a(y),Y(()=>a(y).width))),J(yn,"height",(a(y),Y(()=>a(y).height))),J(En,"x",(a(y),Y(()=>a(y).x))),J(En,"y",(a(y),Y(()=>a(y).y))),J(En,"font-size",(a(y),Y(()=>a(y).fontSize))),_n(mr,(a(y),Y(()=>a(y).text))),_n(yr,`${a(y),Y(()=>a(y).fanzine)??""} (${a(y),Y(()=>a(y).city)??""})`)}),sn("pointerup",V,ri(()=>{St(),!a(b)&&!a($)&&!a(N)&&(g()?.(a(y)),o("select",a(y)))})),sn("click",V,()=>{!a(b)&&!a($)&&!a(N)&&(g()?.(a(y)),o("select",a(y)))}),sn("keydown",V,On=>hr(On,a(y))),rn(P,O)}),H(Mt),H(In),H(Et),cn(()=>{Ct.disabled=a(N),se.disabled=a(N),J(Mt,"transform",`translate(${a(M)} ${a(T)}) scale(${a(x)})`)}),sn("click",Ct,()=>en(1)),sn("click",se,()=>en(-1)),sn("wheel",In,Fn),sn("pointerdown",In,Pn),sn("pointermove",In,cr),sn("pointerup",In,vr),sn("pointercancel",In,pr),rn(n,Et),wt()}var ro=un('<button type="button" class=" border border-black px-1 py-0.5 text-xs text-black">X</button>'),io=un('<div class="grid w-full max-w-[280px]"><div class="flex items-center gap-0.5"><input type="text" placeholder="Cerca..." class="flex-1 border border-black bg-white px-1 py-0.5 text-xs text-black outline-none" aria-label="Search fanzines"/> <!></div></div>');function oo(n,t){yt(t,!1);let r=j(t,"query",12,"");j(t,"totalCount",8,0),j(t,"visibleCount",8,0),j(t,"resultsCount",8,0);let e=j(t,"hasSelection",8,!1);const i=De();function f(){r(""),i("clear")}mt();var l=io(),s=q(l),h=q(s);Xr(h);var g=nn(h,2);{var o=u=>{var c=ro();sn("click",c,f),rn(u,c)};An(g,u=>{(r()||e())&&u(o)})}H(s),H(l),ei(h,r),rn(n,l),wt()}var ao=un('<img class="h-full w-full object-contain" loading="lazy"/>'),lo=un('<div class="mt-0.5 text-[.6rem] leading-snug text-black/60"><div> </div> <button type="button" class="mt-0.5 text-[.6rem] font-medium text-blue-600 hover:text-blue-800"> </button></div>'),uo=un('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] hover:bg-black/10" target="_blank" rel="noreferrer">PDF</a>'),fo=un('<a class=" bg-black/5 px-0.5 py-0 text-[.6rem] text-black hover:bg-black/10" target="_blank" rel="noreferrer">Link</a>'),so=un('<div role="listitem" class=" bg-white p-0.5 text-left shadow-sm"><div class="aspect-[3/4] w-full overflow-hidden  bg-black/5"><!></div> <div class="mt-0 mb-0.5 truncate font-bold leading-tight text-[.6rem]"> </div> <div class="truncate leading-tight text-[.6rem]"> </div> <div class="mt-0 line-clamp-2 leading-tight text-[.6rem]"> </div> <!> <div class="mt-0.5 gap-0.5 "><!> <!></div></div>'),co=un('<div class="py-0.5"><div class="text-xs leading-tight text-black/70"><strong class="text-black"> </strong> fanzine</div> <div class="grid grid-cols-5 md:grid-cols-12  gap-0.5 p-0.5" role="list" aria-label="Fanzines"></div></div>');function vo(n,t){yt(t,!1);let r=j(t,"items",24,()=>[]);const e="https://www.paolopalmacci.it/capitmundi/";let i=K(null);function f(p){return p?/^https?:\/\//i.test(p)?p:`${e}${String(p).replace(/^\/+/,"")}`:""}function l(p){return p?.yearStart?p?.yearEnd&&p.yearEnd!==p.yearStart?`${p.yearStart}-${p.yearEnd}`:String(p.yearStart):""}function s(p,v){const S=[p?.sourceFile,p?.canonicalUrl,p?.pdfHref,p?.title,p?.fanzine,p?.city,p?.yearStart,p?.yearEnd].filter(d=>d!=null&&String(d).trim()!=="").map(d=>String(d));return S.length?`${S.join("|")}|${v}`:String(v)}mt();var h=co(),g=q(h),o=q(g),u=q(o,!0);H(o),qe(),H(g);var c=nn(g,2);Ze(c,7,r,(p,v)=>s(p,v),(p,v,S)=>{var d=so(),w=q(d),C=q(w);{var R=A=>{var N=ao();cn(X=>{J(N,"src",X),J(N,"alt",(a(v),Y(()=>a(v).fanzine||"Fanzine cover")))},[()=>(a(v),Y(()=>f(a(v).ogImage)))]),rn(A,N)};An(C,A=>{a(v),Y(()=>a(v).ogImage)&&A(R)})}H(w);var E=nn(w,2),x=q(E,!0);H(E);var M=nn(E,2),T=q(M);H(M);var k=nn(M,2),m=q(k);H(k);var I=nn(k,2);{var b=A=>{var N=lo(),X=q(N),mn=q(X,!0);H(X);var en=nn(X,2),fn=q(en,!0);H(en),H(N),cn(()=>{ti(X,1,Jr(a(i)===a(S)?"":"line-clamp-3")),_n(mn,(a(v),Y(()=>a(v).description))),_n(fn,a(i)===a(S)?"Read less":"Read more")}),sn("click",en,()=>{L(i,a(i)===a(S)?null:a(S))}),rn(A,N)};An(I,A=>{a(v),Y(()=>a(v).description)&&A(b)})}var $=nn(I,2),D=q($);{var F=A=>{var N=uo();cn(X=>J(N,"href",X),[()=>(a(v),Y(()=>f(a(v).pdfHref)))]),rn(A,N)};An(D,A=>{a(v),Y(()=>a(v)?.pdfHref)&&A(F)})}var _=nn(D,2);{var z=A=>{var N=fo();cn(()=>J(N,"href",(a(v),Y(()=>a(v).canonicalUrl)))),rn(A,N)};An(_,A=>{a(v),Y(()=>a(v)?.canonicalUrl)&&A(z)})}H($),H(d),cn(A=>{_n(x,(a(v),Y(()=>a(v).fanzine))),_n(T,`${a(v),Y(()=>a(v).city)??""}${a(v),Y(()=>a(v).country?`, ${a(v).country}`:"")??""}`),_n(m,`${a(v),Y(()=>a(v).genre||"—")??""}${A??""}`)},[()=>(a(v),Y(()=>l(a(v))?` · ${l(a(v))}`:""))]),rn(p,d)}),H(c),H(h),cn(()=>_n(u,(kn(r()),Y(()=>r().length)))),rn(n,h),wt()}var po=un('<meta name="description" content="Interactive map of Italian fanzines from 1980-1989. Explore the underground punk, DIY, and alternative culture scene."/> <meta name="keywords" content="fanzines, Italy, punk, DIY, underground, 1980s, alternative culture, map"/> <meta name="author" content="Paolo Palmacci, Giacomo Nanni"/> <meta property="og:type" content="website"/> <meta property="og:url" content="http://fanzinet.giacomo.website/"/> <meta property="og:title" content="Fanzinet - Analogikal Knot Map"/> <meta property="og:description" content="Interactive map and database of Italian fanzines (1980-1989)"/> <meta property="og:image" content="http://fanzinet.giacomo.website//cover.jpg"/> <meta property="og:image:width" content="1200"/> <meta property="og:image:height" content="630"/> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:url" content="http://fanzinet.giacomo.website/"/> <meta name="twitter:title" content="Fanzinet - Analogikal Knot Map"/> <meta name="twitter:description" content="Interactive map and database of Italian fanzines (1980-1989)"/> <meta name="twitter:image" content="http://fanzinet.giacomo.website//cover.jpg"/>',1),ho=un('<!> <div class="sticky top-0 z-0 h-[65vh] w-full"><div class="h-full w-full overflow-hidden bg-white"><!></div></div> <div class="relative mx-auto bg-white w-full px-2 py-1"><!> <!></div> <!>',1);function xo(n,t){yt(t,!1);const r=K(),e=K();function i(m){return{sourceFile:m.source_file,canonicalUrl:m.canonical_url,title:m.title,fanzine:m.fanzine||"N/A",city:m.city||"Unknown",country:m.country,activity:m.activity,yearStart:m.year_start,yearEnd:m.year_end,genre:m.genre,description:m.description,pdfHref:m.pdf_href,ogImage:m.og_image,latitude:m.latitude,longitude:m.longitude}}let f=K(null),l=K([]),s=K([]),h=K([]),g=!0,o=K(""),u=K(null),c=K([]);function p(){L(o,""),L(u,null)}function v(m){L(u,m.detail)}function S(m){L(c,m.detail)}wr(async()=>{try{g=!0;const m=await fetch("/data/italy2.geojson");if(!m.ok)throw new Error("Failed to load geojson");L(f,await m.json());const I=await fetch("/fanzines.csv");if(!I.ok)throw new Error("Failed to load fanzines.csv");const b=await I.text();L(l,fi(b).map(i));try{const $=await fetch("/data/label_placements.json");if($.ok){const D=await $.json();L(h,Array.isArray(D)?D:D.labels||[])}}catch($){console.warn("Failed to load label placements",$)}L(s,a(l).map($=>{const D=parseFloat($.latitude),F=parseFloat($.longitude);return!isFinite(D)||!isFinite(F)?null:{...$,lat:D,lon:F}}).filter(Boolean))}catch(m){m instanceof Error?m.message:String(m)}finally{g=!1}}),bn(()=>(a(o),a(l)),()=>{L(r,a(o)?a(l).filter(m=>{const I=a(o).toLowerCase();return m.fanzine?.toLowerCase().includes(I)||m.city?.toLowerCase().includes(I)||m.genre?.toLowerCase().includes(I)}):[])}),bn(()=>(a(o),a(s)),()=>{L(e,a(o)?a(s).filter(m=>{const I=a(o).toLowerCase();return m.fanzine?.toLowerCase().includes(I)||m.city?.toLowerCase().includes(I)||m.genre?.toLowerCase().includes(I)}).length:a(s).length)}),Oe(),mt();var d=ho();Br("1uha8ag",m=>{var I=po();qe(28),Zr(()=>{Vr.title="Fanzinet - Analogikal Knot Map (1980-1989)"}),rn(m,I)});var w=qr(d);ci(w,{});var C=nn(w,2),R=q(C),E=q(R);{let m=ut(()=>a(u)?[a(u)]:a(o)?a(r):a(l));eo(E,{get italy(){return a(f)},get points(){return a(s)},get labelPlacements(){return a(h)},get query(){return a(o)},projectionZoom:1,get filteredItems(){return a(m)},$$events:{select:v,visibleItemsChange:S}})}H(R),H(C);var x=nn(C,2),M=q(x);{let m=ut(()=>!!a(u));oo(M,{get totalCount(){return a(l),Y(()=>a(l).length)},get visibleCount(){return a(e)},get resultsCount(){return a(r),Y(()=>a(r).length)},get hasSelection(){return a(m)},get query(){return a(o)},set query(I){L(o,I)},$$events:{clear:p},$$legacy:!0})}var T=nn(M,2);{let m=ut(()=>(a(u),a(o),a(r),a(c),a(l),Y(()=>a(u)?[a(u)]:a(o)?a(r):a(c).length>0?a(c):a(l))));vo(T,{get items(){return a(m)}})}H(x);var k=nn(x,2);pi(k,{}),rn(n,d),wt()}export{xo as component};
